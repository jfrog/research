<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>CONTAIN, ROTATE, RECOVER: The 5-Phase Shai-Hulud Response Guide - JFrog Security Research</title><meta name="gridsome:hash" content="976467b4ecfb5a7ad4ce67feefd2ffe641f5df89"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="referrer" content="origin"><meta data-vue-tag="ssr" http-equiv="Content-Security-Policy" content="default-src *  &#x27;self&#x27; &#x27;unsafe-eval&#x27; &#x27;unsafe-inline&#x27;  https://jfrog.com; img-src &#x27;self&#x27; * data: ; font-src &#x27;self&#x27; * data: ;"><meta data-vue-tag="ssr" name="title" content="CONTAIN, ROTATE, RECOVER: The 5-Phase Shai-Hulud Response Guide"><meta data-vue-tag="ssr" name="description" content="David Cohen, JFrog Security Researcher"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.ebe1c983be3d8af04d6186b36f13b87c.png"><link rel="preload" href="/assets/css/0.styles.de9ec05e.css" as="style"><link rel="preload" href="/assets/js/app.c3d525fa.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--real-time-post-vue.3b205ae6.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.9f141ac9.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.3924a150.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue~page--src--pages--malicious-packages-vue.290eb3ad.js"><link rel="prefetch" href="/assets/js/page--src--pages--malicious-packages-vue.20041e6d.js"><link rel="prefetch" href="/assets/js/page--src--pages--model-threats-vue.3459b80a.js"><link rel="prefetch" href="/assets/js/page--src--pages--oss-vue.8664726d.js"><link rel="prefetch" href="/assets/js/page--src--pages--post-vue.61151c0a.js"><link rel="prefetch" href="/assets/js/page--src--pages--vulnerabilities-vue.afa0b110.js"><link rel="prefetch" href="/assets/js/page--src--templates--model-threats-post-vue.ecc53922.js"><link rel="prefetch" href="/assets/js/page--src--templates--post-vue.d2ee2512.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue.2ec3d7ff.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--model-threats-post-vue~page--src--templates--real-time-post-vue.7f393094.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--real-time-post-vue.114325c7.js"><link rel="stylesheet" href="/assets/css/0.styles.de9ec05e.css"><script data-vue-tag="ssr" src="/speedsize-local.js"></script><script data-vue-tag="ssr" src="https://transcend-cdn.com/cm/f0071674-c641-4cf3-9d31-303ec0c86b1b/airgap.js" data-languages="en" data-tracker-overrides="GoogleConsentMode:security_storage=on;ad_storage=SaleOfInfo,Advertising;ad_user_data=SaleOfInfo,Advertising;ad_personalization=SaleOfInfo,Advertising;analytics_storage=Analytics,SaleOfInfo;functionality_storage=Functional,SaleOfInfo;personalization_storage=Functional,SaleOfInfo" data-cfasync="false" type="text/javascript" charset="utf-8"></script><script data-vue-tag="ssr" type="text/javascript" charset="utf-8">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "GTM-T6MF8M");
      gtag('set', 'developer_id.dODQ2Mj', true);
    </script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="py-2 main-header"><div class="container mx-auto px-2"><div class="flex w-full justify-between items-center"><div class="left"><div class="flex items-center gap-2"><a href="/" class="logo active"><img alt="JFrog Security Research" src="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg" width="40" srcset="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg 40w" sizes="(max-width: 40px) 100vw, 40px" class="g-image"></a><span class="site-name small">JFrog Security Research</span></div></div><div class="right"><div class="hidden sm:block desktop-menu-wrapper"><ul class="top-menu flex items-center"><li class="menu-item"><a href="/model-threats/" class="font-bold px-3">
      Model Threats
    </a><a href="/vulnerabilities/" class="font-bold px-3 mx-3">
      Discover
    </a></li><li><a href="https://twitter.com/JFrogSecurity" target="_blank" rel="noreferrer noopener noreferrer" class="sr-button px-3 py-2 inline-flex gap-2">
  Follow JFrog Security
  <img alt="twitter" src="/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg" width="14" srcset="/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg 14w" sizes="(max-width: 14px) 100vw, 14px" class="g-image"></a></li></ul></div><div class="sm:hidden flex item-center mobile-menu-wrapper gap-2"><!----><button class="show-menu-hamburger px-1"><img alt="Menu" src="/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg" width="22" srcset="/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg 22w" sizes="(max-width: 22px) 100vw, 22px" class="g-image"></button></div></div></div></div><div class="fixed mobile-menu h-screen w-screen z-50 bg-white text-gray-700 p-5 inset-0" style="display:none;"><div class="flex justify-end mb-3"><button class="p-3"><img alt="Menu" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 12 12' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-ed66a5bf1eb83ec14d27c7d6a4278d79'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-ed66a5bf1eb83ec14d27c7d6a4278d79)' width='12' height='12' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAJfklEQVR42u2bCWwVVRSGpwtQWpa2UFpkEWRvUQFBNEqkFMoiIogKFWsFKiAYTTBRoiwulD0KERLBoKAiZRN3UCEiUUBFRWURBFxABCn70va1FM99fhOuw8xjmzd9yXOSP236%2bmbO%2bp9zz71jGOdf8YIWgk6CewU5gvsEPQRtBfUFVQUVjNC6KiBXfeTsgdw56NEJveIvdKNqgmaCdME9gmxBf0E3QRtBXUGcICrEDBCFXHWRsxtyZ6NHOnpVu9CNEgSpgs7cYKDgfkFPQXtBQ6xYSRAZIspHIk888rVH3vuRvz/6pKKf4xUjqCNoJ7hTkCt4VDBcMEDQVdBa0EBQS1BdUJnwiywHpSvw/OrI0wD5uiLvcOTPRZ926BdjzXl1g0Q%2bbCW4XTBUMEYwSZAnGCUYIugj6EiYNRGkkHvRHhsgmuemIEcb5OqDnKOQexJ6DEWvVuiZiN5%2bYmguSMNC6p%2bG8eVXBYsFiwSvCV4UPC14WNAPYmkpSBZU9NgAlVC%2bJXL0Qy4l3wvIuwj556LPMPRrh75KbyMDgugi6I2lJggWCNYIvhN8L9gg%2bESQL5gpGCcYzPcbQ0BeXlXwfAZyjEOufORcj9xK/s/QJw/9eqOv0ttvOVUmsgQPCcbieaX8TkGB4KjgoOA3wSbBKsGbgufINWXRJEGEh/mfxHMHIMebyLUJOQ8idwF6rEGvseiZRXUwHhQ8IBgkeEwwWbAEy6kvn9Xg4287BJ8TWo8LuguaklPRHuR%2bdZ7XnefPRZ4dyOezyF2APkvQ7zH0VXr7m4Us6uVwwn8x4XPUciOFUqy7RfC%2bYBoWzSCv6kCslV1slqI1tr%2bKctYJdp%2bGHFuQq9RG5mNExmL0G4G%2bSm9/x6SahjsIp1EQyAZueNYGhYK9gq8gmkkQkGLgWyAXRVCxLhkghjKnvH4zJc3kqnzk2ItcdvIe4n/mCZ6iP%2bhFBPnbxjY0D5l4U7Hox%2bSSz%2baGZ4iO3YJ1gmUQ0NM0Hp2pLoku8YIZ8ul4TjlpBiH9BTl%2bBLnsZN0DP8ygEnTDkEp3f%2b9cR2si%2bqDIQtJARUGJzY2LBIcFv2vEuACvKCN0ENRzoTyqFrc2Aivln8WTKwUbcUIB8th5XznqJ4ylCPBuFG%2bE7v5yEouVrxbchpVeEnwq2I4RTlvyq4zoOMXnO4mGBTQefQXXEgWXS4wRyNWCkB2F8orwtgn%2bEhwXFNt4v5io2EUFeFnwCNxxDXJVNQkmEk8lEQX3Yq03%2bPJmwugIeWZ9WAmfKSOsFsziYZkIn8IiJIbnRQRQOApZVF9Rk1qfTs5PF6xA%2bYPIUmZxSjFGUcb5WfAlPPE8hN8OeSpbHROBkI154CDC7RXBe5Ci2RcU24RaCUL9IFgumEokKXK9iRxOIeIiAxggFkc0IlS70eiY1WkjyhU6yKAc8Sv/t4KImUB73IUVYbxTVMYgZBqhoiw2EmUWQji7sXCZjQAqHf6AcZfhsSept525b1KAlIgkNJvR12dpz8/Xnn8swPN/x1lLad2f4PkqGq%2bjjMY6RaE5VEgmEnQP5F2CB1T1%2bBaims93c4mshoSf3VURYurAIOMZIvD9i4hAHxGoCPltwRTSpicR2AwyrRaImCPxjl0ODsGjKy8yB/dDoGYOPsu6vDX3jXKYRl0LgY4WvK5x0N4AHOTTOGgVHDSCkG%2bOQ6sS4Ze0dL9cFjYNcRgWVv8/hxY0E2/UwsiViIhE8j6dpmomyigi%2b9uhCpU4VCFlvLtYKSZc6fTqYuuwU0ocwoPv0IfnMrBoj7dbwA03wDsqX8dTt1UfcsChxptl7g%2bI19qH3Mp4zJV23K4Tmw4n6J1YqUPbvEfzzkRtMZJFye2H4sNZ2SneWAubn7S5ZxmR9xvcsJywH23pRBPcWoFZe/Fell58Azl62mHxdBg%2bWItnZ8PQk7nHRJhehf1b9BJbCW2fg/f3Q7RLIbwRhP2tWu/h1lrET4wxREJtHpBOdZgKS28mV4tsvFXIZ2q5%2bg0DCrXW%2bIAeQ%2bFDOs91KP8X%2bW3XdJkGXUEkDoPwWhL2CSgflNF9FIZoQokcSalaA2EdIGx9mvClKFNAzv4CiW6mT/%2bR37fBKeoeJ7Q1SBn3KIRTdlFd5lHne8L2CV7tV0RQytqSx89QslZBXL%2bi7CmUOMPP09p06QBhrDy9D%2bxHwROaAU3FD8Mlm6kqC%2bkvsiHUZK/3KuIoWx1pWkZDREvJdTOMTWVK%2bFmIYU6CExCaiVOkUYlW5v4m5NdRTWZTjcyZZBNzYePlZS6emtO59YXFx8PiJpGZKVGMAYq1333a34owTpH299OWEdwChi%2bPUjk6Mh1Kpp/wfCsqlgamPjU9nWh4DjZfTzoc0jzr09KiTEOpxSCFpMseiHMJFWMwhNeKGUZNotHrfQk/D0RoS%2bl4UiKDSJgFq28jt4%2bjlM%2bhXzDJsgQDnLJMdGdrnaQqxzWoTFHIEGGEwJVIR5dNefwAlt%2bHAYoCKK%2bPsPQWdztz/uk0T%2b1JvVDZlzyvYUqlu1MM/S5t6p8sYYsd5nZ2kWCSn4qgjzDoAJa0cUaIXhVY6PSFDN9heaoboOwSDbCVJmkyq8k06%2bZmOEZAlVA1gFccUMsIgQMaXlcBc57QlTSrqQ02y6UKlEcfMJE%2bIJPJUkMqQpXy6AO87gTX0glOphPsj8HT6AQ9J0av1wI7tLXAHNYCuQw/mhoXcfgplFaDBS6sBvOpNA8w9U3xKg1CaR4wn32HO7TN2IrBIMRgTIRWujARWqlNhDIh4noYwtWJkFszwc8ZpLo5E1zGd0dAxB2CMRN0cyo8ARYfaJw7p3MlU%2bGvtKnwGJqlLoaL5xPc3BeYpNXxGxliNrfsC%2bRc5r7Aas3AgwyXzie4uTM0G893IZqSCNGKQdgZuuzzCcHaG1xI5PSjg6vhsJ53Y29wtWVv0Ho%2bIeDeoNu7w%2bb%2bfB736Ej7GhPE3WHzfMIU47/nE5qxNV49UFq4dT7A3J%2bfztw%2bm0VSKlHl1fkA83xCDrxzvfHveag4uyhw%2b4SI6QHzmH0TIivO8PaEyHzj3AmRTMsGSoRhuH9GKND%2bfCWjfM8Imcd6a%2buNUjBOibm1Px%2bMU2IZRFcNcwHl9jnBPMPd/flgnRNsjMOv%2bKToesP5pKhb%2b/NunxTtbmgnRa/krPDXhvNZ4WQj9M4KK0J8CiP2Qvf/T4uH/fsC4fLGyGfoNcawvDES9u8Mhf1bY%2bHy3uAQw%2bG9QWu5Cbs3R61XWL87bBhh9vb4P/%2bX4wkCBpt7AAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="12" data-src="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg" data-srcset="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg 12w" data-sizes="(max-width: 12px) 100vw, 12px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg" class="g-image g-image--loaded" width="12" alt="Menu"></noscript></button></div><ul class="mobile-menu-list"><li class="py-4 px-2 border-t border-gray-200"><a href="/" class="text-gray-700 active">
        Home
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="/model-threats/" class="text-gray-700">
        Model Threats
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="/vulnerabilities/" class="text-gray-700">
        Discover
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="https://twitter.com/JFrogSecurity" target="_blank" rel="noopener" class="text-gray-700">
        Follow JFrog Security
      </a></li></ul></div></header><div class="latest-posts"><div class="container pt-5 pb-10"><h1 class="mt-3 pb-0">CONTAIN, ROTATE, RECOVER: The 5-Phase Shai-Hulud Response Guide</h1><p class="mt-1 mb-5 green">David Cohen, JFrog Security Researcher | November 26, 2025</p><div class="post-content-wrapper"><section class="latest-posts-single-post-content text-black"><p>The <a href="https://jfrog.com/blog/shai-hulud-npm-supply-chain-attack-new-compromised-packages-detected/" target="_blank" rel="nofollow noopener noreferrer">“<strong>Shai-Hulud”</strong></a> worm and its evolved variant, <a href="https://research.jfrog.com/post/shai-hulud-the-second-coming/" target="_blank" rel="nofollow noopener noreferrer"><strong>“Sha1-Hulud the second coming”</strong></a>, have introduced a highly efficient, <strong>GitHub-weaponized exfiltration</strong> vector into the supply chain. When an infected system is successfully compromised, the malware leverages a stolen token to create a public repository - typically identifiable by a <strong>random name</strong> and the description "<strong>Sha1-Hulud: The Second Coming</strong>" - which serves as a clandestine drop zone for stolen credentials.</p>
<p>Finding this repository means an active breach is in progress. Your response must be swift, systematic, and follow a strict order of operations to contain the leak and prevent further damage.</p>
<p>Before continuing: <strong>DO NOT DELETE the GitHub repository</strong> that was created by Shai Hulud. Follow the guidance below.</p>
<h1 id="understanding-the-compromise-what-is-leaked"><a href="#understanding-the-compromise-what-is-leaked" aria-hidden="true" tabindex="-1">Understanding the Compromise: What is Leaked?</a></h1>
<p>The Shai-Hulud worm’s objective is to extract high-value credentials that facilitate lateral movement and further supply chain attacks. It achieves this by aggressively scanning the compromised developer environment. Using a stolen Developer GitHub Personal Access Token (PAT), the malware programmatically creates the exfiltration repository and commits files that categorize the stolen data.</p>
<h2 id="the-compromised-repository-structure"><a href="#the-compromised-repository-structure" aria-hidden="true" tabindex="-1">The Compromised Repository Structure</a></h2>
<p><img src="/img/RealTimePostImage/post/shai-hulud-remediation/example-repo.png"></p>
<p>The malware commits multiple <code>.json</code> files, all containing JSON objects that have been subjected to double Base64 encoding to provide a basic layer of obfuscation against simple secret scans:</p>
<ul>
<li><code>actionsSecrets.json</code>: This file contains credentials specifically designed for the <strong>GitHub Actions</strong> environment. These secrets are often non-personal service tokens with broad permissions, making them extremely valuable to the attacker for automating malicious deployments or accessing corporate infrastructure.</li>
</ul>
<details>
<summary>View actionsSecrets.json example</summary>
<pre><code class="language-json">{
  "AWS_ACCESS_KEY_ID_SDK": "AKIA****KOI",
  "AWS_SECRET_ACCESS_KEY_DEV": "MGcv*****bUR",
  "GH_BOT_TOKEN": "ghp_*******8O8",
  "NPM_AUTH_TOKEN": "NpmToken.ff*******a86",
  "SECRET_KEY": "0eee*****a59",
  "COCOAPODS_TRUNK_TOKEN": "8efb*****d607",
  "TOKEN_ARTIFACTORY": "eyJ2*****SldU.eyJ*****ZGE2.YV7u*****oSQ",
  "PHUB_EVIDENCER_SECRET_KEY_PRO": "HgV*****pU=",
  "TENANT_ID": "6f2b*****94a9",
  "CLIENT_SELPHID_SECRET": "VOph*****flJ",
  "github_token": "ghs_7Q******sN",
  "EXPO_TOKEN": "i67u****teI-",
  "BROWSERSTACK_ACCESS_KEY": "N86j****nQzv",
  "CLIENTSECRET_PRO": "bta****2RVr0"
}
</code></pre>
</details>
<ul>
<li><code>contents.json</code>: The primary file containing the victim's own GitHub token that was used to create the repository, along with initial system and account information.</li>
</ul>
<details>
<summary>View contents.json example</summary>
<pre><code class="language-json">{
  "system": {
    "platform": "darwin",
    "architecture": "arm64",
    "platformDetailed": "darwin",
    "architectureDetailed": "arm64",
    "hostname": "LT310",
    "os_user": {
      "homedir": "/Users/********",
      "username": "********",
      "shell": "/bin/zsh",
      "uid": 502,
      "gid": 20
    }
  },
  "modules": {
    "github": {
      "authenticated": true,
      "token": "ghp_bIQGBY8TW*************lGG2Z1d3rLz",
      "username": {
        "login": "********",
        "name": "M******",
        "email": null,
        "publicRepos": 6,
        "followers": 0,
        "following": 0,
        "createdAt": "2022-10-04T08:23:41Z"
      }
    }
  }
}
</code></pre>
</details>
<ul>
<li><code>cloud.json</code>: Contains high-priority, high-risk credentials, specifically AWS, Azure, and Google Cloud Platform (GCP) access keys/secrets.</li>
</ul>
<details>
<summary>View cloud.json example</summary>
<pre><code class="language-json">{
  "aws": {
    "secrets": [
      {
        "name": "AWS_ACCESS_KEY_ID",
        "value": "AKIAIOSFODNN7EXAMPLE"
      },
      {
        "name": "AWS_SECRET_ACCESS_KEY",
        "value": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
      },
      {
        "name": "AWS_SESSION_TOKEN",
        "value": "FwoGZXIvYXdzEBYaDEXAMPLETOKEN1234567890abcdefg"
      }
    ]
  },
  "gcp": {
    "secrets": [
      {
        "name": "GCP_SERVICE_ACCOUNT_KEY",
        "value": "eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwiY2xpZW50X2VtYWlsIjoiZXhhbXBsZUBwcm9qZWN0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0="
      },
      {
        "name": "GCP_PROJECT_ID",
        "value": "example-project-123456"
      }
    ]
  },
  "azure": {
    "secrets": [
      {
        "name": "AZURE_CLIENT_ID",
        "value": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
      },
      {
        "name": "AZURE_CLIENT_SECRET",
        "value": "Abc8Q~EXAMPLE_SECRET_VALUE_1234567890abcdef"
      },
      {
        "name": "AZURE_TENANT_ID",
        "value": "98765432-abcd-efgh-ijkl-1234567890ab"
      }
    ]
  }
}
</code></pre>
</details>
<ul>
<li><code>environment.json</code>: A complete dump of the compromised system's environment variables (<code>process.env</code>), often revealing sensitive API keys, database connection strings, and internal service credentials.</li>
</ul>
<p><img src="/img/RealTimePostImage/post/shai-hulud-remediation/env_secrets.png"></p>
<ul>
<li><code>truffleSecrets.json</code>: Credentials found by an aggressive file system scan using an embedded version of the open-source tool, <a href="https://github.com/trufflesecurity/trufflehog" target="_blank" rel="nofollow noopener noreferrer">TruffleHog</a>.</li>
</ul>
<details>
<summary>View truffleSecrets.json example</summary>
<pre><code class="language-json">{
  "findings": [
    {
      "SourceMetadata": {
        "Data": {
          "Filesystem": {
            "file": "/home/runner/work/my-project/.git/config",
            "line": 12
          }
        }
      },
      "SourceName": "trufflehog - filesystem",
      "DetectorType": 8,
      "DetectorName": "Github",
      "DetectorDescription": "GitHub Personal Access Token",
      "Verified": true,
      "Raw": "ghp_a1B2c3D4e5F6g7H8i9J0k1L2m3N4o5P6q7R8",
      "ExtraData": {
        "rotation_guide": "https://howtorotate.com/docs/tutorials/github/"
      }
    },
    {
      "SourceMetadata": {
        "Data": {
          "Filesystem": {
            "file": "/home/runner/work/my-project/config/credentials.json",
            "line": 5
          }
        }
      },
      "SourceName": "trufflehog - filesystem",
      "DetectorType": 1039,
      "DetectorName": "JWT",
      "DetectorDescription": "JSON Web Token",
      "Verified": true,
      "Raw": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA",
      "ExtraData": {
        "alg": "RS256",
        "exp": "2025-12-01 00:00:00 +0000 UTC",
        "iss": "https://auth.example.com"
      }
    },
    {
      "SourceMetadata": {
        "Data": {
          "Filesystem": {
            "file": "/home/runner/work/my-project/scripts/deploy.sh",
            "line": 23
          }
        }
      },
      "SourceName": "trufflehog - filesystem",
      "DetectorType": 15,
      "DetectorName": "PrivateKey",
      "DetectorDescription": "RSA Private Key",
      "Verified": false,
      "Raw": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e....[TRUNCATED]....\n-----END RSA PRIVATE KEY-----",
      "Redacted": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e"
    },
    {
      "SourceMetadata": {
        "Data": {
          "Filesystem": {
            "file": "/home/runner/work/my-project/.env",
            "line": 8
          }
        }
      },
      "SourceName": "trufflehog - filesystem",
      "DetectorType": 17,
      "DetectorName": "URI",
      "DetectorDescription": "URL with embedded credentials",
      "Verified": false,
      "Raw": "postgresql://admin:SuperSecret123@db.internal.example.com:5432/production",
      "Redacted": "postgresql://admin:********@db.internal.example.com:5432/production"
    },
    {
      "SourceMetadata": {
        "Data": {
          "Filesystem": {
            "file": "/home/runner/work/my-project/src/services/aws.js",
            "line": 15
          }
        }
      },
      "SourceName": "trufflehog - filesystem",
      "DetectorType": 1,
      "DetectorName": "AWS",
      "DetectorDescription": "AWS Access Key",
      "Verified": true,
      "Raw": "AKIAIOSFODNN7EXAMPLE",
      "RawV2": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
    }
  ],
  "executionTime": 45230,
  "exitCode": 0,
  "verified_secrets": 3,
  "unverified_secrets": 2
}
</code></pre>
</details>
<p><strong>Example of GitHub repository created by Sha1-Hulud (2nd campaign) malware</strong></p>
<h2 id="persistency-through-github-action"><a href="#persistency-through-github-action" aria-hidden="true" tabindex="-1">Persistency through GitHub Action</a></h2>
<p>The Shai-Hulud (1st) and Sha1-Hulud (2nd) campaigns specifically target GitHub Actions environments with two distinct, high-impact mechanisms:</p>
<ol>
<li><strong>Secret Exfiltration via Malicious Workflow:</strong> The malware pushes a temporary, malicious workflow (e.g., <code>.github/workflows/formatter_123456789.yml</code> or <code>discussion.yaml</code>) to compromise repositories. This workflow's sole purpose is to list and collect all secrets defined in the repository's <strong>GitHub Secrets</strong> section and upload them as the <strong><code>actionsSecrets.json</code></strong> file to the exfiltration repo.</li>
<li><strong>Persistence via Self-Hosted Runner:</strong> The malware registers the infected machine (if it is a CI runner or has the necessary permissions) as a <strong>self-hosted runner</strong> named something identifiable like <strong><code>SHA1HULUD</code></strong>, which allows the attacker continuous, remote access to the organization's network and resources.</li>
</ol>
<p>This structured dump provides the attacker with a complete dossier for continued operation.</p>
<h1 id="the-incident-response-plan-where-to-start"><a href="#the-incident-response-plan-where-to-start" aria-hidden="true" tabindex="-1">The Incident Response Plan: Where to Start</a></h1>
<h2 id="1-containment-lock-down-the-exfiltration-channel"><a href="#1-containment-lock-down-the-exfiltration-channel" aria-hidden="true" tabindex="-1">1. Containment: Lock Down the Exfiltration Channel</a></h2>
<ul>
<li><strong>Action: DO NOT DELETE THE GITHUB REPOSITORY</strong>. Instead, immediately navigate to the suspicious <strong>GitHub repository</strong> and change its visibility from <strong>Public to Private</strong> in the settings. *In case you are not able to change the visibility, <strong>clone the repository and then delete it*</strong>.
<video src="/img/RealTimePostImage/post/shai-hulud-remediation/privatize-github-repo.mp4" controls></video></li>
<li><strong>Why:</strong> This instantly terminates public access to the data, regardless of the encoding. The repository should not be deleted since it is your primary forensic evidence.</li>
</ul>
<h2 id="2-eradication-neutralize-the-github-action-and-remove-the-malicious-package"><a href="#2-eradication-neutralize-the-github-action-and-remove-the-malicious-package" aria-hidden="true" tabindex="-1">2. Eradication: Neutralize the GitHub Action and Remove the Malicious Package</a></h2>
<p><strong>This step is mandatory <em>before</em> rotating credentials. If you rotate keys while the malware is still present, it will simply steal the new keys.</strong></p>
<h3 id="action-a-disable--remove-malicious-runner-persistence"><a href="#action-a-disable--remove-malicious-runner-persistence" aria-hidden="true" tabindex="-1">Action A: Disable / Remove Malicious Runner (Persistence)</a></h3>
<ul>
<li><strong>Action</strong>: Navigate to your <strong>GitHub Settings</strong> (or Organization/Enterprise Settings) → <strong>Actions</strong> → <strong>Runners</strong>.</li>
<li>Find and <strong>immediately disable or remove</strong> any self-hosted runner named <strong><code>SHA1HULUD</code></strong> or any other unrecognized runner added recently.</li>
<li><strong>Why:</strong> This eliminates the attacker's persistent backdoor access to your build network.</li>
</ul>
<h3 id="action-b-clean-repositories-workflow-removal"><a href="#action-b-clean-repositories-workflow-removal" aria-hidden="true" tabindex="-1">Action B: Clean Repositories (Workflow Removal)</a></h3>
<ul>
<li>Check compromised repositories for new files in the <code>.github/workflows/</code> directory (e.g., <code>formatter_*.yml</code>). Revert/Delete these malicious workflow files.</li>
</ul>
<h3 id="action-c-remove-the-malicious-packages"><a href="#action-c-remove-the-malicious-packages" aria-hidden="true" tabindex="-1">Action C: Remove the Malicious Packages</a></h3>
<ul>
<li><strong>Remove:</strong> Completely delete the project's dependency artifacts locally (<code>rm -rf node_modules</code>) and clear the local cache (<code>npm cache clean --force</code>).</li>
<li><strong>Reinstall Safely</strong>: Update your <code>package.json</code> to replace the malicious package’s version (<a href="https://research.jfrog.com/post/shai-hulud-the-second-coming/" target="_blank" rel="nofollow noopener noreferrer">https://research.jfrog.com/post/shai-hulud-the-second-coming/</a>) with a known, safe version, then re-install the package locally (<code>npm ci</code>).</li>
<li><strong>Re-publish package</strong>: If you are a package maintainer and a malicious package was released under your name, ensure you <strong>re-publish the package</strong> with a new, safe release.</li>
</ul>
<h3 id="how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk"><a href="#how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk" aria-hidden="true" tabindex="-1">How can I identify Shai-Hulud infected packages on my local disk?</a></h3>
<ul>
<li><strong>Identify:</strong> Use the detection script below to look on disk for a malicious package or a malicious indicators (<a href="https://github.com/Cobenian/shai-hulud-detect" target="_blank" rel="nofollow noopener noreferrer">https://github.com/Cobenian/shai-hulud-detect</a>)</li>
</ul>
<pre><code class="language-shell"># Clone the repository
git clone https://github.com/username/shai-hulud-detect.git
cd shai-hulud-detect

# Make the script executable
chmod +x shai-hulud-detector.sh

# Scan your project for Shai-Hulud indicators
./shai-hulud-detector.sh /path/to/your/project

# For comprehensive security scanning
./shai-hulud-detector.sh --paranoid /path/to/your/project
</code></pre>
<ul>
<li><strong>Why:</strong> You must cut the root of the infection to prevent immediate re-compromise.</li>
</ul>
<h2 id="3-triage-decode-every-leaked-secret-and-list-exposed-services"><a href="#3-triage-decode-every-leaked-secret-and-list-exposed-services" aria-hidden="true" tabindex="-1">3. Triage: Decode Every Leaked Secret and List Exposed Services</a></h2>
<ul>
<li><strong>Action:</strong> Using the downloaded <code>.json</code> files from the GitHub repository created by the malware and decode their contents using the supplied script. Every file - <code>actionsSecrets.json, contents.json</code>, <code>cloud.json</code>, <code>environment.json</code>, etc. - must be decoded.</li>
</ul>
<pre><code class="language-shell">#!/bin/bash

# Execute this from inside the directory containing the stolen .json files.
echo "--- Starting Shai-Hulud Double-Base64 Decoding ---"

# Loop through all files matching the .json extension
for encoded_file in *.json; do
    
    # Check if the file actually exists (prevents running if no files match)
    if [ -f "$encoded_file" ]; then
        decoded_output="${encoded_file}.decoded"
        
        echo "Processing: $encoded_file -> Saving to: $decoded_output"
        
        # Double-decode the content and redirect output to the new file
        # The syntax for the double-decode: cat | base64 -d | base64 -d > output
        cat "$encoded_file" | base64 -d | base64 -d > "$decoded_output"
        
        # Check if the decode was successful (i.e., the output file is not empty)
        if [ -s "$decoded_output" ]; then
            echo "   ✅ Successfully decoded."
        else
            echo "   ❌ Decoding failed or resulted in an empty file."
        fi
    fi
done

echo "--- Decoding Complete. Review *.json.decoded files for leaked secrets. ---"
</code></pre>
<p>Script to decode the JSON files created by Sha1-hulud</p>
<pre><code class="language-shell">chmod +x decode.sh # containing the code above, and being in the folder containing the jsons.

./decode.sh 
</code></pre>
<p><img src="/img/RealTimePostImage/post/shai-hulud-remediation/decode-result.png">
<strong>Result after decoding</strong></p>
<p><strong>Each .decoded file contains a JSON with all the leaked secrets.</strong></p>
<ul>
<li><strong>Why</strong>: This step yields the definitive, un-obfuscated list of compromised secrets and the specific services they grant access to. This list is the foundation for your rotation plan.</li>
</ul>
<h2 id="4-remediation-rotate-the-leaked-credentials"><a href="#4-remediation-rotate-the-leaked-credentials" aria-hidden="true" tabindex="-1">4. Remediation: Rotate the leaked credentials</a></h2>
<ul>
<li><strong>Action:</strong> Rotate every credential identified in the decoded JSON files. Assume every secret listed is compromised and immediately usable by the attacker. This includes all GitHub PATs, npm tokens, all cloud service keys (AWS, Azure, GCP), all tokens gathered by TruffleHog and all credentials stolen from the Github Action execution. In short, all credentials present in the files.</li>
<li><strong>Why:</strong> Rotation renders the attacker's stolen goods worthless, eliminating their ability to move laterally or maintain access.</li>
</ul>
<h2 id="5-post-incident-audit-logs-for-persistence-and-untrusted-connections"><a href="#5-post-incident-audit-logs-for-persistence-and-untrusted-connections" aria-hidden="true" tabindex="-1">5. Post-Incident: Audit Logs for Persistence and Untrusted Connections</a></h2>
<ul>
<li>
<p><strong>Action:</strong> Examine the Leaked Service account’s Security Log (or Activity Log) for activity spanning the time <em>after</em> the Github repository was created. Look specifically for:</p>
<ul>
<li><strong>Untrusted Connections</strong>: The authorization of any unrecognized third-party OAuth applications, SSH keys, or webhooks.</li>
<li><strong>Unusual Activity</strong>: Look for the creation of new tokens or unexpected login attempts.</li>
<li>If an untrusted service is found, immediately block it and do not re-enable it until a thorough forensic investigation confirms no further malicious payloads or backdoors were installed via that connection.</li>
</ul>
</li>
<li><strong>Why</strong>: The Shai-Hulud worm is aggressive; its primary goal is exfiltration, but its secondary goal may be persistence. Identifying and blocking any unauthorized service or token is critical to preventing re-entry and ensuring a complete eviction.</li>
</ul>
<h2 id="6-prevent-future-infection-use-curationimmaturity-policy"><a href="#6-prevent-future-infection-use-curationimmaturity-policy" aria-hidden="true" tabindex="-1">6. Prevent future infection: use Curation/Immaturity Policy</a></h2>
<p>The long-term solution is to prevent malicious packages from ever reaching developers or runners.</p>
<ul>
<li>
<p><strong>Action:</strong> Implement <strong>Curation/Immaturity Policies</strong> within your artifact repository (e.g., JFrog Artifactory).</p>
<ul>
<li><strong>Quarantine Unknown Packages:</strong> Configure the repository to automatically block or quarantine any package (including new versions of existing packages) that has not been explicitly approved and scanned by your security team, <a href="https://jfrog.com/help/r/jfrog-security-user-guide/products/curation/configure-curation/create-policies/list-of-available-conditions" target="_blank" rel="nofollow noopener noreferrer">for example by using JFrog Curation</a>.</li>
<li><strong>Require Security Scanning:</strong> Enforce a policy that scans all new dependencies for known vulnerabilities and malicious code signatures <strong>before</strong> they are proxied from the public registry (npm, PyPI) to your internal, trusted repository.</li>
</ul>
</li>
<li><strong>Why:</strong> This creates a mandatory security gate, ensuring that the next supply chain attack, like Shai-Hulud, is quarantined at the repository level, isolating your developers from the threat.</li>
</ul>
<p><video src="/img/RealTimePostImage/post/shai-hulud-remediation/immature-policy.mp4" controls></video></p>
</section><!----></div></div></div><footer class="py-4 main-footer bg-black"><div class="container mx-auto px-2"><div class="flex w-full justify-center flex-col sm:flex-row sm:justify-between items-center flex-wrap gap-4"><div class="left"><div class="flex items-center gap-2"><a href="/" class="logo active"><img alt="JFrog Security Research" src="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg" width="40" srcset="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg 40w" sizes="(max-width: 40px) 100vw, 40px" class="g-image"></a></div></div><div class="right"><ul class="footer-menu flex flex-col sm:flex-row items-center"><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/terms-of-use/" rel="noopener noreferrer" target="_blank" class="text-white">
              Terms of Use
            </a></li><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/jfrog-cookies-policy/" rel="noopener noreferrer" target="_blank" class="text-white">
              Cookies Policy
            </a></li><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/privacy-policy/" rel="noopener noreferrer" target="_blank" class="text-white">
              Privacy Policy
            </a></li><li class="px-4 py-1 sm:border-r"><a href="#" rel="noopener noreferrer" target="_self" class="text-white ot-sdk-show-settings">
              Cookies Settings
            </a></li></ul></div></div><p class="sm:hidden text-center text-white pt-3">
      ©2025 All Rights Reserved. JFrog Ltd.
    </p></div></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"realTimePost":{"description":"David Cohen, JFrog Security Researcher","title":"CONTAIN, ROTATE, RECOVER: The 5-Phase Shai-Hulud Response Guide","date":"November 26, 2025","type":"realTimePost","tag":"Real Time Post","img":"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fshai-hulud-kicked-by-frog.png","path":"\u002Fpost\u002Fshai-hulud-the-second-coming-remediation-guidance\u002F","content":"\u003Cp\u003EThe \u003Ca href=\"https:\u002F\u002Fjfrog.com\u002Fblog\u002Fshai-hulud-npm-supply-chain-attack-new-compromised-packages-detected\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E“\u003Cstrong\u003EShai-Hulud”\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E worm and its evolved variant, \u003Ca href=\"https:\u002F\u002Fresearch.jfrog.com\u002Fpost\u002Fshai-hulud-the-second-coming\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E\u003Cstrong\u003E“Sha1-Hulud the second coming”\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E, have introduced a highly efficient, \u003Cstrong\u003EGitHub-weaponized exfiltration\u003C\u002Fstrong\u003E vector into the supply chain. When an infected system is successfully compromised, the malware leverages a stolen token to create a public repository - typically identifiable by a \u003Cstrong\u003Erandom name\u003C\u002Fstrong\u003E and the description \"\u003Cstrong\u003ESha1-Hulud: The Second Coming\u003C\u002Fstrong\u003E\" - which serves as a clandestine drop zone for stolen credentials.\u003C\u002Fp\u003E\n\u003Cp\u003EFinding this repository means an active breach is in progress. Your response must be swift, systematic, and follow a strict order of operations to contain the leak and prevent further damage.\u003C\u002Fp\u003E\n\u003Cp\u003EBefore continuing: \u003Cstrong\u003EDO NOT DELETE the GitHub repository\u003C\u002Fstrong\u003E that was created by Shai Hulud. Follow the guidance below.\u003C\u002Fp\u003E\n\u003Ch1 id=\"understanding-the-compromise-what-is-leaked\"\u003E\u003Ca href=\"#understanding-the-compromise-what-is-leaked\" aria-hidden=\"true\" tabindex=\"-1\"\u003EUnderstanding the Compromise: What is Leaked?\u003C\u002Fa\u003E\u003C\u002Fh1\u003E\n\u003Cp\u003EThe Shai-Hulud worm’s objective is to extract high-value credentials that facilitate lateral movement and further supply chain attacks. It achieves this by aggressively scanning the compromised developer environment. Using a stolen Developer GitHub Personal Access Token (PAT), the malware programmatically creates the exfiltration repository and commits files that categorize the stolen data.\u003C\u002Fp\u003E\n\u003Ch2 id=\"the-compromised-repository-structure\"\u003E\u003Ca href=\"#the-compromised-repository-structure\" aria-hidden=\"true\" tabindex=\"-1\"\u003EThe Compromised Repository Structure\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fexample-repo.png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe malware commits multiple \u003Ccode\u003E.json\u003C\u002Fcode\u003E files, all containing JSON objects that have been subjected to double Base64 encoding to provide a basic layer of obfuscation against simple secret scans:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EactionsSecrets.json\u003C\u002Fcode\u003E: This file contains credentials specifically designed for the \u003Cstrong\u003EGitHub Actions\u003C\u002Fstrong\u003E environment. These secrets are often non-personal service tokens with broad permissions, making them extremely valuable to the attacker for automating malicious deployments or accessing corporate infrastructure.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdetails\u003E\n\u003Csummary\u003EView actionsSecrets.json example\u003C\u002Fsummary\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E{\n  \"AWS_ACCESS_KEY_ID_SDK\": \"AKIA****KOI\",\n  \"AWS_SECRET_ACCESS_KEY_DEV\": \"MGcv*****bUR\",\n  \"GH_BOT_TOKEN\": \"ghp_*******8O8\",\n  \"NPM_AUTH_TOKEN\": \"NpmToken.ff*******a86\",\n  \"SECRET_KEY\": \"0eee*****a59\",\n  \"COCOAPODS_TRUNK_TOKEN\": \"8efb*****d607\",\n  \"TOKEN_ARTIFACTORY\": \"eyJ2*****SldU.eyJ*****ZGE2.YV7u*****oSQ\",\n  \"PHUB_EVIDENCER_SECRET_KEY_PRO\": \"HgV*****pU=\",\n  \"TENANT_ID\": \"6f2b*****94a9\",\n  \"CLIENT_SELPHID_SECRET\": \"VOph*****flJ\",\n  \"github_token\": \"ghs_7Q******sN\",\n  \"EXPO_TOKEN\": \"i67u****teI-\",\n  \"BROWSERSTACK_ACCESS_KEY\": \"N86j****nQzv\",\n  \"CLIENTSECRET_PRO\": \"bta****2RVr0\"\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdetails\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Econtents.json\u003C\u002Fcode\u003E: The primary file containing the victim's own GitHub token that was used to create the repository, along with initial system and account information.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdetails\u003E\n\u003Csummary\u003EView contents.json example\u003C\u002Fsummary\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E{\n  \"system\": {\n    \"platform\": \"darwin\",\n    \"architecture\": \"arm64\",\n    \"platformDetailed\": \"darwin\",\n    \"architectureDetailed\": \"arm64\",\n    \"hostname\": \"LT310\",\n    \"os_user\": {\n      \"homedir\": \"\u002FUsers\u002F********\",\n      \"username\": \"********\",\n      \"shell\": \"\u002Fbin\u002Fzsh\",\n      \"uid\": 502,\n      \"gid\": 20\n    }\n  },\n  \"modules\": {\n    \"github\": {\n      \"authenticated\": true,\n      \"token\": \"ghp_bIQGBY8TW*************lGG2Z1d3rLz\",\n      \"username\": {\n        \"login\": \"********\",\n        \"name\": \"M******\",\n        \"email\": null,\n        \"publicRepos\": 6,\n        \"followers\": 0,\n        \"following\": 0,\n        \"createdAt\": \"2022-10-04T08:23:41Z\"\n      }\n    }\n  }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdetails\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Ecloud.json\u003C\u002Fcode\u003E: Contains high-priority, high-risk credentials, specifically AWS, Azure, and Google Cloud Platform (GCP) access keys\u002Fsecrets.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdetails\u003E\n\u003Csummary\u003EView cloud.json example\u003C\u002Fsummary\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E{\n  \"aws\": {\n    \"secrets\": [\n      {\n        \"name\": \"AWS_ACCESS_KEY_ID\",\n        \"value\": \"AKIAIOSFODNN7EXAMPLE\"\n      },\n      {\n        \"name\": \"AWS_SECRET_ACCESS_KEY\",\n        \"value\": \"wJalrXUtnFEMI\u002FK7MDENG\u002FbPxRfiCYEXAMPLEKEY\"\n      },\n      {\n        \"name\": \"AWS_SESSION_TOKEN\",\n        \"value\": \"FwoGZXIvYXdzEBYaDEXAMPLETOKEN1234567890abcdefg\"\n      }\n    ]\n  },\n  \"gcp\": {\n    \"secrets\": [\n      {\n        \"name\": \"GCP_SERVICE_ACCOUNT_KEY\",\n        \"value\": \"eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwiY2xpZW50X2VtYWlsIjoiZXhhbXBsZUBwcm9qZWN0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0=\"\n      },\n      {\n        \"name\": \"GCP_PROJECT_ID\",\n        \"value\": \"example-project-123456\"\n      }\n    ]\n  },\n  \"azure\": {\n    \"secrets\": [\n      {\n        \"name\": \"AZURE_CLIENT_ID\",\n        \"value\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\"\n      },\n      {\n        \"name\": \"AZURE_CLIENT_SECRET\",\n        \"value\": \"Abc8Q~EXAMPLE_SECRET_VALUE_1234567890abcdef\"\n      },\n      {\n        \"name\": \"AZURE_TENANT_ID\",\n        \"value\": \"98765432-abcd-efgh-ijkl-1234567890ab\"\n      }\n    ]\n  }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdetails\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Eenvironment.json\u003C\u002Fcode\u003E: A complete dump of the compromised system's environment variables (\u003Ccode\u003Eprocess.env\u003C\u002Fcode\u003E), often revealing sensitive API keys, database connection strings, and internal service credentials.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fenv_secrets.png\"\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EtruffleSecrets.json\u003C\u002Fcode\u003E: Credentials found by an aggressive file system scan using an embedded version of the open-source tool, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftrufflesecurity\u002Ftrufflehog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETruffleHog\u003C\u002Fa\u003E.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdetails\u003E\n\u003Csummary\u003EView truffleSecrets.json example\u003C\u002Fsummary\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E{\n  \"findings\": [\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"\u002Fhome\u002Frunner\u002Fwork\u002Fmy-project\u002F.git\u002Fconfig\",\n            \"line\": 12\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 8,\n      \"DetectorName\": \"Github\",\n      \"DetectorDescription\": \"GitHub Personal Access Token\",\n      \"Verified\": true,\n      \"Raw\": \"ghp_a1B2c3D4e5F6g7H8i9J0k1L2m3N4o5P6q7R8\",\n      \"ExtraData\": {\n        \"rotation_guide\": \"https:\u002F\u002Fhowtorotate.com\u002Fdocs\u002Ftutorials\u002Fgithub\u002F\"\n      }\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"\u002Fhome\u002Frunner\u002Fwork\u002Fmy-project\u002Fconfig\u002Fcredentials.json\",\n            \"line\": 5\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 1039,\n      \"DetectorName\": \"JWT\",\n      \"DetectorDescription\": \"JSON Web Token\",\n      \"Verified\": true,\n      \"Raw\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA\",\n      \"ExtraData\": {\n        \"alg\": \"RS256\",\n        \"exp\": \"2025-12-01 00:00:00 +0000 UTC\",\n        \"iss\": \"https:\u002F\u002Fauth.example.com\"\n      }\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"\u002Fhome\u002Frunner\u002Fwork\u002Fmy-project\u002Fscripts\u002Fdeploy.sh\",\n            \"line\": 23\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 15,\n      \"DetectorName\": \"PrivateKey\",\n      \"DetectorDescription\": \"RSA Private Key\",\n      \"Verified\": false,\n      \"Raw\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e....[TRUNCATED]....\\n-----END RSA PRIVATE KEY-----\",\n      \"Redacted\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e\"\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"\u002Fhome\u002Frunner\u002Fwork\u002Fmy-project\u002F.env\",\n            \"line\": 8\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 17,\n      \"DetectorName\": \"URI\",\n      \"DetectorDescription\": \"URL with embedded credentials\",\n      \"Verified\": false,\n      \"Raw\": \"postgresql:\u002F\u002Fadmin:SuperSecret123@db.internal.example.com:5432\u002Fproduction\",\n      \"Redacted\": \"postgresql:\u002F\u002Fadmin:********@db.internal.example.com:5432\u002Fproduction\"\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"\u002Fhome\u002Frunner\u002Fwork\u002Fmy-project\u002Fsrc\u002Fservices\u002Faws.js\",\n            \"line\": 15\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 1,\n      \"DetectorName\": \"AWS\",\n      \"DetectorDescription\": \"AWS Access Key\",\n      \"Verified\": true,\n      \"Raw\": \"AKIAIOSFODNN7EXAMPLE\",\n      \"RawV2\": \"wJalrXUtnFEMI\u002FK7MDENG\u002FbPxRfiCYEXAMPLEKEY\"\n    }\n  ],\n  \"executionTime\": 45230,\n  \"exitCode\": 0,\n  \"verified_secrets\": 3,\n  \"unverified_secrets\": 2\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdetails\u003E\n\u003Cp\u003E\u003Cstrong\u003EExample of GitHub repository created by Sha1-Hulud (2nd campaign) malware\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"persistency-through-github-action\"\u003E\u003Ca href=\"#persistency-through-github-action\" aria-hidden=\"true\" tabindex=\"-1\"\u003EPersistency through GitHub Action\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003EThe Shai-Hulud (1st) and Sha1-Hulud (2nd) campaigns specifically target GitHub Actions environments with two distinct, high-impact mechanisms:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Cstrong\u003ESecret Exfiltration via Malicious Workflow:\u003C\u002Fstrong\u003E The malware pushes a temporary, malicious workflow (e.g., \u003Ccode\u003E.github\u002Fworkflows\u002Fformatter_123456789.yml\u003C\u002Fcode\u003E or \u003Ccode\u003Ediscussion.yaml\u003C\u002Fcode\u003E) to compromise repositories. This workflow's sole purpose is to list and collect all secrets defined in the repository's \u003Cstrong\u003EGitHub Secrets\u003C\u002Fstrong\u003E section and upload them as the \u003Cstrong\u003E\u003Ccode\u003EactionsSecrets.json\u003C\u002Fcode\u003E\u003C\u002Fstrong\u003E file to the exfiltration repo.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EPersistence via Self-Hosted Runner:\u003C\u002Fstrong\u003E The malware registers the infected machine (if it is a CI runner or has the necessary permissions) as a \u003Cstrong\u003Eself-hosted runner\u003C\u002Fstrong\u003E named something identifiable like \u003Cstrong\u003E\u003Ccode\u003ESHA1HULUD\u003C\u002Fcode\u003E\u003C\u002Fstrong\u003E, which allows the attacker continuous, remote access to the organization's network and resources.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003EThis structured dump provides the attacker with a complete dossier for continued operation.\u003C\u002Fp\u003E\n\u003Ch1 id=\"the-incident-response-plan-where-to-start\"\u003E\u003Ca href=\"#the-incident-response-plan-where-to-start\" aria-hidden=\"true\" tabindex=\"-1\"\u003EThe Incident Response Plan: Where to Start\u003C\u002Fa\u003E\u003C\u002Fh1\u003E\n\u003Ch2 id=\"1-containment-lock-down-the-exfiltration-channel\"\u003E\u003Ca href=\"#1-containment-lock-down-the-exfiltration-channel\" aria-hidden=\"true\" tabindex=\"-1\"\u003E1. Containment: Lock Down the Exfiltration Channel\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EAction: DO NOT DELETE THE GITHUB REPOSITORY\u003C\u002Fstrong\u003E. Instead, immediately navigate to the suspicious \u003Cstrong\u003EGitHub repository\u003C\u002Fstrong\u003E and change its visibility from \u003Cstrong\u003EPublic to Private\u003C\u002Fstrong\u003E in the settings. *In case you are not able to change the visibility, \u003Cstrong\u003Eclone the repository and then delete it*\u003C\u002Fstrong\u003E.\n\u003Cvideo src=\"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fprivatize-github-repo.mp4\" controls\u003E\u003C\u002Fvideo\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy:\u003C\u002Fstrong\u003E This instantly terminates public access to the data, regardless of the encoding. The repository should not be deleted since it is your primary forensic evidence.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"2-eradication-neutralize-the-github-action-and-remove-the-malicious-package\"\u003E\u003Ca href=\"#2-eradication-neutralize-the-github-action-and-remove-the-malicious-package\" aria-hidden=\"true\" tabindex=\"-1\"\u003E2. Eradication: Neutralize the GitHub Action and Remove the Malicious Package\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cstrong\u003EThis step is mandatory \u003Cem\u003Ebefore\u003C\u002Fem\u003E rotating credentials. If you rotate keys while the malware is still present, it will simply steal the new keys.\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"action-a-disable--remove-malicious-runner-persistence\"\u003E\u003Ca href=\"#action-a-disable--remove-malicious-runner-persistence\" aria-hidden=\"true\" tabindex=\"-1\"\u003EAction A: Disable \u002F Remove Malicious Runner (Persistence)\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EAction\u003C\u002Fstrong\u003E: Navigate to your \u003Cstrong\u003EGitHub Settings\u003C\u002Fstrong\u003E (or Organization\u002FEnterprise Settings) → \u003Cstrong\u003EActions\u003C\u002Fstrong\u003E → \u003Cstrong\u003ERunners\u003C\u002Fstrong\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003EFind and \u003Cstrong\u003Eimmediately disable or remove\u003C\u002Fstrong\u003E any self-hosted runner named \u003Cstrong\u003E\u003Ccode\u003ESHA1HULUD\u003C\u002Fcode\u003E\u003C\u002Fstrong\u003E or any other unrecognized runner added recently.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy:\u003C\u002Fstrong\u003E This eliminates the attacker's persistent backdoor access to your build network.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"action-b-clean-repositories-workflow-removal\"\u003E\u003Ca href=\"#action-b-clean-repositories-workflow-removal\" aria-hidden=\"true\" tabindex=\"-1\"\u003EAction B: Clean Repositories (Workflow Removal)\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003ECheck compromised repositories for new files in the \u003Ccode\u003E.github\u002Fworkflows\u002F\u003C\u002Fcode\u003E directory (e.g., \u003Ccode\u003Eformatter_*.yml\u003C\u002Fcode\u003E). Revert\u002FDelete these malicious workflow files.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"action-c-remove-the-malicious-packages\"\u003E\u003Ca href=\"#action-c-remove-the-malicious-packages\" aria-hidden=\"true\" tabindex=\"-1\"\u003EAction C: Remove the Malicious Packages\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003ERemove:\u003C\u002Fstrong\u003E Completely delete the project's dependency artifacts locally (\u003Ccode\u003Erm -rf node_modules\u003C\u002Fcode\u003E) and clear the local cache (\u003Ccode\u003Enpm cache clean --force\u003C\u002Fcode\u003E).\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EReinstall Safely\u003C\u002Fstrong\u003E: Update your \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E to replace the malicious package’s version (\u003Ca href=\"https:\u002F\u002Fresearch.jfrog.com\u002Fpost\u002Fshai-hulud-the-second-coming\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fresearch.jfrog.com\u002Fpost\u002Fshai-hulud-the-second-coming\u002F\u003C\u002Fa\u003E) with a known, safe version, then re-install the package locally (\u003Ccode\u003Enpm ci\u003C\u002Fcode\u003E).\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003ERe-publish package\u003C\u002Fstrong\u003E: If you are a package maintainer and a malicious package was released under your name, ensure you \u003Cstrong\u003Ere-publish the package\u003C\u002Fstrong\u003E with a new, safe release.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk\"\u003E\u003Ca href=\"#how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk\" aria-hidden=\"true\" tabindex=\"-1\"\u003EHow can I identify Shai-Hulud infected packages on my local disk?\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EIdentify:\u003C\u002Fstrong\u003E Use the detection script below to look on disk for a malicious package or a malicious indicators (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FCobenian\u002Fshai-hulud-detect\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fgithub.com\u002FCobenian\u002Fshai-hulud-detect\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-shell\"\u003E# Clone the repository\ngit clone https:\u002F\u002Fgithub.com\u002Fusername\u002Fshai-hulud-detect.git\ncd shai-hulud-detect\n\n# Make the script executable\nchmod +x shai-hulud-detector.sh\n\n# Scan your project for Shai-Hulud indicators\n.\u002Fshai-hulud-detector.sh \u002Fpath\u002Fto\u002Fyour\u002Fproject\n\n# For comprehensive security scanning\n.\u002Fshai-hulud-detector.sh --paranoid \u002Fpath\u002Fto\u002Fyour\u002Fproject\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy:\u003C\u002Fstrong\u003E You must cut the root of the infection to prevent immediate re-compromise.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"3-triage-decode-every-leaked-secret-and-list-exposed-services\"\u003E\u003Ca href=\"#3-triage-decode-every-leaked-secret-and-list-exposed-services\" aria-hidden=\"true\" tabindex=\"-1\"\u003E3. Triage: Decode Every Leaked Secret and List Exposed Services\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EAction:\u003C\u002Fstrong\u003E Using the downloaded \u003Ccode\u003E.json\u003C\u002Fcode\u003E files from the GitHub repository created by the malware and decode their contents using the supplied script. Every file - \u003Ccode\u003EactionsSecrets.json, contents.json\u003C\u002Fcode\u003E, \u003Ccode\u003Ecloud.json\u003C\u002Fcode\u003E, \u003Ccode\u003Eenvironment.json\u003C\u002Fcode\u003E, etc. - must be decoded.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-shell\"\u003E#!\u002Fbin\u002Fbash\n\n# Execute this from inside the directory containing the stolen .json files.\necho \"--- Starting Shai-Hulud Double-Base64 Decoding ---\"\n\n# Loop through all files matching the .json extension\nfor encoded_file in *.json; do\n    \n    # Check if the file actually exists (prevents running if no files match)\n    if [ -f \"$encoded_file\" ]; then\n        decoded_output=\"${encoded_file}.decoded\"\n        \n        echo \"Processing: $encoded_file -\u003E Saving to: $decoded_output\"\n        \n        # Double-decode the content and redirect output to the new file\n        # The syntax for the double-decode: cat | base64 -d | base64 -d \u003E output\n        cat \"$encoded_file\" | base64 -d | base64 -d \u003E \"$decoded_output\"\n        \n        # Check if the decode was successful (i.e., the output file is not empty)\n        if [ -s \"$decoded_output\" ]; then\n            echo \"   ✅ Successfully decoded.\"\n        else\n            echo \"   ❌ Decoding failed or resulted in an empty file.\"\n        fi\n    fi\ndone\n\necho \"--- Decoding Complete. Review *.json.decoded files for leaked secrets. ---\"\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EScript to decode the JSON files created by Sha1-hulud\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-shell\"\u003Echmod +x decode.sh # containing the code above, and being in the folder containing the jsons.\n\n.\u002Fdecode.sh \n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fdecode-result.png\"\u003E\n\u003Cstrong\u003EResult after decoding\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003EEach .decoded file contains a JSON with all the leaked secrets.\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy\u003C\u002Fstrong\u003E: This step yields the definitive, un-obfuscated list of compromised secrets and the specific services they grant access to. This list is the foundation for your rotation plan.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"4-remediation-rotate-the-leaked-credentials\"\u003E\u003Ca href=\"#4-remediation-rotate-the-leaked-credentials\" aria-hidden=\"true\" tabindex=\"-1\"\u003E4. Remediation: Rotate the leaked credentials\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EAction:\u003C\u002Fstrong\u003E Rotate every credential identified in the decoded JSON files. Assume every secret listed is compromised and immediately usable by the attacker. This includes all GitHub PATs, npm tokens, all cloud service keys (AWS, Azure, GCP), all tokens gathered by TruffleHog and all credentials stolen from the Github Action execution. In short, all credentials present in the files.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy:\u003C\u002Fstrong\u003E Rotation renders the attacker's stolen goods worthless, eliminating their ability to move laterally or maintain access.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"5-post-incident-audit-logs-for-persistence-and-untrusted-connections\"\u003E\u003Ca href=\"#5-post-incident-audit-logs-for-persistence-and-untrusted-connections\" aria-hidden=\"true\" tabindex=\"-1\"\u003E5. Post-Incident: Audit Logs for Persistence and Untrusted Connections\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003EAction:\u003C\u002Fstrong\u003E Examine the Leaked Service account’s Security Log (or Activity Log) for activity spanning the time \u003Cem\u003Eafter\u003C\u002Fem\u003E the Github repository was created. Look specifically for:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EUntrusted Connections\u003C\u002Fstrong\u003E: The authorization of any unrecognized third-party OAuth applications, SSH keys, or webhooks.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EUnusual Activity\u003C\u002Fstrong\u003E: Look for the creation of new tokens or unexpected login attempts.\u003C\u002Fli\u003E\n\u003Cli\u003EIf an untrusted service is found, immediately block it and do not re-enable it until a thorough forensic investigation confirms no further malicious payloads or backdoors were installed via that connection.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy\u003C\u002Fstrong\u003E: The Shai-Hulud worm is aggressive; its primary goal is exfiltration, but its secondary goal may be persistence. Identifying and blocking any unauthorized service or token is critical to preventing re-entry and ensuring a complete eviction.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"6-prevent-future-infection-use-curationimmaturity-policy\"\u003E\u003Ca href=\"#6-prevent-future-infection-use-curationimmaturity-policy\" aria-hidden=\"true\" tabindex=\"-1\"\u003E6. Prevent future infection: use Curation\u002FImmaturity Policy\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003EThe long-term solution is to prevent malicious packages from ever reaching developers or runners.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003EAction:\u003C\u002Fstrong\u003E Implement \u003Cstrong\u003ECuration\u002FImmaturity Policies\u003C\u002Fstrong\u003E within your artifact repository (e.g., JFrog Artifactory).\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EQuarantine Unknown Packages:\u003C\u002Fstrong\u003E Configure the repository to automatically block or quarantine any package (including new versions of existing packages) that has not been explicitly approved and scanned by your security team, \u003Ca href=\"https:\u002F\u002Fjfrog.com\u002Fhelp\u002Fr\u002Fjfrog-security-user-guide\u002Fproducts\u002Fcuration\u002Fconfigure-curation\u002Fcreate-policies\u002Flist-of-available-conditions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Efor example by using JFrog Curation\u003C\u002Fa\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003ERequire Security Scanning:\u003C\u002Fstrong\u003E Enforce a policy that scans all new dependencies for known vulnerabilities and malicious code signatures \u003Cstrong\u003Ebefore\u003C\u002Fstrong\u003E they are proxied from the public registry (npm, PyPI) to your internal, trusted repository.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EWhy:\u003C\u002Fstrong\u003E This creates a mandatory security gate, ensuring that the next supply chain attack, like Shai-Hulud, is quarantined at the repository level, isolating your developers from the threat.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cvideo src=\"\u002Fimg\u002FRealTimePostImage\u002Fpost\u002Fshai-hulud-remediation\u002Fimmature-policy.mp4\" controls\u003E\u003C\u002Fvideo\u003E\u003C\u002Fp\u003E\n","excerpt":"Shai-Hulud remediation guide","minutes":"5"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.c3d525fa.js" defer></script><script src="/assets/js/page--src--templates--real-time-post-vue.3b205ae6.js" defer></script><script data-vue-tag="ssr" type="text/javascript" charset="utf-8" data-body="true">
    if (window.airgap) {
      const cookieSettings = document.getElementById('cookie_settings') || document.querySelector('.ot-sdk-show-settings');
      cookieSettings.href = "#";
      cookieSettings.target = "_self";
      cookieSettings.onclick = () => {
        transcend.showConsentManager({ viewState: 'CompleteOptions' });
      };
    }
  </script>
  </body>
</html>
