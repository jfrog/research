{"hash":"5a8b6129a10fcb7cd2e55b4bdc52f1fa1dbde9d0","data":{"realTimePost":{"description":"JFrog Security Research Team","title":"CVE-2025-53101 Analysis - More ImageMagick Commands Are Vulnerable","date":"September 8, 2025","type":"realTimePost","tag":"Real Time Post","img":"/img/RealTimePostImage/post_thumbnail1.png","path":"/post/image-magick-cve-2025-53101/","content":"<p>ImageMagick’s CVE-2025-53101 was recently rated Critical with a 9.8 CVSS score by NVD. While the actual impact depends on how the library is used, our analysis revealed additional, more concerning vulnerable commands in the package that had not been published.</p>\n<p>CVE-2025-53101 has been disclosed by the ImageMagick team, which may result in denial of service and potentially arbitrary code execution. The vulnerability allows attackers to trigger a stack buffer overflow by processing images with maliciously crafted filenames containing consecutive format specifiers.</p>\n<p>The vulnerability results from incorrect offset calculation when processing the image’s filename in the <code>InterpretImageFilename()</code> function in <a href=\"https://github.com/ImageMagick/ImageMagick/blob/main/MagickCore/image.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MagickCore/image.c</a>. The code assumes that when processing consecutive format specifiers, each specifier replacement will be exactly 4 characters (like \"%03d\"), when in reality, the accumulated offset size varies (like \"%d\").</p>\n<p>The offset miscalculation leads to data being written in the wrong location, which may cause data destruction or buffer underwrite, resulting in data being written before the buffer, which may result in memory corruption, leading to denial of service and potentially remote code execution.\nExploitation requires the attacker to supply a file name input with multiple consecutive format specifiers (<code>%d</code>, <code>%o</code>, or <code>%x</code>). For each format specifier, the <code>offset</code> variable used by <code>InterpretImageFilename()</code> accumulates the wrong offset, causing the formatted filename to be written at a bigger offset from the buffer.\nOur analysis has discovered that alongside the <code>mogrify</code> command, which has been disclosed as vulnerable, the main <code>magick</code> tool, together with the commands <code>animate</code>, <code>identify</code>, <code>convert</code>, <code>composite</code>, <code>compare</code> and <code>montage</code> are also vulnerable to exploitation using consecutive <code>%d</code>, <code>%x</code>, or <code>%o</code> format specifiers in the filename. The vulnerability can also be triggered by the direct use of <code>InterpretImageFilename()</code> and other functions.</p>\n<p><img src=\"/img/RealTimePostImage/post/imagemagick_CVE-2025-53101.png\"></p>\n<p>The vulnerability was introduced in version 7.0.7-25 and 6.9.9-37, and it persisted through 7.1.1-47 and 6.9.13-25 respectfully. We strongly recommend upgrading to version 7.1.2-0 or 6.9.13-26, which fixes the issue.</p>\n","excerpt":"The JFrog Security Resrarch team found that the Critical CVE-2025-53101 has additional, more concerning vulnerable commands in the package that had not been published.","minutes":"2"}},"context":{}}