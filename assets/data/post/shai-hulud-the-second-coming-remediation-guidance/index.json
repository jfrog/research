{"hash":"9d34814bd89f7aef5e0f116e05ecf4ba11d3d2ea","data":{"realTimePost":{"description":"David Cohen, JFrog Security Researcher","title":"CONTAIN, ROTATE, RECOVER: The 5-Phase Shai-Hulud Response Guide","date":"November 26, 2020","type":"realTimePost","tag":"Real Time Post","img":"/img/RealTimePostImage/post/shai-hulud-remediation.png","path":"/post/shai-hulud-the-second-coming-remediation-guidance/","content":"<p>The <a href=\"https://jfrog.com/blog/shai-hulud-npm-supply-chain-attack-new-compromised-packages-detected/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">“<strong>Shai-Hulud”</strong></a> worm and its evolved variant, <a href=\"https://research.jfrog.com/post/shai-hulud-the-second-coming/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>“Sha1-Hulud the second coming”</strong></a>, have introduced a highly efficient, <strong>GitHub-weaponized exfiltration</strong> vector into the supply chain. When an infected system is successfully compromised, the malware leverages a stolen token to create a public repository - typically identifiable by a <strong>random name</strong> and the description \"<strong>Sha1-Hulud: The Second Coming</strong>\" - which serves as a clandestine drop zone for stolen credentials.</p>\n<p>Finding this repository means an active breach is in progress. Your response must be swift, systematic, and follow a strict order of operations to contain the leak and prevent further damage.</p>\n<p>Before continuing: <strong>DO NOT DELETE the GitHub repository</strong> that was created by Shai Hulud. Follow the guidance below.</p>\n<h1 id=\"understanding-the-compromise-what-is-leaked\"><a href=\"#understanding-the-compromise-what-is-leaked\" aria-hidden=\"true\" tabindex=\"-1\">Understanding the Compromise: What is Leaked?</a></h1>\n<p>The Shai-Hulud worm’s objective is to extract high-value credentials that facilitate lateral movement and further supply chain attacks. It achieves this by aggressively scanning the compromised developer environment. Using a stolen Developer GitHub Personal Access Token (PAT), the malware programmatically creates the exfiltration repository and commits files that categorize the stolen data.</p>\n<h2 id=\"the-compromised-repository-structure\"><a href=\"#the-compromised-repository-structure\" aria-hidden=\"true\" tabindex=\"-1\">The Compromised Repository Structure:</a></h2>\n<p><img src=\"/img/RealTimePostImage/post/shai-hulud-remediation/example-repo.png\"></p>\n<p>The malware commits multiple <code>.json</code> files, all containing JSON objects that have been subjected to double Base64 encoding to provide a basic layer of obfuscation against simple secret scans:</p>\n<ul>\n<li>actionsSecrets.json<strong>:</strong> This file contains credentials specifically designed for the <strong>GitHub Actions</strong> environment. These secrets are often non-personal service tokens with broad permissions, making them extremely valuable to the attacker for automating malicious deployments or accessing corporate infrastructure.</li>\n</ul>\n<pre><code class=\"language-json\">{\n  \"AWS_ACCESS_KEY_ID_SDK\": \"AKIA****KOI\",\n  \"AWS_SECRET_ACCESS_KEY_DEV\": \"MGcv*****bUR\",\n  \"GH_BOT_TOKEN\": \"ghp_*******8O8\",\n  \"NPM_AUTH_TOKEN\": \"NpmToken.ff*******a86\",\n  \"SECRET_KEY\": \"0eee*****a59\",\n  \"COCOAPODS_TRUNK_TOKEN\": \"8efb*****d607\",\n  \"TOKEN_ARTIFACTORY\": \"eyJ2*****SldU.eyJ*****ZGE2.YV7u*****oSQ\",\n  \"PHUB_EVIDENCER_SECRET_KEY_PRO\": \"HgV*****pU=\",\n  \"TENANT_ID\": \"6f2b*****94a9\",\n  \"CLIENT_SELPHID_SECRET\": \"VOph*****flJ\",\n  \"github_token\": \"ghs_7Q******sN\",\n  \"EXPO_TOKEN\": \"i67u****teI-\",\n  \"BROWSERSTACK_ACCESS_KEY\": \"N86j****nQzv\",\n  \"CLIENTSECRET_PRO\": \"bta****2RVr0\"\n}\n</code></pre>\n<ul>\n<li><code>contents.json</code>: The primary file containing the victim's own GitHub token that was used to create the repository, along with initial system and account information.</li>\n</ul>\n<pre><code class=\"language-json\">{\n  \"system\": {\n    \"platform\": \"darwin\",\n    \"architecture\": \"arm64\",\n    \"platformDetailed\": \"darwin\",\n    \"architectureDetailed\": \"arm64\",\n    \"hostname\": \"LT310\",\n    \"os_user\": {\n      \"homedir\": \"/Users/********\",\n      \"username\": \"********\",\",\n      \"shell\": \"/bin/zsh\",\n      \"uid\": 502,\n      \"gid\": 20\n    }\n  },\n  \"modules\": {\n    \"github\": {\n      \"authenticated\": true,\n      \"token\": \"ghp_bIQGBY8TW*************lGG2Z1d3rLz\",\n      \"username\": {\n        \"login\": \"********\",\n        \"name\": \"M******\",\n        \"email\": null,\n        \"publicRepos\": 6,\n        \"followers\": 0,\n        \"following\": 0,\n        \"createdAt\": \"2022-10-04T08:23:41Z\"\n      }\n    }\n  }\n}\n</code></pre>\n<ul>\n<li><code>cloud.json</code>: Contains high-priority, high-risk credentials, specifically AWS, Azure, and Google Cloud Platform (GCP) access keys/secrets.</li>\n</ul>\n<pre><code class=\"language-json\">{\n  \"aws\": {\n    \"secrets\": [\n      {\n        \"name\": \"AWS_ACCESS_KEY_ID\",\n        \"value\": \"AKIAIOSFODNN7EXAMPLE\"\n      },\n      {\n        \"name\": \"AWS_SECRET_ACCESS_KEY\",\n        \"value\": \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n      },\n      {\n        \"name\": \"AWS_SESSION_TOKEN\",\n        \"value\": \"FwoGZXIvYXdzEBYaDEXAMPLETOKEN1234567890abcdefg\"\n      }\n    ]\n  },\n  \"gcp\": {\n    \"secrets\": [\n      {\n        \"name\": \"GCP_SERVICE_ACCOUNT_KEY\",\n        \"value\": \"eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwiY2xpZW50X2VtYWlsIjoiZXhhbXBsZUBwcm9qZWN0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0=\"\n      },\n      {\n        \"name\": \"GCP_PROJECT_ID\",\n        \"value\": \"example-project-123456\"\n      }\n    ]\n  },\n  \"azure\": {\n    \"secrets\": [\n      {\n        \"name\": \"AZURE_CLIENT_ID\",\n        \"value\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\"\n      },\n      {\n        \"name\": \"AZURE_CLIENT_SECRET\",\n        \"value\": \"Abc8Q~EXAMPLE_SECRET_VALUE_1234567890abcdef\"\n      },\n      {\n        \"name\": \"AZURE_TENANT_ID\",\n        \"value\": \"98765432-abcd-efgh-ijkl-1234567890ab\"\n      }\n    ]\n  }\n}\n</code></pre>\n<ul>\n<li><code>environment.json</code>: A complete dump of the compromised system's environment variables (<code>process.env</code>), often revealing sensitive API keys, database connection strings, and internal service credentials.</li>\n</ul>\n<p><img src=\"/img/RealTimePostImage/post/shai-hulud-remediation/env_secrets.png\"></p>\n<ul>\n<li><code>truffleSecrets.json</code>: Credentials found by an aggressive file system scan using an embedded version of the open-source tool, <a href=\"https://github.com/trufflesecurity/trufflehog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TruffleHog</a>.</li>\n</ul>\n<pre><code class=\"language-json\">{\n  \"findings\": [\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"/home/runner/work/my-project/.git/config\",\n            \"line\": 12\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 8,\n      \"DetectorName\": \"Github\",\n      \"DetectorDescription\": \"GitHub Personal Access Token\",\n      \"Verified\": true,\n      \"Raw\": \"ghp_a1B2c3D4e5F6g7H8i9J0k1L2m3N4o5P6q7R8\",\n      \"ExtraData\": {\n        \"rotation_guide\": \"https://howtorotate.com/docs/tutorials/github/\"\n      }\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"/home/runner/work/my-project/config/credentials.json\",\n            \"line\": 5\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 1039,\n      \"DetectorName\": \"JWT\",\n      \"DetectorDescription\": \"JSON Web Token\",\n      \"Verified\": true,\n      \"Raw\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA\",\n      \"ExtraData\": {\n        \"alg\": \"RS256\",\n        \"exp\": \"2025-12-01 00:00:00 +0000 UTC\",\n        \"iss\": \"https://auth.example.com\"\n      }\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"/home/runner/work/my-project/scripts/deploy.sh\",\n            \"line\": 23\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 15,\n      \"DetectorName\": \"PrivateKey\",\n      \"DetectorDescription\": \"RSA Private Key\",\n      \"Verified\": false,\n      \"Raw\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e....[TRUNCATED]....\\n-----END RSA PRIVATE KEY-----\",\n      \"Redacted\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEpAIBAAKCAQEA2Z3qX2BTLS4e\"\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"/home/runner/work/my-project/.env\",\n            \"line\": 8\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 17,\n      \"DetectorName\": \"URI\",\n      \"DetectorDescription\": \"URL with embedded credentials\",\n      \"Verified\": false,\n      \"Raw\": \"postgresql://admin:SuperSecret123@db.internal.example.com:5432/production\",\n      \"Redacted\": \"postgresql://admin:********@db.internal.example.com:5432/production\"\n    },\n    {\n      \"SourceMetadata\": {\n        \"Data\": {\n          \"Filesystem\": {\n            \"file\": \"/home/runner/work/my-project/src/services/aws.js\",\n            \"line\": 15\n          }\n        }\n      },\n      \"SourceName\": \"trufflehog - filesystem\",\n      \"DetectorType\": 1,\n      \"DetectorName\": \"AWS\",\n      \"DetectorDescription\": \"AWS Access Key\",\n      \"Verified\": true,\n      \"Raw\": \"AKIAIOSFODNN7EXAMPLE\",\n      \"RawV2\": \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n    }\n  ],\n  \"executionTime\": 45230,\n  \"exitCode\": 0,\n  \"verified_secrets\": 3,\n  \"unverified_secrets\": 2\n}\n</code></pre>\n<p><strong>Example of GitHub repository created by Sha1-Hulud (2nd campaign) malware</strong></p>\n<h2 id=\"persistency-through-github-action\"><a href=\"#persistency-through-github-action\" aria-hidden=\"true\" tabindex=\"-1\">Persistency through GitHub Action:</a></h2>\n<p>The Shai-Hulud (1st) and Sha1-Hulud (2nd) campaigns specifically target GitHub Actions environments with two distinct, high-impact mechanisms:</p>\n<ol>\n<li><strong>Secret Exfiltration via Malicious Workflow:</strong> The malware pushes a temporary, malicious workflow (e.g., <code>.github/workflows/formatter_123456789.yml</code> or <code>discussion.yaml</code>) to compromise repositories. This workflow's sole purpose is to list and collect all secrets defined in the repository's <strong>GitHub Secrets</strong> section and upload them as the <strong><code>actionsSecrets.json</code></strong> file to the exfiltration repo.  </li>\n<li><strong>Persistence via Self-Hosted Runner:</strong> The malware registers the infected machine (if it is a CI runner or has the necessary permissions) as a <strong>self-hosted runner</strong> named something identifiable like <strong><code>SHA1HULUD</code></strong>, which allows the attacker continuous, remote access to the organization's network and resources.</li>\n</ol>\n<p>This structured dump provides the attacker with a complete dossier for continued operation.</p>\n<h1 id=\"the-incident-response-plan-where-to-start\"><a href=\"#the-incident-response-plan-where-to-start\" aria-hidden=\"true\" tabindex=\"-1\">The Incident Response Plan: Where to Start</a></h1>\n<h2 id=\"1-containment-lock-down-the-exfiltration-channel\"><a href=\"#1-containment-lock-down-the-exfiltration-channel\" aria-hidden=\"true\" tabindex=\"-1\">1. Containment: Lock Down the Exfiltration Channel</a></h2>\n<ul>\n<li><strong>Action: DO NOT DELETE THE GITHUB REPOSITORY</strong>. Instead, immediately navigate to the suspicious <strong>GitHub repository</strong> and change its visibility from <strong>Public to Private</strong> in the settings. *In case you are not able to change the visibility, <strong>clone the repository and then delete it*</strong>.<br>\n<video src=\"/img/RealTimePostImage/post/shai-hulud-remediation/privatize-github-repo.mp4\" controls></video>  </li>\n<li><strong>Why: This instantly terminates public access to the data</strong>, regardless of the encoding. The repository should not be deleted since it is your primary forensic evidence.</li>\n</ul>\n<h2 id=\"2-eradication-neutralize-the-github-action-and-remove-the-malicious-package\"><a href=\"#2-eradication-neutralize-the-github-action-and-remove-the-malicious-package\" aria-hidden=\"true\" tabindex=\"-1\">2. Eradication: Neutralize the GitHub Action and Remove the Malicious Package</a></h2>\n<h4 id=\"this-step-is-mandatory-before-rotating-credentials-if-you-rotate-keys-while-the-malware-is-still-present-it-will-simply-steal-the-new-keys\"><a href=\"#this-step-is-mandatory-before-rotating-credentials-if-you-rotate-keys-while-the-malware-is-still-present-it-will-simply-steal-the-new-keys\" aria-hidden=\"true\" tabindex=\"-1\"><strong>This step is mandatory <em>before</em> rotating credentials. If you rotate keys while the malware is still present, it will simply steal the new keys.</strong></a></h4>\n<p><strong>Action A: Disable / Remove Malicious Runner (Persistence)</strong></p>\n<ul>\n<li><strong>Action</strong>: Navigate to your <strong>GitHub Settings</strong> (or Organization/Enterprise Settings) → <strong>Actions</strong> → <strong>Runners</strong>.  </li>\n<li>Find and <strong>immediately disable or remove</strong> any self-hosted runner named <strong><code>SHA1HULUD</code></strong> or any other unrecognized runner added recently.  </li>\n<li><strong>Why*</strong>:* This eliminates the attacker's persistent backdoor access to your build network.<br>\n<strong>Action B: Clean Repositories (Workflow Removal)</strong>  </li>\n<li>Check compromised repositories for new files in the <code>.github/workflows/</code> directory (e.g., <code>formatter_*.yml</code>). Revert/Delete these malicious workflow files.</li>\n</ul>\n<p><strong>Action C: Remove the Malicious Packages</strong></p>\n<ul>\n<li>\n<h4 id=\"remove-completely-delete-the-projects-dependency-artifacts-locally-rm--rf-node_modules-and-clear-the-local-cache-npm-cache-clean---force\"><a href=\"#remove-completely-delete-the-projects-dependency-artifacts-locally-rm--rf-node_modules-and-clear-the-local-cache-npm-cache-clean---force\" aria-hidden=\"true\" tabindex=\"-1\"><strong>Remove:</strong> Completely delete the project's dependency artifacts locally (<code>rm -rf node_modules</code>) and clear the local cache (<code>npm cache clean --force</code>).</a></h4>\n</li>\n<li>\n<h4 id=\"reinstall-safely-update-your-packagejson-to-replace-the-malicious-packages-version-httpsresearchjfrogcompostshai-hulud-the-second-coming-with-a-known-safe-version-then-re-install-the-package-locally-npm-ci\"><a href=\"#reinstall-safely-update-your-packagejson-to-replace-the-malicious-packages-version-httpsresearchjfrogcompostshai-hulud-the-second-coming-with-a-known-safe-version-then-re-install-the-package-locally-npm-ci\" aria-hidden=\"true\" tabindex=\"-1\"><strong>Reinstall Safely</strong>: Update your <code>package.json</code> to replace the malicious package’s version (<a href=\"https://research.jfrog.com/post/shai-hulud-the-second-coming/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://research.jfrog.com/post/shai-hulud-the-second-coming/</a>) with a known, safe version, then re-install the package locally (<code>npm ci</code>).</a></h4>\n</li>\n<li><strong>Re-publish package</strong>: If you are a package maintainer and a malicious package was released under your name, ensure you <strong>re-publish the package</strong> with a new, safe release..</li>\n</ul>\n<h3 id=\"how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk\"><a href=\"#how-can-i-identify-shai-hulud-infected-packages-on-my-local-disk\" aria-hidden=\"true\" tabindex=\"-1\">How can I identify Shai-Hulud infected packages on my local disk?</a></h3>\n<ul>\n<li>\n<h4 id=\"identify-use-the-detection-script-below-to-look-on-disk-for-a-malicious-package-or-a-malicious-indicators-httpsgithubcomcobenianshai-hulud-detect\"><a href=\"#identify-use-the-detection-script-below-to-look-on-disk-for-a-malicious-package-or-a-malicious-indicators-httpsgithubcomcobenianshai-hulud-detect\" aria-hidden=\"true\" tabindex=\"-1\"><strong>Identify:</strong> Use the detection script below to look on disk for a malicious package or a malicious indicators (<a href=\"https://github.com/Cobenian/shai-hulud-detect\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/Cobenian/shai-hulud-detect</a>)</a></h4>\n</li>\n</ul>\n<pre><code class=\"language-shell\"># Clone the repository\ngit clone https://github.com/username/shai-hulud-detect.git\ncd shai-hulud-detect\n\n# Make the script executable\nchmod +x shai-hulud-detector.sh\n\n# Scan your project for Shai-Hulud indicators\n./shai-hulud-detector.sh /path/to/your/project\n\n# For comprehensive security scanning\n./shai-hulud-detector.sh --paranoid /path/to/your/project\n</code></pre>\n<ul>\n<li>\n<h4 id=\"why-you-must-cut-the-root-of-the-infection-to-prevent-immediate-re-compromise\"><a href=\"#why-you-must-cut-the-root-of-the-infection-to-prevent-immediate-re-compromise\" aria-hidden=\"true\" tabindex=\"-1\"><strong>Why:</strong> You must cut the root of the infection to prevent immediate re-compromise.</a></h4>\n</li>\n</ul>\n<h2 id=\"3-triage-decode-every-leaked-secret-and-list-exposed-services\"><a href=\"#3-triage-decode-every-leaked-secret-and-list-exposed-services\" aria-hidden=\"true\" tabindex=\"-1\">3. Triage: Decode Every Leaked Secret and List Exposed Services</a></h2>\n<ul>\n<li><strong>Action:</strong> Using the downloaded <code>.json</code> files from the GitHub repository created by the malware and decode their contents using the supplied script. Every file - <code>actionsSecrets.json, contents.json</code>, <code>cloud.json</code>, <code>environment.json</code>, etc. - must be decoded.</li>\n</ul>\n<pre><code class=\"language-shell\">#!/bin/bash\n\n# Execute this from inside the directory containing the stolen .json files.\necho \"--- Starting Shai-Hulud Double-Base64 Decoding ---\"\n\n# Loop through all files matching the .json extension\nfor encoded_file in *.json; do\n    \n    # Check if the file actually exists (prevents running if no files match)\n    if [ -f \"$encoded_file\" ]; then\n        decoded_output=\"${encoded_file}.decoded\"\n        \n        echo \"Processing: $encoded_file -> Saving to: $decoded_output\"\n        \n        # Double-decode the content and redirect output to the new file\n        # The syntax for the double-decode: cat | base64 -d | base64 -d > output\n        cat \"$encoded_file\" | base64 -d | base64 -d > \"$decoded_output\"\n        \n        # Check if the decode was successful (i.e., the output file is not empty)\n        if [ -s \"$decoded_output\" ]; then\n            echo \"   ✅ Successfully decoded.\"\n        else\n            echo \"   ❌ Decoding failed or resulted in an empty file.\"\n        fi\n    fi\ndone\n\necho \"--- Decoding Complete. Review *.json.decoded files for leaked secrets. ---\"\n</code></pre>\n<p>Script to decode the JSON files created by Sha1-hulud</p>\n<pre><code class=\"language-shell\">chmod +x decode.sh # containing the code above, and being in the folder containing the jsons.\n\n./decode.sh \n</code></pre>\n<p><img src=\"/img/RealTimePostImage/post/shai-hulud-remediation/decode-result.png\"><br>\n<strong>Result after decoding</strong></p>\n<p><strong>Each .decoded file contains a JSON with all the leaked secrets.</strong></p>\n<ul>\n<li><strong>Why</strong>: This step yields the definitive, un-obfuscated list of compromised secrets and the specific services they grant access to. This list is the foundation for your rotation plan.</li>\n</ul>\n<h2 id=\"4-remediation-rotate-the-leaked-credentials\"><a href=\"#4-remediation-rotate-the-leaked-credentials\" aria-hidden=\"true\" tabindex=\"-1\">4. Remediation: Rotate the leaked credentials</a></h2>\n<ul>\n<li><strong>Action:</strong> Rotate every credential identified in the decoded JSON files. Assume every secret listed is compromised and immediately usable by the attacker. This includes all GitHub PATs, npm tokens, all cloud service keys (AWS, Azure, GCP), all tokens gathered by TruffleHog and all credentials stolen from the Github Action execution. In short, all credentials present in the files.  </li>\n<li><strong>Why:</strong> Rotation renders the attacker's stolen goods worthless, eliminating their ability to move laterally or maintain access.</li>\n</ul>\n<h2 id=\"5-post-incident-audit-logs-for-persistence-and-untrusted-connections\"><a href=\"#5-post-incident-audit-logs-for-persistence-and-untrusted-connections\" aria-hidden=\"true\" tabindex=\"-1\">5. Post-Incident: Audit Logs for Persistence and Untrusted Connections</a></h2>\n<ul>\n<li>\n<p><strong>Action:</strong> Examine the Leaked Service account’s Security Log (or Activity Log) for activity spanning the time <em>after</em> the Github repository was created<strong>.</strong> Look specifically for:  </p>\n<ul>\n<li><strong>Untrusted Connections</strong>: The authorization of any unrecognized third-party OAuth applications, SSH keys, or webhooks.  </li>\n<li><strong>Unusual Activity</strong>: Look for the creation of new tokens or unexpected login attempts.  </li>\n<li>If an untrusted service is found, immediately block it and do not re-enable it until a thorough forensic investigation confirms no further malicious payloads or backdoors were installed via that connection.  </li>\n</ul>\n</li>\n<li><strong>Why</strong>: The Shai-Hulud worm is aggressive; its primary goal is exfiltration, but its secondary goal may be persistence. Identifying and blocking any unauthorized service or token is critical to preventing re-entry and ensuring a complete eviction.</li>\n</ul>\n<h2 id=\"6-prevent-future-infection-use-curationimmaturity-policy\"><a href=\"#6-prevent-future-infection-use-curationimmaturity-policy\" aria-hidden=\"true\" tabindex=\"-1\">6. Prevent future infection: use Curation/Immaturity Policy</a></h2>\n<p>The long-term solution is to prevent malicious packages from ever reaching developers or runners.</p>\n<ul>\n<li>\n<p><strong>Action:</strong> Implement <strong>Curation/Immaturity Policies</strong> within your artifact repository (e.g., JFrog Artifactory).  </p>\n<ul>\n<li><strong>Quarantine Unknown Packages:</strong> Configure the repository to automatically block or quarantine any package (including new versions of existing packages) that has not been explicitly approved and scanned by your security team, <a href=\"https://jfrog.com/help/r/jfrog-security-user-guide/products/curation/configure-curation/create-policies/list-of-available-conditions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">for example by using JFrog Curation</a>.  </li>\n<li><strong>Require Security Scanning:</strong> Enforce a policy that scans all new dependencies for known vulnerabilities and malicious code signatures <strong>before</strong> they are proxied from the public registry (npm, PyPI) to your internal, trusted repository.  </li>\n</ul>\n</li>\n<li><strong>Why:</strong> This creates a mandatory security gate, ensuring that the next supply chain attack, like Shai-Hulud, is quarantined at the repository level, isolating your developers from the threat.</li>\n</ul>\n<p><video src=\"/img/RealTimePostImage/post/shai-hulud-remediation/immature-policy.mp4\" controls></video></p>\n","excerpt":"Shai-Hulud remediation guide","minutes":"5"}},"context":{}}