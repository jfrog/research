{"hash":"fda6fcca60f0d000b381d82ad3cb7bc340aa9836","data":{"post":{"title":"ClickHouse Divide-by-zero DoS","path":"/vulnerabilities/clickhouse-gorilla-divide-by-zero-dos-xray-199948/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A divide-by-zero in ClickHouse's Gorilla compression codec can allow an authenticated network attacker to perform denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://clickhouse.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ClickHouse</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>ClickHouse (, 21.10.2.15), fixed in 21.10.2.15</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>A low-privileged authenticated network attacker can trigger this issue by sending crafted compressed data to ClickHouse.\nTriggering the issue will crash the ClickHouse process, causing denial of service.</p>\n<p>The ClickHouse decompression code reads the first byte of the compressed buffer and performs a modulo operation with it to get the remainder:</p>\n<pre><code class=\"language-c\">UInt8 bytes_size = source[0];\nUInt8 bytes_to_skip = uncompressed_size % bytes_size;\n</code></pre>\n<p>In case <code>bytes_size</code> is 0, it will end up dividing by zero.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are provided for this vulnerability.</p>\n<p>In order to fully fix this vulnerability, we recommend upgrading ClickHouse to version 21.10.2.15.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) Security Vulnerabilities Found in ClickHouse Open-Source Software</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42391\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2021-42391 Medium severity. Divide-by-zero in ClickHouse leads to denial of service","date_published":"2022-03-15","xray_id":"XRAY-199948","vul_id":"CVE-2021-42391","severity":"medium","discovered_by":"Uriya Yavnieli","last_updated":"2022-03-15","cvss":6.5}},"context":{}}