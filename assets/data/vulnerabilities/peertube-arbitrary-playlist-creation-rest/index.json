{"hash":"89ec5723fbd09485debe32f6692e65a848bb187d","data":{"post":{"title":"PeerTube Arbitrary Playlist Creation via REST API","path":"/vulnerabilities/peertube-arbitrary-playlist-creation-rest/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>This vulnerability allows an existing user to add playlists to a different user’s channel using the REST API.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://github.com/Chocobozzz/PeerTube\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PeerTube</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(, 7.1.0]</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The server listens for POST requests to the <strong>/api/v1/video-playlists</strong> path. This path is used for adding a playlist to the PeerTube instance. The <strong>createVideoPlaylist</strong> function receives the request parameters and is in charge of creating the playlist. The following code sets all the parameters of the playlist:</p>\n<pre><code class=\"language-js\">const videoPlaylist = new VideoPlaylistModel({\n    name: videoPlaylistInfo.displayName,\n    description: videoPlaylistInfo.description,\n    privacy: videoPlaylistInfo.privacy || VideoPlaylistPrivacy.PRIVATE,\n    ownerAccountId: user.Account.id\n}) as MVideoPlaylistFull\n\nvideoPlaylist.url = getLocalVideoPlaylistActivityPubUrl(videoPlaylist) // We use the UUID, so set the URL after building the object\n\nif (videoPlaylistInfo.videoChannelId) {\n  const videoChannel = res.locals.videoChannel\n\n  videoPlaylist.videoChannelId = videoChannel.id\n  videoPlaylist.VideoChannel = videoChannel\n}\n</code></pre>\n<p>This code sets the owner of the new playlist to be the user who performed the request, and then sets the associated channel to the channel ID supplied by the request, without checking if it belongs to the user. This will allow any user to create a playlist in any existing channel on the server. The playlist will be owned by the attacking user, thus only the attacking user will be able to add and remove videos or change the properties of the playlist, while it will be listed in the web interface as belonging to a different user’s channel.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>This PoC assumes that there is a PeerTube instance on the machine listening on ports 3000 (client) and 9000 (server). We also assume that there are 2 existing users on the instance: the default root user and a low privileged user.</p>\n<ol>\n<li>First, using a browser, log in to the PeerTube instance with the low privileged user’s credentials, and use the inspection screen to copy the authorization token of the user.</li>\n<li>Browse to <a href=\"http://localhost:3000/api/v1/video-channels\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>http://localhost:3000/api/v1/video-channels</strong></a> and find a video-channel to attack. If there is none, add one to the root user using the web interface. The ID number of the channel will be needed for the next step.</li>\n<li>\n<p>Run the following command (insert the user token and channel ID in the proper places):</p>\n<pre><code>curl 'http://localhost:3000/api/v1/video-playlists' -H 'Authorization: Bearer user_token' -F \"displayName=playlist\" -F \"videoChannelId=channel_id\" -F \"privacy=1\"\n</code></pre>\n</li>\n</ol>\n<ol>\n<li>Browse to <a href=\"http://localhost:3000/api/v1/video-playlists\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>http://localhost:3000/api/v1/video-playlists</strong></a>. The new playlist will be listed there with the attacking user listed as the owner and the attacked channel listed as the playlist’s channel.</li>\n<li>Using the web interface it will be possible to see the playlist listed in the attacked channel. The attacked user will not see it listed in the “My Library” page, nor will they be able to add or remove videos from it. The attacking user will see it listed under the “My Library” page, and will be able to add or remove videos to it.</li>\n</ol>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/Chocobozzz/PeerTube/releases/tag/v7.1.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix release</a></p>\n<p><a href=\"https://drive.google.com/file/d/1zmXFNutT4ACOJZGmxhU22nhu9Fbn4ui2/view?usp=drive_link\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PoC Materials</a></p>\n","description":"CVE-2025-32945 Medium severity. PeerTube Arbitrary Playlist Creation via REST API","date_published":"2025-04-14","xray_id":"","vul_id":"CVE-2025-32945","severity":"medium","discovered_by":"Ori Hollander","last_updated":"2025-04-14","cvss":4.3}},"context":{}}