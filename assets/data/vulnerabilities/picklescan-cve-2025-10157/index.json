{"hash":"e2a7e5102ee5de6adda46e1664ec18543cc9a515","data":{"post":{"title":"PickleScan Unsafe Globals Check Bypass via Submodule Imports","path":"/vulnerabilities/picklescan-cve-2025-10157/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A Protection Mechanism Failure vulnerability in picklescan allows a remote attacker to bypass the unsafe globals check. This is possible because the scanner performs an exact match for module names, allowing malicious payloads to be loaded via submodules of dangerous packages (e.g., <code>asyncio.unix_events</code> instead of <code>asyncio</code>). When the file, incorrectly deemed safe, is loaded, it can lead to malicious code execution.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://pypi.org/project/picklescan/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">picklescan</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>( , 0.0.31)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The vulnerability exists in PickleScan's mechanism for identifying unsafe global imports in pickle files. The scanner checks for dangerous modules by comparing the imported module's name against a blocklist using an exact string match. An attacker can circumvent this check by importing a submodule of a dangerous package (e.g., <code>asyncio.unix_events</code>) instead of the parent package itself (<code>asyncio</code>). Because <code>asyncio.unix_events</code> is not an exact match for <code>asyncio</code> in the blocklist, PickleScan fails to flag the import as dangerous, allowing the malicious file to pass the scan.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>The following steps demonstrate the bypass.</p>\n<pre><code class=\"language-bash\"># 1. Download a malicious pickle file that uses a submodule of a dangerous package.\nwget https://huggingface.co/iluem/linux_pkl/resolve/main/asyncio_asyncio_unix_events___UnixSubprocessTransport__start.pkl\n\n# 2. Scan the file with PickleScan.\npicklescan -p asyncio_asyncio_unix_events___UnixSubprocessTransport__start.pkl -g\n\n# Observed Result: PickleScan marks the import as \"Suspicious\" but fails to identify it as a \"dangerous\" import, allowing it to pass.\n# Expected Result: PickleScan should recognize any submodule of 'asyncio' as dangerous and flag the file as malicious.\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/advisories/GHSA-f7qq-56ww-84cr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GHSA</a>\n<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-10157\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"A bypass in PickleScan's unsafe globals check allows malicious code execution via submodules of dangerous packages.","date_published":"2025-09-21","xray_id":"XRAY-720930","vul_id":"CVE-2025-10157","severity":"critical","discovered_by":"David Cohen","last_updated":"2025-09-21","cvss":9.3}},"context":{}}