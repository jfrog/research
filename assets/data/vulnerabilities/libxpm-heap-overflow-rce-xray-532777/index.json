{"hash":"164e04c337978e0f50a5101eb17adf2e6fcc5337","data":{"post":{"title":"libX11 & libXpm Heap Overflow RCE","path":"/vulnerabilities/libxpm-heap-overflow-rce-xray-532777/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A heap overflow caused by an integer overflow in libX11 and libXpm may lead to remote code execution when parsing malicious image files.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>libx11\nlibxpm</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,1.8.7)\n(,3.5.17)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The <code>XCreateImage()</code> function in libX11 did not check properly for the image dimensions when creating a new image, which leads to an integer overflow.\nAs part of the bug report, a proof-of-concept demonstrating remote code execution was included.</p>\n<p>The PoC leveraged the bug in libXpm code during the parsing of Pixmap images to trigger the vulnerability in libX11.\nThis vulnerability can be exploited through various means, including the <code>sxpm</code> command-line tool provided by libXpm for displaying Pixmap images on the screen, as well as any application that utilizes the vulnerable functions (for example, <code>XpmReadFileToPixmap</code>) within libXpm to parse Pixmap images.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>An example for a vulnerable Xpm code snippet:</p>\n<pre><code class=\"language-c\">#include &#x3C;stdio.h>\n\n#include &#x3C;X11/Xlib.h>\n#include &#x3C;X11/Xutil.h>\n\nvoid main()\n{\n    Display *display;\n    Pixmap *pixmap, *shape;\n    Window window, rootwindow;\n    int width, height, screen;\n    char* xpmfile = \"file.xpm\";\n\n    display = XOpenDisplay (NULL);\n    screen = DefaultScreen (display);\n    width = DisplayWidth (display, screen);\n    height = DisplayHeight (display, screen);\n    rootwindow = RootWindow (display, screen);\n\n    window = XCreateSimpleWindow (display, rootwindow, 0, 0, width, height, 0, 0, 0);\n    XpmReadFileToPixmap (display, window, xpmfile, &#x26;pixmap, &#x26;shape, NULL);\n}\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://lists.x.org/archives/xorg-announce/2023-October/003424.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Advisory</a></p>\n","description":"CVE-2023-43787 High severity. libX11 & libXpm Heap Overflow RCE","date_published":"2023-10-04","xray_id":"XRAY-532777","vul_id":"CVE-2023-43787","severity":"high","discovered_by":"Yair Mizrahi","last_updated":"2023-10-04","cvss":7}},"context":{}}