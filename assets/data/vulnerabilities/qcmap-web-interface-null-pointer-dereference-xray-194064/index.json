{"hash":"395440ef224a898db42a76f9a89f4f80db8aa4f5","data":{"post":{"title":"QCMAP Web Interface NULL pointer dereference","path":"/vulnerabilities/qcmap-web-interface-null-pointer-dereference-xray-194064/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A null pointer dereference in the QCMAP_Web_CLIENT binary in the Qualcomm QCMAP software suite allows authenticated network attackers to cause denial of service by sending a request with a crafted URL.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>Qualcomm QCMAP (closed source)</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>QCMAP before October 2020</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Qualcomm manufactures the MDM (Mobile Data Modem) family of SoCs, which provides various mobile connectivity features in a single package. One of the software suites is the QCMAP suite, which is in charge of running many services in the mobile access point. These include a lighttpd-based web interface and a MiniDLNA-based media server. QCMAP is used in many kinds of networking devices, primarily mobile hotspots and LTE routers.</p>\n<p>Attackers can trigger the exploit by issuing an HTTP request with a crafted URL. A <a href=\"https://jfrog.com/blog/major-vulnerabilities-discovered-in-qualcomm-qcmap/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">public exploit exists</a>, which demonstrates how to invoke the web interface with an unexpected URL parameter format (<code class=\"language-inline-text\">http://x.x.x.x/cgi-bin/qcmap_web_cgi?a</code>) to cause denial of service and crash the interface.</p>\n<p>The <code class=\"language-inline-text\">QCMAP_Web_CLIENT</code> library implementation has a bug in the <code class=\"language-inline-text\">Tokenizer()</code> function, which parses the input data and performs the chosen operation. The input parameters are expected to be in the format <code class=\"language-inline-text\">var1=val1&amp;var2=val2&amp; var3=val3...</code>.  The function invokes <code class=\"language-inline-text\">strstr()</code> to search for a <code class=\"language-inline-text\">=</code> character, and then uses its return value without checking (in several implementations, the call to <code class=\"language-inline-text\">strstr()</code> is replaced by a call to <code class=\"language-inline-text\">strchr()</code>, which behaves in the same way). If there is no <code class=\"language-inline-text\">=</code> character, the search returns <code class=\"language-inline-text\">NULL</code>, causing a <a href=\"https://en.wikipedia.org/wiki/Null_pointer#Null_dereferencing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NULL pointer dereference</a>. This crashes the process.</p>\n<p>The original exploit was developed by JFrog researchers. There are two related CVEs for this component: CVE-2020-3657 and CVE-2020-25859.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p><code class=\"language-inline-text\">http://x.x.x.x/cgi-bin/qcmap_web_cgi?a</code></p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/major-vulnerabilities-discovered-in-qualcomm-qcmap/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JFrog Blogpost</a></p>\n","description":"","date_published":"2020-10-14","xray_id":"XRAY-194064","vul_id":"CVE-2020-25858","severity":"high","discovered_by":"Ori Hollander","last_updated":"2020-10-14","cvss":7.5}},"context":{}}