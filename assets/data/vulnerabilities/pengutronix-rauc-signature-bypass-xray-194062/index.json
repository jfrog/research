{"hash":"6d45728d3ce0124e475ced8b3b876ccf578ec016","data":{"post":{"title":"Pengutronix RAUC signature bypass","path":"/vulnerabilities/pengutronix-rauc-signature-bypass-xray-194062/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>ToCToU in Pengutronix RAUC allows attackers to bypass signature verification</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://rauc.readthedocs.io/en/latest/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Pengutronix RAUC</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>RAUC (, 1.5), fixed in 1.5</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The <a href=\"https://rauc.readthedocs.io/en/latest/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Pengutronix RAUC</a> (\"Robust Auto-Update Controller\") is an open-source update client intended for Linux-based embedded devices, with support for many types of common bootloaders and filesystems.</p>\n<p>Attackers can modify the update file during the installation process to make RAUC install an arbitrary, unverified payload. The attackers have to modify the update file to exploit the vulnerability, so they must either run code on the device with permissions to modify the file or have physical access to the storage. If RAUC accepts updates from the network, stores them in a single location, and is configured not to prevent repeated uploads while an installation is in progress, the vulnerability can be exploited remotely. The example CGI interface provided by RAUC does not allow repeated uploads.</p>\n<p>The RAUC function <code>check_bundle()</code> in module <code>install.c</code> uses OpenSSL to verify the file's signature, but it then closes the bundle file and does not retain its contents in any way. Another function, <code>mount_bundle()</code>, is then called to extract the contents of the update image. This function opens the file with a new sub-process and rereads its content from storage, making a time-of-check to time-of-use attack possible, since the attacker can replace or modify the update file in the period of time before the invocation of <code>mount_bundle()</code>.</p>\n<p>The vulnerability was discovered by JFrog researchers.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/cve-2020-25860-significant-vulnerability-discovered-in-rauc-embedded-firmware-update-framework/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) Vulnerability Discovered in RAUC Embedded Firmware Update</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-25860\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2020-25860 Medium severity. ToCToU in Pengutronix RAUC allows attackers to bypass signature verification","date_published":"2020-12-21","xray_id":"XRAY-194062","vul_id":"CVE-2020-25860","severity":"medium","discovered_by":"Uriya Yavnieli","last_updated":"2020-12-21","cvss":6.6}},"context":{}}