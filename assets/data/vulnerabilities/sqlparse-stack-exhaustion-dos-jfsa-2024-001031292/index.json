{"hash":"64145d0c7c07503b050891f19bfd0cacfe1e0b6c","data":{"post":{"title":"sqlparse stack exhaustion DoS","path":"/vulnerabilities/sqlparse-stack-exhaustion-dos-jfsa-2024-001031292/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Passing a heavily nested list to sqlparse.parse() leads to a Denial of Service due to RecursionError.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>sqlparse</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,0.5.0)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Passing a heavily nested list to sqlparse.parse() leads to a Denial of Service due to RecursionError.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>Running the following code will raise Maximum recursion limit exceeded exception:</p>\n<pre><code class=\"language-python\">import sqlparse\nsqlparse.parse('[' * 10000 + ']' * 10000)\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/andialbrecht/sqlparse/commit/b4a39d9850969b4e1d6940d32094ee0b42a2cf03\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix commit</a></p>\n<p><a href=\"https://github.com/advisories/GHSA-2m57-hf25-phgg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GHSA Advisory</a></p>\n","description":"CVE-2024-4340, HIGH, Passing a heavily nested list to sqlparse.parse() leads to a Denial of Service due to RecursionError.","date_published":"2024-04-30","xray_id":"JFSA-2024-001031292","vul_id":"CVE-2024-4340","severity":"high","discovered_by":"Uriya Yavnieli","last_updated":"2024-04-30","cvss":7.5}},"context":{}}