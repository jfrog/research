{"hash":"9c2590296d27d100971e38cb65149fe7cecf02b2","data":{"post":{"title":"npm proxy undefined variable remote DoS","path":"/vulnerabilities/undefined-variable-usage-in-proxy-leads-to-remote-denial-of-service-xray-520917/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Undefined variable usage in npm package \"proxy\" leads to remote denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>proxy</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>[2.0.0, 2.1.1), Fixed in 2.1.1</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>A remote attacker can trigger a denial of service by sending a crafted HTTP request, causing the socket.remoteAddress variable to be undefined. Usage of the undefined variable raises a TypeError exception.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>The following simple program is vulnerable to this issue -</p>\n<pre><code class=\"language-javascript\">import * as http from 'http';\nimport { createProxy } from 'proxy';\n\nconst server = createProxy(http.createServer());\nserver.listen(31285, () => {\n    var port = server.address().port;\n    console.log('HTTP(s) proxy server listening on port %d',\nport);\n});\n</code></pre>\n<p>An attacker can crash the program by sending a valid HTTP GET request followed by invalid tail data</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p>No references are supplied for this issue</p>\n","description":"CVE-2023-2968, HIGH, npm proxy undefined variable remote DoS","date_published":"2023-05-30","xray_id":"XRAY-520917","vul_id":"CVE-2023-2968","severity":"high","discovered_by":"Ori Hollander","last_updated":"2023-05-30","cvss":7.5}},"context":{}}