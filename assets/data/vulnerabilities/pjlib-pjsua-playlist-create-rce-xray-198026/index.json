{"hash":"b4fe57f22136d1aa444d29df9ff5588e3329e29c","data":{"post":{"title":"PJLIB pjsua_playlist_create RCE","path":"/vulnerabilities/pjlib-pjsua-playlist-create-rce-xray-198026/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Stack overflow in PJLIB leads to remote code execution when invoking <code>pjsua_playlist_create</code> with malicious input</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.pjsip.org/pjlib/docs/html/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PJLIB</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>PJLIB (, 2.1.11], fixed in 2.12</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>CVE-2021-43301 was found in <code>pjsua_playlist_create</code> (OO wrapper - <code>AudioMediaPlayer::createPlaylist</code>)  which creates a file playlist media port and automatically adds the port to the conference bridge.</p>\n<p>Attackers that can remotely control the contents of the <code>file_names</code> argument of <code>pjsua_player_create</code> may cause remote code execution.</p>\n<p>This function contains a stack overflow vulnerability when the child function <code>pjmedia_wav_playlist_create</code> is called. This function copies each file name from <code>file_list</code> to <code>filename</code> without checking if its length is at most <code>PJ_MAXPATH</code> (260). If the file name length is longer - the copy will overflow the filename variable and trigger a stack overflow.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this vulnerability.</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are provided for this vulnerability.</p>\n<p>In order to fully fix this vulnerability, we recommend upgrading PJSIP to version 2.12.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/jfrog-discloses-5-memory-corruption-vulnerabilities-in-pjsip-a-popular-multimedia-library/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) 5 New Vulnerabilities Discovered in PJSIP Open Source Library</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43301\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2021-43301 High severity. Stack overflow in PJSUA leads to remote code execution","date_published":"2022-03-01","xray_id":"XRAY-198026","vul_id":"CVE-2021-43301","severity":"high","discovered_by":"Uriya Yavnieli","last_updated":"2022-03-01","cvss":8.1}},"context":{}}