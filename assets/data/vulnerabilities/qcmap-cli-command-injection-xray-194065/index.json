{"hash":"c149d6476d8631fd89d1112f867278c5cec2705f","data":{"post":{"title":"QCMAP CLI command injection","path":"/vulnerabilities/qcmap-cli-command-injection-xray-194065/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Insufficient input validation in the QCMAP_CLI utility in the Qualcomm QCMAP software suite allows authenticated unprivileged local attackers to perform arbitrary code execution by sending crafted CLI commands.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>Qualcomm QCMAP (closed source)</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>QCMAP before October 2020</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Qualcomm manufactures the MDM (Mobile Data Modem) family of SoCs, which provides various mobile connectivity features in a single package. One of the software suites is the QCMAP suite, which is in charge of running many services in the mobile access point. Among others, QCMAP contains a Command Line Interface (CLI) utility called QCMAP_CLI. From within this CLI, the user can change different settings on the device; one of the possible options is to set the gateway URL. QCMAP is used in many kinds of networking devices, primarily mobile hotspots and LTE routers.</p>\n<p>Attackers can trigger the exploit by sending a series of crafted CLI commands. A <a href=\"https://jfrog.com/blog/major-vulnerabilities-discovered-in-qualcomm-qcmap/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">public exploit exists</a>) and demonstrates the running of arbitrary code in the CLI shell. Attackers must be able to run CLI code on the device locally before they can exploit the vulnerability, and they can only achieve privilege escalation if QCMAP_CLI can be run via <code>sudo</code> or <code>setuid</code>.</p>\n<p>The library implementation has a bug in the <code>QCMAP_LAN::EnableGatewayUrl()</code> function in the <code>QCMAP_ConnectionManager</code> binary. In this function, the code calls <code>snprintf()</code> to create a string which includes the URL, and then calls <code>system()</code> to create a new process. There is no validation on the user input to make sure that it doesn’t include malicious characters; thus it is possible to pass a string with shell metacharacters (such as  ‘;’) and run arbitrary commands. This issue appears twice in some of the implementations of this function.</p>\n<p>The original exploit was developed by JFrog researchers. There are two related CVEs for this component: CVE-2020-3657 and CVE-2020-25858.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/major-vulnerabilities-discovered-in-qualcomm-qcmap/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) Vulnerabilities Discovered in Qualcomm QCMAP enable remote root access</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-25859\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2020-25859 Medium severity. Insufficient input validation in the QCMAP_CLI utility in the Qualcomm QCMAP software suite allows authenticated unprivileged local attackers to perform arbitrary code execution by sending crafted CLI commands.","date_published":"2020-10-14","xray_id":"XRAY-194065","vul_id":"CVE-2020-25859","severity":"medium","discovered_by":"Ori Hollander","last_updated":"2020-10-14","cvss":6.7}},"context":{}}