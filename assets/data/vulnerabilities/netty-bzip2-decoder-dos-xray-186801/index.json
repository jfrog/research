{"hash":"8bfbd47c755b75210ca83b1b6cb2e672e2ce3411","data":{"post":{"title":"netty Bzip2 decoder DoS","path":"/vulnerabilities/netty-bzip2-decoder-dos-xray-186801/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Resource exhaustion in netty's Bzip2 decoder leads to denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://github.com/netty/netty\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Netty</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>[4.1.0 - 4.1.67], fixed in 4.1.68</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p><a href=\"https://github.com/netty/netty\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">netty</a> is a popular client/server framework which enables quick and easy development of network applications such as protocol servers and clients.</p>\n<p>A vulnerability was found in netty's Bzip2 decoder - when using the netty library and accepting arbitrary data streams to decode, netty does not limit the stream in any way.\nAn attacker that can submit a big file to decompress, may cause memory exhaustion which will lead to denial of service on the netty daemon process and possibly other processes on the same machine.</p>\n<p>Example code that can trigger the issue -</p>\n<pre><code class=\"language-java\">public static void main(String[] args) throws Exception {\nBzip2Decoder decoder = new Bzip2Decoder(); // Create the decompressor\nfinal ByteBufAllocator allocator = new PooledByteBufAllocator(false);\nFileInputStream file = new FileInputStream(\"C:\\\\temp\\\\100GB.bz2\"); // External input\nint inputChunks = 64 * 1024;\nByteBuf buf = allocator.heapBuffer(inputChunks);\nChannelHandlerContext ctx = new StubChannelHandlerContext(allocator);\nwhile (buf.writeBytes(file, buf.writableBytes()) >= 0) {\nSystem.out.println(\"Input: \" + buf.capacity());\ndecoder.channelRead(ctx, buf); // BUG, No internal resource release!\nbuf = allocator.heapBuffer(inputChunks);\ndecoder.channelReadComplete(ctx);\n}\n</code></pre>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue.</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/cve-2021-37136-cve-2021-37137-denial-of-service-dos-in-nettys-decompressors/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) Denial of Service Security Vulnerabilities in Netty Networking Library</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-37136\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2021-37136 High severity. Resource exhaustion in netty's Bzip2 decoder leads to denial of service","date_published":"2021-09-09","xray_id":"XRAY-186801","vul_id":"CVE-2021-37136","severity":"high","discovered_by":"Ori Hollander","last_updated":"2021-09-09","cvss":7.5}},"context":{}}