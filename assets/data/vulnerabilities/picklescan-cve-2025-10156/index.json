{"hash":"8457c889bd3a3e8812a3a34aa788efd831e3ff84","data":{"post":{"title":"PickleScan Bypass via ZIP file bad CRC","path":"/vulnerabilities/picklescan-cve-2025-10156/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>An Improper Handling of Exceptional Conditions vulnerability in the ZIP archive scanning component of mmaitre314 picklescan allows a remote attacker to bypass security scans. This is achieved by crafting a ZIP archive containing a file with a bad Cyclic Redundancy Check (CRC), which causes the scanner to halt and fail to analyze the contents for malicious pickle files. When the file incorrectly considered safe is loaded, it can lead to the execution of malicious code.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://pypi.org/project/picklescan/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">picklescan</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>( , 0.0.31)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The vulnerability stems from how PickleScan handles ZIP archives. It uses Python's standard <code>zipfile</code> module, which raises an exception when it encounters a file with a CRC mismatch. PickleScan does not handle this exception gracefully; it halts the scan instead of attempting to process other valid files within the archive. This behavior creates a security blind spot, as PyTorch may be configured to ignore CRC errors and load a model from the same corrupted archive, inadvertently executing a malicious pickle payload that PickleScan failed to detect.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>The following steps demonstrate the vulnerability using a public model with a known CRC error.</p>\n<pre><code class=\"language-bash\"># 1. Download a Pytorch model known to have a bad CRC.\nwget https://huggingface.co/jinaai/jina-embeddings-v2-base-en/resolve/main/pytorch_model.bin?download=true -O pytorch_model.bin\n\n# 2. Attempt to scan the corrupted ZIP file with PickleScan.\npicklescan -p pytorch_model.bin\n\n# Observed Result: PickleScan returns an error about a bad ZIP file and does not scan any content within the archive.\n\n# Expected Result: PickleScan should warn about the CRC error but still attempt to scan accessible files within the archive for threats.\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/advisories/GHSA-mjqp-26hc-grxg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GHSA</a>\n<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-10156\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"A bad CRC in a ZIP archive causes PickleScan to fail, allowing malicious pickle files within the archive to evade detection.","date_published":"2025-09-21","xray_id":"XRAY-720938","vul_id":"CVE-2025-10156","severity":"critical","discovered_by":"David Cohen","last_updated":"2025-09-21","cvss":9.3}},"context":{}}