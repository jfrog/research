{"hash":"a98e0e4e46991570df79d18ba75fee71d42f614e","data":{"post":{"title":"Unified Automation C++ based OPC UA Client Server SDK out of bounds read","path":"/vulnerabilities/ua-cpp-uavariant-oob-read-xray-75757/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>The UaVariant::cloneTo() function in Unified Automation C++ based OPC UA Client Server SDK is vulnerable to of out bounds read issue which can allow a remote authenticated attacker to perform denial of service.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.unified-automation.com/products/server-sdk/c-ua-server-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unified Automation C++ based OPC UA Client Server SDK</a>\n​</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>Unified Automation C++ based OPC UA Client Server SDK (, 1.7.6], fixed in 1.7.7\n​</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p><a href=\"https://www.unified-automation.com/products/server-sdk/c-ua-server-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unified Automation C++ based OPC UA Client Server SDK</a> is a SDK used to develop an OPC UA server in C++, Developed by the Unified Automation.</p>\n<p>There is a possible read out of bounds in <code>UaVariant::cloneTo()</code>:</p>\n<pre><code class=\"language-cpp\">…\n      if ( source->Value.Matrix.NoOfDimensions > 0 )\n      {\n        copy->Value.Matrix.Dimensions = (int *)OpcUa_Memory_Alloc(4 * source->Value.Matrix.NoOfDimensions);\n        memcpy(copy->Value.Matrix.Dimensions, source->Value.Matrix.Dimensions, 4 * source->Value.Matrix.NoOfDimensions);\n        nMatrixElements = 1;\n        for ( mm = 0; mm &#x3C; copy->Value.Matrix.NoOfDimensions; ++mm )\n          nMatrixElements *= source->Value.Matrix.Dimensions[mm];\n…\n</code></pre>\n<p>There is an integer overflow here if <code>source->Value.Matrix.NoOfDimensions</code> is 0x40000000 or bigger. For example with the value 0x40000001 the allocated size will be 0x4. This function is called from <code>UaVariant::operator=()</code> which is called from <code>PubSubServer::DataSetDispatcherDataItemTargetVariable::DataSetDispatcherDataItemTargetVariable()</code>:</p>\n<pre><code class=\"language-cpp\">    if ( valueRank >= 0 )\n    {\n      if ( valueRank &#x26;&#x26; valueRank != 1 )\n      {\n        OpcUa_Variant_Initialize(&#x26;vVal);\n        vVal.ArrayType = 2;\n        vVal.Datatype = builtInType;\n        UaInt32Array::UaInt32Array(&#x26;dimensions);\n        LOBYTE(v39) = 15;\n        UaInt32Array::create(&#x26;dimensions, valueRank);\n        vVal.Value.Matrix.NoOfDimensions = valueRank;\n        vVal.Value.Matrix.Dimensions = UaInt32Array::detach(&#x26;dimensions);\n        UaVariant::operator=(&#x26;intialValue, &#x26;vVal);\n</code></pre>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue\n​</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n","description":"Medium severity. The UaVariant::cloneTo() function in Unified Automation C++ based OPC UA Client Server SDK is vulnerable to of out bounds read issue which can allow a remote authenticated attacker to perform denial of service.","date_published":"2022-06-01","xray_id":"XRAY-75757","vul_id":"","severity":"medium","discovered_by":"Uriya Yavnieli","last_updated":"2022-06-01","cvss":null}},"context":{}}