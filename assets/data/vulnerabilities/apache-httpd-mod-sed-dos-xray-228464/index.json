{"hash":"c24a99c7c41342fb4f23aa1250e9d8d611ca5960","data":{"post":{"title":"Apache httpd mod_sed DoS","path":"/vulnerabilities/apache-httpd-mod-sed-dos-xray-228464/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Very large input data may cause Apache's mod_sed filter to abort, resulting in a denial of service\n​</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://httpd.apache.org/docs/trunk/mod/mod_sed.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apache's mod_sed filter module</a>\n​</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>Apache (, 2.4.53], fixed in 2.4.54\n​</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The <a href=\"https://github.com/apache/httpd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apache HTTP Server</a> is the most popular web server in the world. One of its main features is the possibility to use filter modules for various purposes.</p>\n<p>One such module, <code>mod_sed</code>, provides the webmaster the same possibilities offered by <a href=\"https://www.gnu.org/software/sed/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GNU's stream editor, sed</a>. This module can be installed as an InputFilter or as an OutputFilter if someone wishes to edit requests or responses before they're processed by the server, or before being sent back to the client. </p>\n<p>A bug found in <code>mod_sed</code>'s buffer manipulation logic may cause to the abort of the process handling the HTTP request. This occurs when the <code>mod_sed</code> module is required to to handle inputs larger than 2GB of data.</p>\n<p>An Apache deployment is vulnerable to remote exploitation if -</p>\n<ol>\n<li>\n<p>The server enables <code>mod_sed</code> in <code>httpd.conf</code> -</p>\n<pre><code>LoadModule sed_module /usr/lib/apache2/modules/mod_sed.so\n</code></pre>\n</li>\n<li>\n<p>The server configures <code>mod_sed</code> to perform any kind of processing on incoming requests, by using <code>AddInputFilter</code>. For example - </p>\n<pre><code>&#x3C;Directory />\n    AllowOverride none\n    Require all denied\n    AddInputFilter Sed html\n    InputSed \"s/\\(.)/Z/g\"\n&#x3C;/Directory>\n</code></pre>\n</li>\n</ol>\n<p>​\t\t(note that the vulnerability can be triggered for <strong>any</strong> <code>InputSed</code> patterm)</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p><code>python -c 'print(\"A\")*(2*2**30)' | curl -X POST -d@- http://host</code>\n​</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>The <code>LimitRequestBody</code> configuration directive can be used to limit POST requests' sizes. We recommend setting the limit to 1GB of data or less in <code>httpd.conf</code>:   <code>LimitRequestBody 1073741824</code>\n​</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://httpd.apache.org/security/vulnerabilities_24.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apache advisory</a></p>\n<p><a href=\"https://jfrog.com/blog/cve-2022-30522-denial-of-service-dos-vulnerability-in-apache-httpd-mod_sed-filter/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) CVE-2022-30522 – Denial of Service (DoS) Vulnerability in Apache httpd “mod_sed” filter</a></p>\n","description":"CVE-2022-30522 Medium severity. Very large input data to Apache's mod_sed filter module leads to denial of service","date_published":"2022-06-09","xray_id":"XRAY-228464","vul_id":"CVE-2022-30522","severity":"medium","discovered_by":"Brian Moussalli","last_updated":"2022-06-09","cvss":7.5}},"context":{}}