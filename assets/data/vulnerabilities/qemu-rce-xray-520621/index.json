{"hash":"f2bb96f721a22532f70fedcac749961b8d4ff708","data":{"post":{"title":"QEMU Heap overflow VM escape","path":"/vulnerabilities/qemu-rce-xray-520621/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A heap overflow in QEMU can allow an authenticated network attacker to perform a VM escape</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.qemu.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">QEMU</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>QEMU (,8.0.0], no fixed release</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The fix for CVE-2021-4206 integer overflow was incomplete.\nThe <code>ui/cursor.c</code> function <code>cursor_alloc()</code> has a buffer size calculation before allocation:</p>\n<pre><code>size_t datasize = width * height * sizeof(uint32_t);\n</code></pre>\n<p><code>width</code> and <code>height</code> are signed integers, but their product is cast to a <code>size_t</code> (unsigned integer) type.\n<code>datasize</code> could then become 0 or a very small number by using very big negative numbers, which would also bypass the sanity check: <code>if (width > 512 || height > 512)</code>.</p>\n<p>This could potentially lead to heap buffer overflow.\nA malicious privileged guest user could exploit this flaw to crash the QEMU process or execute arbitrary code on the host in the context of the QEMU process.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://access.redhat.com/security/cve/CVE-2023-1601\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Advisory</a></p>\n","description":"CVE-2023-1601 Medium severity. A heap overflow in QEMU can allow an authenticated network attacker to perform a VM escape","date_published":"2023-05-23","xray_id":"XRAY-520621","vul_id":"CVE-2023-1601","severity":"medium","discovered_by":"Yair Mizrahi","last_updated":"2023-05-23","cvss":7.5}},"context":{}}