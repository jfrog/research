{"hash":"fffe4c39eb200fc8f55a0c663798ed1a19e38ee7","data":{"post":{"title":"LemmyNet activitypub_federation WebFinger Blind SSRF","path":"/vulnerabilities/lemmynet-activitypub-federation-blind-ssrf/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>This vulnerability allows a user to bypass any predefined hardcoded URL path or security anti-localhost mechanism and perform an arbitrary GET request to any Host, Port and URL using a Webfinger request.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://crates.io/crates/activitypub-federation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">activitypub_federation</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,0.19.8]</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The Webfinger endpoint takes a remote domain for checking accounts as a feature, however, as per the ActivityPub spec (<a href=\"https://www.w3.org/TR/activitypub/#security-considerations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.w3.org/TR/activitypub/#security-considerations</a>), on the security considerations section at B.3, access to Localhost services should be prevented while running in production.</p>\n<p>It was discovered that an adversary can bypass the existing localhost checks by Gaining control over the query’s path, bypassing the domain’s restriction using DNS resolving mechanism or bypassing the domain’s restriction using official Fully Qualified Domain Names.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<ol>\n<li>Activate a local HTTP server listening to port 1234 with a “secret.txt” file:\n<code>python3 -m http.server 1234</code></li>\n<li>Open the “main.rs” file inside the “example” folder on the activitypub-federated-rust project, and modify the “beta@localhost” string into <code>hacker@localh.st:1234/secret.txt?something=1#</code></li>\n<li>Run the example using the following command:\n<code>cargo run --example local_federation axum</code></li>\n<li>View the console of the Python’s HTTP server and see that a request for a “secret.txt” file was performed.</li>\n</ol>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are provided for this vulnerability.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/LemmyNet/lemmy/security/advisories/GHSA-7723-35v7-qcxw\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GHSA</a></p>\n","description":"CVE-2025-25194 Medium severity. Blind SSRF found inside the WebFinger mechanism","date_published":"2025-02-10","xray_id":"","vul_id":"CVE-2025-25194","severity":"medium","discovered_by":"Natan Nehorai","last_updated":"2025-02-10","cvss":4}},"context":{}}