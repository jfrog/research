{"hash":"a94247ea13628feb60b8ce4500e6afa7b86a4d73","data":{"post":{"title":"H2O Model Deserialization RCE","path":"/vulnerabilities/h2o-model-deserialization-rce-jfsa-2024-001035518/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>H2O deserializes ML models without filtering, potentially allowing execution of malicious code</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://mvnrepository.com/artifact/ai.h2o/h2o-core\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">h2o-core</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>The H2O machine learning platform uses \"Iced\" classes as the primary means of moving Java Objects around the cluster. The Iced format supports inclusion of serialized Java objects. When a model is deserialized, any class is allowed to be deserialized (no class whitelist). An attacker can construct a crafted Iced model that uses Java gadgets and leads to arbitrary code execution when imported to the H2O platform.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>An appropriate malicious serialized object can be created with the <a href=\"https://github.com/frohoff/ysoserial/tree/master\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ysoserial</a> tool, using the <code>CommonsBeanutils1</code> payload.</p>\n<p>The serialized binary can then be embedded within an Iced model in the proper format.</p>\n<p>Loading the model using the Web UI's \"Import Model\" command (or an equivalent API) will trigger code execution</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p>No references are supplied for this issue</p>\n","description":"CVE-2024-6960, HIGH, H2O Model Deserialization RCE","date_published":"2024-07-21","xray_id":"JFSA-2024-001035518","vul_id":"CVE-2024-6960","severity":"high","discovered_by":"Ori Hollander","last_updated":"2024-07-21","cvss":7.5}},"context":{}}