{"hash":"0f0042d6adeeb0b75ab91d0d866ecfcfcfe810a2","data":{"post":{"title":"Unified Automation PubSub stack NULL dereference DoS","path":"/vulnerabilities/ua-cpp-ua-int32-null-deref-xray-75753/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>The UaInt32Array::create() function in Unified Automation C based PubSub Stack is vulnerable to NULL dereference which can allow a remote attacker to cause denial of service</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.unified-automation.com/products/server-sdk/c-ua-server-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unified Automation C++ Based OPC UA PubSub SDK</a>\n<a href=\"https://www.unified-automation.com/products/server-sdk/ansi-c-ua-server-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unified Automation ANSI C Based OPC UA Client &#x26; Server SDK</a>\n<a href=\"https://www.unified-automation.com/products/pubsub-sdk/highperf-ua-pubsub-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unified Automation HighPerf SDK</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>Unified Automation C++ based OPC UA Client Server SDK (, 1.7.6], fixed in 1.7.7\nUnified Automation AnsiC SDK (, 1.9.2], fixed in 1.9.3\nUnified Automation HighPerf SDK (, 1.5.2], fixed in 1.6.0</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>Unified Automation is a Bundle used to develop an OPC UA PubSub support in C++ and C, Developed by the Unified Automation.</p>\n<p>There is a possible NULL deref in <code>UaInt32Array::create()</code>:</p>\n<pre><code class=\"language-cpp\">void __cdecl UaInt32Array::create(UaInt32Array *const this, OpcUa_UInt32_0 length)\n{\n    UaInt32Array::clear(this);\n    if ( length )\n    {\n        this->m_data = (OpcUa_Int32_0 *)OpcUa_Memory_Alloc(4 * length);\n        memset(this->m_data, 0, 4LL * length);\n        this->m_noOfElements = length;\n    }\n}\n</code></pre>\n<p>There is a call to <code>memset()</code> after <code>OpcUa_Memory_Alloc()</code> is called without checking if <code>this->m_data</code> is NULL. It might be NULL if the requested length is too big.</p>\n<p>UaInt32Array::create() is called from <code>PubSubServer::DataSetDispatcherDataItemTargetVariable::DataSetDispatcherDataItemTargetVariable()</code> when parsing a <code>fieldMetadata.ValueRank</code> that is passed in a PubSubConfig that will eventually end up in the length parameter.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue\nâ€‹</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n","description":"Medium severity. The UaInt32Array::create() function in Unified Automation C based PubSub Stack is vulnerable to NULL dereference which can allow an authenticated remote attacker to cause denial of service","date_published":"2022-06-01","xray_id":"XRAY-75753","vul_id":"","severity":"medium","discovered_by":"Uriya Yavnieli","last_updated":"2022-06-01","cvss":null}},"context":{}}