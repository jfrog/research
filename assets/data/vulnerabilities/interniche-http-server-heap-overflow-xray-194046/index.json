{"hash":"91a03775f493127102155f51703d83282bb10d2a","data":{"post":{"title":"InterNiche HTTP server heap overflow","path":"/vulnerabilities/interniche-http-server-heap-overflow-xray-194046/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Heap overflow in InterNiche TCP/IP stack's HTTP server leads to remote code execution when sending a crafted HTTP POST request</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.hcc-embedded.com/products/networking/tcpip-applications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">InterNiche TCP/IP stack</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>InterNiche (, 4.3), fixed in 4.3</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>NicheStack (also known as InterNiche stack) is a proprietary TCP/IP stack developed originally by InterNiche Technologies and acquired by HCC Embedded in 2016. A heap-based buffer overflow was discovered when the NicheStack HTTP server parses HTTP POST packets. CVE-2021-31226 occurs during the parsing of the HTTP Request URI field in the function <code>ht_readmsg</code>. After making sure the packet has a valid <code>Content-Length</code> header value, the parsing logic gets the pointer to the request URI (<code>requri</code>) by calling <code>ht_nextarg</code> on the HTTP requestâ€™s buffer and stores this pointer in the <code>header_struct->fi->requri</code>. A request URI string larger than 52 bytes will overflow into the fixed-size heap buffer via a vulnerable strcpy call. Note that the HTTP server is optional, and may be disabled or compiled-out entirely.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>If not needed, disable the NicheStack HTTP server through the NicheStack CLI</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/infrahalt-14-new-security-vulnerabilities-found-in-nichestack/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) INFRA:HALT New Vulnerabilities Impacting OT and Critical Infrastructure</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31226\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2021-31226 Critical severity. Heap overflow in InterNiche TCP/IP stack's HTTP server leads to remote code execution when sending a crafted HTTP POST request","date_published":"2021-08-04","xray_id":"XRAY-194046","vul_id":"CVE-2021-31226","severity":"critical","discovered_by":"Denys Vozniuk","last_updated":"2021-08-04","cvss":9.8}},"context":{}}