{"hash":"8f4cb113ac295437f7e6c7d4fc73400c715fd72c","data":{"post":{"title":"InterNiche DNS client heap overflow","path":"/vulnerabilities/interniche-dns-client-heap-overflow-xray-194045/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Heap overflow in InterNiche TCP/IP stack's DNS client leads to remote code execution when sending a crafted DNS response</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://www.hcc-embedded.com/products/networking/tcpip-applications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">InterNiche TCP/IP stack</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>InterNiche (, 4.3), fixed in 4.3</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>NicheStack (also known as InterNiche stack) is a proprietary TCP/IP stack developed originally by InterNiche Technologies and acquired by HCC Embedded in 2016. A heap-based buffer overflow was discovered when the NicheStack DNS client parses DNS response packets. To trigger CVE-2020-25928, an attacker sends a crafted DNS packet as a response to a DNS query from the vulnerable device. A response with a big \"response data length\" field will cause a heap overflow due to a fixed-size heap buffer copy. This is easy to achieve because the DNS TXID and UDP source port can be guessed due to CVE-2020-25926 and CVE-2021-31228, respectively, and the affected DNS client implementation does not validate the source IP address of the response packet (so the attacker does not even need to know the address of the real DNS server). Note that the DNS client is optional, and may be disabled or compiled-out entirely.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability mitigations</a></h2>\n<p>If not needed, disable the NicheStack DNS client through the NicheStack CLI</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://jfrog.com/blog/infrahalt-14-new-security-vulnerabilities-found-in-nichestack/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(JFrog) INFRA:HALT New Vulnerabilities Impacting OT and Critical Infrastructure</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-25928\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2020-25928 Critical severity. Heap overflow in InterNiche TCP/IP stack's DNS client leads to remote code execution when sending a crafted DNS response","date_published":"2021-08-04","xray_id":"XRAY-194045","vul_id":"CVE-2020-25928","severity":"critical","discovered_by":"Denys Vozniuk","last_updated":"2021-08-04","cvss":9.8}},"context":{}}