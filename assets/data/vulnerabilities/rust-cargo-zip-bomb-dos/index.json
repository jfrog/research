{"hash":"a75b97c4bb85727c9acc4c2c9f086bcf8013175c","data":{"post":{"title":"Rust Cargo zip-bomb DoS","path":"/vulnerabilities/rust-cargo-zip-bomb-dos/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>Cargo is vulnerable to zip-bomb attacks when a user downloads a malicious package from sources other than crates.io</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"https://github.com/rust-lang/cargo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cargo</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>Rust (,1.63], fixed in Rust 1.64</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p><a href=\"https://github.com/rust-lang/rust\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rust</a> uses <a href=\"https://github.com/rust-lang/cargo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cargo</a> as its package manager. Cargo, by default, downloads \"crates\" from <a href=\"https://crates.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">crates.io</a>. Crates are essentially TAR files compressed with GZip. Crates.io limits the decompression size of uploaded crates to avoid <a href=\"https://en.wikipedia.org/wiki/Zip_bomb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">zip bombs</a>.</p>\n<p>On the other hand, the Cargo client does not apply a size limit on crates that it downloads from the registry. Although it might be safe to assume that crates downloaded from crates.io are fine due to the tests mentioned above, crates downloaded from other sources cannot be assumed to be safe. An attacker could upload to an alternate registry a specially crafted package that extracts significantly more data than its size, exhausting the memory space of the Cargo process and/or the disk space on the machine that uses Cargo to download the package.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>No PoC is supplied for this issue</p>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>Users of alternate registries should exercise care in which packages they download, by only including trusted dependencies in their projects.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://blog.rust-lang.org/2022/09/14/cargo-cves.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">(Rust) Security advisories for Cargo (CVE-2022-36113, CVE-2022-36114)</a></p>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-36114\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NVD</a></p>\n","description":"CVE-2022-36114 Low severity. Cargo is vulnerable to zip-bomb attacks.","date_published":"2022-09-14","xray_id":"","vul_id":"CVE-2022-36114","severity":"low","discovered_by":"Ori Hollander","last_updated":"2022-09-14","cvss":4.8}},"context":{}}